<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="es" >
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="VPN de acceso remoto con WireGuard" />
<meta name="author" content="Pablo Martín Hidalgo" />
<meta property="og:locale" content="es" />
<meta name="description" content="En este artículo exploraremos cómo configurar una VPN de acceso remoto utilizando WireGuard, una solución moderna y eficiente. Los clientes que se conectarán a la VPN estarán en sistemas operativos Linux, Android y Windows, permitiendo así el acceso seguro a los recursos internos desde diversas plataformas y ubicaciones." />
<meta property="og:description" content="En este artículo exploraremos cómo configurar una VPN de acceso remoto utilizando WireGuard, una solución moderna y eficiente. Los clientes que se conectarán a la VPN estarán en sistemas operativos Linux, Android y Windows, permitiendo así el acceso seguro a los recursos internos desde diversas plataformas y ubicaciones." />
<link rel="canonical" href="/posts/acceso_remoto_wireguard/" />
<meta property="og:url" content="/posts/acceso_remoto_wireguard/" />
<meta property="og:site_name" content="Blog personal" />
<meta property="og:image" content="/assets/img/posts/vpn/portada2.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-01-27T21:00:00+01:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="/assets/img/posts/vpn/portada2.png" />
<meta property="twitter:title" content="VPN de acceso remoto con WireGuard" />
<meta name="twitter:site" content="@Tagarnina10" />
<meta name="twitter:creator" content="@Tagarnina10" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Pablo Martín Hidalgo","url":"https://github.com/PabloMartin19/"},"dateModified":"2025-01-29T19:04:04+01:00","datePublished":"2025-01-27T21:00:00+01:00","description":"En este artículo exploraremos cómo configurar una VPN de acceso remoto utilizando WireGuard, una solución moderna y eficiente. Los clientes que se conectarán a la VPN estarán en sistemas operativos Linux, Android y Windows, permitiendo así el acceso seguro a los recursos internos desde diversas plataformas y ubicaciones.","headline":"VPN de acceso remoto con WireGuard","image":"/assets/img/posts/vpn/portada2.png","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/acceso_remoto_wireguard/"},"url":"/posts/acceso_remoto_wireguard/"}</script>
<!-- End Jekyll SEO tag -->


  <title>VPN de acceso remoto con WireGuard | Blog personal
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Blog personal">
<meta name="application-name" content="Blog personal">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.6.0/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.29.0/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- JavaScript -->

  
    <!-- Switch the mode between dark and light. -->

<script type="text/javascript">
  class ModeToggle {
    static get MODE_KEY() {
      return 'mode';
    }
    static get MODE_ATTR() {
      return 'data-mode';
    }
    static get DARK_MODE() {
      return 'dark';
    }
    static get LIGHT_MODE() {
      return 'light';
    }
    static get ID() {
      return 'mode-toggle';
    }

    constructor() {
      let self = this;this.sysDarkPrefers.addEventListener('change', () => {
        if (self.hasMode) {
          self.clearMode();
        }
        self.notify();
      });

      if (!this.hasMode) {
        return;
      }

      if (this.isDarkMode) {
        this.setDark();
      } else {
        this.setLight();
      }
    }

    get sysDarkPrefers() {
      return window.matchMedia('(prefers-color-scheme: dark)');
    }

    get isPreferDark() {
      return this.sysDarkPrefers.matches;
    }

    get isDarkMode() {
      return this.mode === ModeToggle.DARK_MODE;
    }

    get hasMode() {
      return this.mode != null;
    }

    get mode() {
      return sessionStorage.getItem(ModeToggle.MODE_KEY);
    }get modeStatus() {
      if (this.hasMode) {
        return this.mode;
      } else {
        return this.isPreferDark ? ModeToggle.DARK_MODE : ModeToggle.LIGHT_MODE;
      }
    }

    setDark() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }

    setLight() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }

    clearMode() {
      document.documentElement.removeAttribute(ModeToggle.MODE_ATTR);
      sessionStorage.removeItem(ModeToggle.MODE_KEY);
    }notify() {
      window.postMessage(
        {
          direction: ModeToggle.ID,
          message: this.modeStatus
        },
        '*'
      );
    }

    flipMode() {
      if (this.hasMode) {
        this.clearMode();
      } else {
        if (this.isPreferDark) {
          this.setLight();
        } else {
          this.setDark();
        }
      }

      this.notify();
    }
  }

  const modeToggle = new ModeToggle();
</script>

  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/avatar.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">Blog personal</a>
    <p class="site-subtitle fst-italic mb-0">Los mejores programas son aquellos que funcionan.</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
      

      
        <a
          href="https://github.com/PabloMartin19"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://twitter.com/Tagarnina10"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fa-brands fa-x-twitter"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['pmartinhidalgo19','gmail.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="https://www.linkedin.com/in/pablo-mart%C3%ADn-hidalgo/"
          aria-label="linkedin"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-linkedin"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>VPN de acceso remoto con WireGuard</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  




<!-- return -->




<article class="px-1">
  <header>
    <h1 data-toc-skip>VPN de acceso remoto con WireGuard</h1>
    
      <p class="post-desc fw-light mb-4">En este artículo exploraremos cómo configurar una VPN de acceso remoto utilizando WireGuard, una solución moderna y eficiente.  Los clientes que se conectarán a la VPN estarán en sistemas operativos Linux, Android y Windows, permitiendo así el acceso seguro a los recursos internos desde diversas plataformas y ubicaciones.</p>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1738008000"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Jan 27, 2025
</time>

      </span>

      <!-- lastmod date -->
      
        <span>
          Updated
          <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1738173844"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Jan 29, 2025
</time>

        </span>
      

      
        
        
        

        

        <div class="mt-3 mb-3">
          <a href="/assets/img/posts/vpn/portada2.png" class="popup img-link preview-img shimmer"><img src="/assets/img/posts/vpn/portada2.png"  alt="Preview Image" width="1200" height="630"  loading="lazy"></a></div>
      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              
                <a href="https://github.com/PabloMartin19/">Pablo Martín Hidalgo</a>
                
              
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="3133 words"
>
  <em>17 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  <div class="content">
    <p>El objetivo de esta práctica es configurar una red privada virtual (VPN) de acceso remoto mediante la implementación de WireGuard en un entorno simulado con GNS3. Esta práctica tiene como fin proporcionar una solución de conectividad segura y eficiente, permitiendo la comunicación remota y cifrada entre los clientes y el servidor VPN.</p>

<h2 id="escenario"><span class="me-2">Escenario</span><a href="#escenario" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>El escenario consta de lo siguiente:</p>

<ol>
  <li>Dispositivos Cliente:</li>
</ol>

<ul>
  <li><strong>Cliente-Windows</strong> (172.22.0.2/24)</li>
  <li><strong>Cliente-Android</strong> (172.22.0.3/24)</li>
  <li><strong>Cliente-Linux</strong> (172.22.0.4/24)</li>
</ul>

<ol>
  <li>
    <p>Un <strong>Servidor</strong> que dispone de dos redes diferentes, la que conecta con los clientes (172.22.0.1/24) y la que conecta con el PC-Local (192.168.1.1/24).</p>
  </li>
  <li>
    <p>Un <strong>PC-Local</strong> (192.168.1.2/24)</p>
  </li>
  <li>
    <p>Cuatro <strong>nubes NAT</strong> (NAT1, NAT2, NAT3 y NAT4) que proporcionan traducción de direcciones de red</p>
  </li>
  <li>
    <p>Un <strong>Switch</strong> central que interconecta todos los clientes con el servidor</p>
  </li>
</ol>

<p>La topología está organizada de la siguiente manera:</p>

<ul>
  <li>Los tres clientes (Windows, Android y Linux) se conectan al Switch1 a través de diferentes puertos (e0, e1, e2)</li>
  <li>Cada cliente tiene su propia nube NAT conectada a través de interfaces nat0</li>
  <li>El servidor está conectado al Switch1 a través del puerto e3</li>
  <li>El servidor también tiene una conexión directa a la PC local a través de una red separada (192.168.1.0/24)</li>
  <li>Hay una cuarta nube NAT (NAT4) conectada directamente al servidor</li>
</ul>

<p>Podemos verlo en imagen:</p>

<p><a href="/assets/img/posts/vpn/escenario.png" class="popup img-link  shimmer"><img src="/assets/img/posts/vpn/escenario.png" alt="image" loading="lazy"></a></p>

<p><strong>IMPORTANTE</strong> ⚠️</p>

<p>El cliente Android, como se ve en la imagen, está conectado a dos interfaces de red. Sin embargo, esto <strong>no significa que pueda usarlas simultáneamente</strong>, ya que Android no permite tener activas dos conexiones de red al mismo tiempo cuando una de ellas no es Wi-Fi.</p>

<p>Inicialmente, utilizaremos la red proporcionada por la <strong>nube NAT</strong> para descargar e instalar las aplicaciones necesarias. Sin embargo, cuando llegue el momento de realizar las pruebas de conectividad con la VPN, será necesario cambiar manualmente a la interfaz que tiene la dirección <strong>172.22.0.3/24</strong>, ya que es la que permite la comunicación con el servidor y el resto de la red en el escenario de GNS3.</p>

<h2 id="configuración-del-servidor"><span class="me-2">Configuración del Servidor</span><a href="#configuración-del-servidor" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Primero, actualizamos los paquetes de nuestro sistema e instalamos WireGuard con los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>debian@Servidor:~<span class="nv">$ </span><span class="nb">sudo </span>apt update <span class="o">&amp;&amp;</span> <span class="nb">sudo </span>apt upgrade <span class="nt">-y</span> <span class="o">&amp;&amp;</span> <span class="nb">sudo </span>apt <span class="nb">install </span>wireguard <span class="nt">-y</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Para que los dispositivos conectados a la VPN puedan comunicarse con otras redes, debemos habilitar el reenvío de paquetes en el kernel. Para que sea persistente, lo agregamos en el archivo <code class="language-plaintext highlighter-rouge">/etc/sysctl.conf</code>:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>debian@Servidor:~<span class="nv">$ </span><span class="nb">sudo </span>sysctl <span class="nt">-p</span>
net.ipv4.ip_forward <span class="o">=</span> 1
</pre></td></tr></tbody></table></code></div></div>

<p>WireGuard utiliza criptografía de clave pública-privada para la autenticación entre los pares. Cada nodo de la VPN necesita generar su propio par de claves.</p>

<p>Nos dirigimos al directorio de configuración de WireGuard:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>debian@Servidor:~<span class="nv">$ </span><span class="nb">sudo </span>su
root@Servidor:/home/debian# <span class="nb">cd</span> /etc/wireguard/
</pre></td></tr></tbody></table></code></div></div>

<p>Generamos la clave privada y la almacenamos en un archivo llamado clave_priv_servidor. Simultáneamente, generamos la clave pública derivada de la privada y la almacenamos en clave_pub_servidor:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>root@Servidor:/etc/wireguard# wg genkey | <span class="nb">tee </span>clave_priv_servidor | wg pubkey <span class="o">&gt;</span> clave_pub_servidor
</pre></td></tr></tbody></table></code></div></div>

<p>Verificamos que los archivos se han generado correctamente:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>root@Servidor:/etc/wireguard# <span class="nb">ls</span> <span class="nt">-l</span>
total 8
<span class="nt">-rw-r--r--</span> 1 root root 45 Jan 28 22:13 clave_priv_servidor
<span class="nt">-rw-r--r--</span> 1 root root 45 Jan 28 22:13 clave_pub_servidor
</pre></td></tr></tbody></table></code></div></div>

<p>Mostramos el contenido de las claves para asegurarnos de que están bien creadas:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>root@Servidor:/etc/wireguard# <span class="nb">cat </span>clave_priv_servidor 
<span class="nv">oOWo8ekqChcY31za9QsNHu75NqioypbFqZgFcTc9WEQ</span><span class="o">=</span>

root@Servidor:/etc/wireguard# <span class="nb">cat </span>clave_pub_servidor 
7+qFaDTqy/WIHiPrucnpTdCJRNbqFvlANVQdwsmITCo<span class="o">=</span>
</pre></td></tr></tbody></table></code></div></div>

<p>La clave privada nunca debe ser compartida, ya que es la que permite el acceso seguro al servidor.</p>

<p>WireGuard utiliza archivos de configuración en formato INI para definir la interfaz de red VPN y sus parámetros.</p>

<p>Creamos el archivo de configuración con:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>nano /etc/wireguard/wg0.conf
</pre></td></tr></tbody></table></code></div></div>

<p>Añadimos el siguiente contenido:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>root@Servidor:/etc/wireguard# <span class="nb">cat </span>wg0.conf 
<span class="o">[</span>Interface]
<span class="c"># Dirección IP que tendrá el servidor dentro de la VPN</span>
Address <span class="o">=</span> 10.99.99.1

<span class="c"># Clave privada generada anteriormente</span>
PrivateKey <span class="o">=</span> <span class="nv">oOWo8ekqChcY31za9QsNHu75NqioypbFqZgFcTc9WEQ</span><span class="o">=</span>

<span class="c"># Puerto de escucha del servidor (por defecto WireGuard usa el 51820)</span>
ListenPort <span class="o">=</span> 51820
</pre></td></tr></tbody></table></code></div></div>

<p>Este archivo define la interfaz <code class="language-plaintext highlighter-rouge">wg0</code>, que será utilizada por WireGuard para la comunicación VPN.</p>

<p>Para levantar la VPN, utilizamos el comando <code class="language-plaintext highlighter-rouge">wg-quick</code>:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>root@Servidor:/etc/wireguard# wg-quick up wg0
<span class="o">[</span><span class="c">#] ip link add wg0 type wireguard</span>
<span class="o">[</span> 9304.006929] wireguard: WireGuard 1.0.0 loaded. See www.wireguard.com <span class="k">for </span>information.
<span class="o">[</span> 9304.007862] wireguard: Copyright <span class="o">(</span>C<span class="o">)</span> 2015-2019 Jason A. Donenfeld &lt;Jason@zx2c4.com&gt;. All Rights Reserved.
<span class="o">[</span><span class="c">#] wg setconf wg0 /dev/fd/63</span>
<span class="o">[</span><span class="c">#] ip -4 address add 10.99.99.1 dev wg0</span>
<span class="o">[</span><span class="c">#] ip link set mtu 1420 up dev wg0</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Para verificar el estado de la interfaz WireGuard y confirmar que está activa, usamos:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>root@Servidor:/etc/wireguard# wg
interface: wg0
  public key: 7+qFaDTqy/WIHiPrucnpTdCJRNbqFvlANVQdwsmITCo<span class="o">=</span>
  private key: <span class="o">(</span>hidden<span class="o">)</span>
  listening port: 51820
</pre></td></tr></tbody></table></code></div></div>

<p><a href="/assets/img/posts/vpn/image7.png" class="popup img-link  shimmer"><img src="/assets/img/posts/vpn/image7.png" alt="image" loading="lazy"></a></p>

<p>Esto indica que la interfaz <code class="language-plaintext highlighter-rouge">wg0</code> está en funcionamiento, tiene la clave pública correcta y está escuchando en el puerto 51820.</p>

<p>Vamos a listar todas las interfaces de red disponibles, donde deberíamos ver algo similar a esto:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre></td><td class="rouge-code"><pre>root@Servidor:/etc/wireguard# ip a
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    <span class="nb">link</span>/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host noprefixroute 
       valid_lft forever preferred_lft forever
2: ens4: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000
    <span class="nb">link</span>/ether 0c:40:52:9a:00:00 brd ff:ff:ff:ff:ff:ff
    altname enp0s4
    inet 192.168.1.1/24 brd 192.168.1.255 scope global ens4
       valid_lft forever preferred_lft forever
    inet6 fe80::e40:52ff:fe9a:0/64 scope <span class="nb">link 
       </span>valid_lft forever preferred_lft forever
3: ens5: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000
    <span class="nb">link</span>/ether 0c:40:52:9a:00:01 brd ff:ff:ff:ff:ff:ff
    altname enp0s5
    inet 172.22.0.1/24 brd 172.22.0.255 scope global ens5
       valid_lft forever preferred_lft forever
    inet6 fe80::e40:52ff:fe9a:1/64 scope <span class="nb">link 
       </span>valid_lft forever preferred_lft forever
4: ens6: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000
    <span class="nb">link</span>/ether 0c:40:52:9a:00:02 brd ff:ff:ff:ff:ff:ff
    altname enp0s6
    inet 192.168.122.51/24 brd 192.168.122.255 scope global dynamic ens6
       valid_lft 2744sec preferred_lft 2744sec
    inet6 fe80::e40:52ff:fe9a:2/64 scope <span class="nb">link 
       </span>valid_lft forever preferred_lft forever
5: wg0: &lt;POINTOPOINT,NOARP,UP,LOWER_UP&gt; mtu 1420 qdisc noqueue state UNKNOWN group default qlen 1000
    <span class="nb">link</span>/none 
    inet 10.99.99.1/32 scope global wg0
       valid_lft forever preferred_lft forever
</pre></td></tr></tbody></table></code></div></div>

<p>Aquí podemos confirmar que la interfaz wg0 está activa y que tiene asignada la dirección <code class="language-plaintext highlighter-rouge">10.99.99.1/32</code>, la cual servirá como puerta de enlace VPN.</p>

<h2 id="configuración-del-cliente-linux"><span class="me-2">Configuración del Cliente-Linux</span><a href="#configuración-del-cliente-linux" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Para configurar el cliente Linux en nuestra VPN con WireGuard, primero aseguramos que el sistema esté actualizado e instalamos el paquete necesario. Ejecutamos:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>debian@Cliente-Linux:~<span class="nv">$ </span><span class="nb">sudo </span>apt update <span class="o">&amp;&amp;</span> <span class="nb">sudo </span>apt upgrade <span class="nt">-y</span> <span class="o">&amp;&amp;</span> <span class="nb">sudo </span>apt <span class="nb">install </span>wireguard <span class="nt">-y</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Luego, cambiamos al usuario root y nos desplazamos al directorio de configuración de WireGuard:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>debian@Cliente-Linux:~<span class="nv">$ </span><span class="nb">sudo </span>su
root@Cliente-Linux:/home/debian# <span class="nb">cd</span> /etc/wireguard/
</pre></td></tr></tbody></table></code></div></div>

<p>Generamos la clave privada del cliente y a partir de ella obtenemos la clave pública:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>root@Cliente-Linux:/etc/wireguard# wg genkey | <span class="nb">tee </span>clave_priv_cliente | wg pubkey <span class="o">&gt;</span> clave_pub_cliente
</pre></td></tr></tbody></table></code></div></div>

<p>Verificamos que los archivos de claves se han generado correctamente:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>root@Cliente-Linux:/etc/wireguard# <span class="nb">ls</span> <span class="nt">-l</span>
total 8
<span class="nt">-rw-r--r--</span> 1 root root 45 Jan 28 22:33 clave_priv_cliente
<span class="nt">-rw-r--r--</span> 1 root root 45 Jan 28 22:33 clave_pub_cliente
</pre></td></tr></tbody></table></code></div></div>

<p>Consultamos el contenido de las claves para asegurarnos de que se han creado correctamente:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>root@Cliente-Linux:/etc/wireguard# <span class="nb">cat </span>clave_priv_cliente  
<span class="nv">kKnEefJbY6wvEwS0Gkj9nPKUDyol6VnguYik11U4AkQ</span><span class="o">=</span>

root@Cliente-Linux:/etc/wireguard# <span class="nb">cat </span>clave_pub_cliente 
F/eZilIdeYh1iY2Fx6GHfVRlAM0AoVvBamiZ/Zbf+Aw<span class="o">=</span>
</pre></td></tr></tbody></table></code></div></div>

<p>A continuación, creamos el archivo de configuración <code class="language-plaintext highlighter-rouge">wg0.conf</code> con los siguientes parámetros:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre>root@Cliente-Linux:/etc/wireguard# <span class="nb">cat </span>wg0.conf
<span class="o">[</span>Interface]

<span class="c"># IP que tomará el cliente en el túnel</span>
Address <span class="o">=</span> 10.99.99.2/24 

<span class="c"># Clave privada del cliente</span>
PrivateKey <span class="o">=</span> <span class="nv">kKnEefJbY6wvEwS0Gkj9nPKUDyol6VnguYik11U4AkQ</span><span class="o">=</span>

<span class="c"># Puerto escucha y por defecto de Wireguard</span>
ListenPort <span class="o">=</span> 51820

<span class="o">[</span>Peer]

<span class="c"># Clave pública del servidor</span>
PublicKey <span class="o">=</span> 7+qFaDTqy/WIHiPrucnpTdCJRNbqFvlANVQdwsmITCo<span class="o">=</span>

<span class="c"># Rango de direcciones permitidas en el túnel.</span>
AllowedIPs <span class="o">=</span> 0.0.0.0/0

<span class="c">#Punto de acceso del servidor</span>
Endpoint <span class="o">=</span> 172.22.0.1:51820

<span class="c">#Tiempo de espera de la conexión</span>
PersistentKeepalive <span class="o">=</span> 25
</pre></td></tr></tbody></table></code></div></div>

<p>Levantamos la interfaz de WireGuard con:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre>root@Cliente-Linux:/etc/wireguard# wg-quick up wg0
<span class="o">[</span><span class="c">#] ip link add wg0 type wireguard</span>
<span class="o">[</span> 2154.668085] wireguard: WireGuard 1.0.0 loaded. See www.wireguard.com <span class="k">for </span>information.
<span class="o">[</span> 2154.670429] wireguard: Copyright <span class="o">(</span>C<span class="o">)</span> 2015-2019 Jason A. Donenfeld &lt;Jason@zx2c4.com&gt;. All Rights Reserved.
<span class="o">[</span><span class="c">#] wg setconf wg0 /dev/fd/63</span>
<span class="o">[</span><span class="c">#] ip -4 address add 10.99.99.2/24 dev wg0</span>
<span class="o">[</span><span class="c">#] ip link set mtu 1420 up dev wg0</span>
<span class="o">[</span><span class="c">#] wg set wg0 fwmark 51820</span>
<span class="o">[</span><span class="c">#] ip -4 route add 0.0.0.0/0 dev wg0 table 51820</span>
<span class="o">[</span><span class="c">#] ip -4 rule add not fwmark 51820 table 51820</span>
<span class="o">[</span><span class="c">#] ip -4 rule add table main suppress_prefixlength 0</span>
<span class="o">[</span><span class="c">#] sysctl -q net.ipv4.conf.all.src_valid_mark=1</span>
<span class="o">[</span><span class="c">#] iptables-restore -n</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Si todo funciona correctamente, deberíamos ver mensajes indicando que la interfaz se ha creado y configurado con éxito. Podemos verificar el estado de la conexión ejecutando:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre>root@Cliente-Linux:/etc/wireguard# wg
interface: wg0
  public key: F/eZilIdeYh1iY2Fx6GHfVRlAM0AoVvBamiZ/Zbf+Aw<span class="o">=</span>
  private key: <span class="o">(</span>hidden<span class="o">)</span>
  listening port: 51820
  fwmark: 0xca6c

peer: 7+qFaDTqy/WIHiPrucnpTdCJRNbqFvlANVQdwsmITCo<span class="o">=</span>
  endpoint: 172.22.0.1:51820
  allowed ips: 0.0.0.0/0
  transfer: 0 B received, 296 B sent
  persistent keepalive: every 25 seconds
</pre></td></tr></tbody></table></code></div></div>

<p>Y confirmamos que la interfaz <code class="language-plaintext highlighter-rouge">wg0</code> ha sido añadida correctamente al sistema:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre>root@Cliente-Linux:/etc/wireguard# ip a
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    <span class="nb">link</span>/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host noprefixroute 
       valid_lft forever preferred_lft forever
2: ens4: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000
    <span class="nb">link</span>/ether 0c:89:3b:46:00:00 brd ff:ff:ff:ff:ff:ff
    altname enp0s4
    inet 172.22.0.4/24 brd 172.22.0.255 scope global ens4
       valid_lft forever preferred_lft forever
    inet6 fe80::e89:3bff:fe46:0/64 scope <span class="nb">link 
       </span>valid_lft forever preferred_lft forever
3: ens5: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000
    <span class="nb">link</span>/ether 0c:89:3b:46:00:01 brd ff:ff:ff:ff:ff:ff
    altname enp0s5
    inet 192.168.122.208/24 brd 192.168.122.255 scope global dynamic ens5
       valid_lft 1416sec preferred_lft 1416sec
    inet6 fe80::e89:3bff:fe46:1/64 scope <span class="nb">link 
       </span>valid_lft forever preferred_lft forever
4: wg0: &lt;POINTOPOINT,NOARP,UP,LOWER_UP&gt; mtu 1420 qdisc noqueue state UNKNOWN group default qlen 1000
    <span class="nb">link</span>/none 
    inet 10.99.99.2/24 scope global wg0
       valid_lft forever preferred_lft forever
</pre></td></tr></tbody></table></code></div></div>

<p>Ahora volvemos al servidor para añadir la configuración del cliente. En el archivo <code class="language-plaintext highlighter-rouge">wg0.conf</code> del servidor agregamos la información correspondiente al cliente:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="rouge-code"><pre>root@Servidor:/etc/wireguard# <span class="nb">cat </span>wg0.conf 
<span class="c"># SERVIDOR</span>
<span class="o">[</span>Interface]

<span class="c"># Aquí ponemos la IP virtual que tomará el túnel</span>
Address <span class="o">=</span> 10.99.99.1

<span class="c"># Clave privada del servidor creada hace momentos</span>
PrivateKey <span class="o">=</span> <span class="nv">oOWo8ekqChcY31za9QsNHu75NqioypbFqZgFcTc9WEQ</span><span class="o">=</span>

<span class="c"># Puerto escucha y por defecto de Wireguard</span>
ListenPort <span class="o">=</span> 51820


<span class="c"># CLIENTE</span>
<span class="o">[</span>Peer]

<span class="c"># Clave pública del cliente</span>

Publickey <span class="o">=</span> F/eZilIdeYh1iY2Fx6GHfVRlAM0AoVvBamiZ/Zbf+Aw<span class="o">=</span>

<span class="c"># IP túnel del cliente</span>

AllowedIPs <span class="o">=</span> 10.99.99.2/32

<span class="c">#Tiempo de espera de respuesta</span>

PersistentKeepAlive <span class="o">=</span> 25
</pre></td></tr></tbody></table></code></div></div>

<p>Para aplicar los cambios, reiniciamos la interfaz en el servidor:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>root@Servidor:/etc/wireguard# wg-quick down wg0
<span class="o">[</span><span class="c">#] ip link delete dev wg0</span>
root@Servidor:/etc/wireguard# wg-quick up wg0
<span class="o">[</span><span class="c">#] ip link add wg0 type wireguard</span>
<span class="o">[</span><span class="c">#] wg setconf wg0 /dev/fd/63</span>
<span class="o">[</span><span class="c">#] ip -4 address add 10.99.99.1 dev wg0</span>
<span class="o">[</span><span class="c">#] ip link set mtu 1420 up dev wg0</span>
<span class="o">[</span><span class="c">#] ip -4 route add 10.99.99.2/32 dev wg0</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Verificamos el estado de la VPN en el servidor con:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>root@Servidor:/etc/wireguard# wg
interface: wg0
  public key: 7+qFaDTqy/WIHiPrucnpTdCJRNbqFvlANVQdwsmITCo<span class="o">=</span>
  private key: <span class="o">(</span>hidden<span class="o">)</span>
  listening port: 51820

peer: F/eZilIdeYh1iY2Fx6GHfVRlAM0AoVvBamiZ/Zbf+Aw<span class="o">=</span>
  allowed ips: 10.99.99.2/32
  persistent keepalive: every 25 seconds
</pre></td></tr></tbody></table></code></div></div>

<h3 id="comprobación-funcionamiento"><span class="me-2">Comprobación funcionamiento</span><a href="#comprobación-funcionamiento" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Para comprobar la conexión desde el cliente, utilizamos traceroute para ver si el tráfico se está enviando correctamente a través del túnel VPN:</p>

<p><a href="/assets/img/posts/vpn/image8.png" class="popup img-link  shimmer"><img src="/assets/img/posts/vpn/image8.png" alt="image" loading="lazy"></a></p>

<p>Si todo está configurado correctamente, veremos que los paquetes viajan por la interfaz <code class="language-plaintext highlighter-rouge">wg0</code>, confirmando que la VPN está funcionando de manera óptima.</p>

<h2 id="configuración-cliente-windows"><span class="me-2">Configuración Cliente-Windows</span><a href="#configuración-cliente-windows" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Para configurar WireGuard en un cliente Windows, comenzamos descargando e instalando el cliente oficial desde su página de <a href="https://download.wireguard.com/windows-client/wireguard-installer.exe">descargas</a>.</p>

<p>Una vez completada la instalación, ejecutamos la aplicación y procedemos a agregar un nuevo túnel vacío. Esto nos permitirá definir manualmente la configuración de nuestra conexión VPN:</p>

<p><a href="/assets/img/posts/vpn/image17.png" class="popup img-link  shimmer"><img src="/assets/img/posts/vpn/image17.png" alt="image" loading="lazy"></a></p>

<p>Al crear el túnel, editamos el archivo de configuración con los siguientes parámetros:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="o">[</span>Interface]
PrivateKey <span class="o">=</span> wHLqf5MSCuBHQ+Gi0kBFCjqIYZVlQC540JtAywT4K04<span class="o">=</span>
ListenPort <span class="o">=</span> 51820
Address <span class="o">=</span> 10.99.99.3/32

<span class="o">[</span>Peer]
PublicKey <span class="o">=</span> 7+qFaDTqy/WIHiPrucnpTdCJRNbqFvlANVQdwsmITCo<span class="o">=</span>
AllowedIPs <span class="o">=</span> 0.0.0.0/1
EndPoint <span class="o">=</span> 172.22.0.1:51820
</pre></td></tr></tbody></table></code></div></div>

<p><a href="/assets/img/posts/vpn/image9.png" class="popup img-link  shimmer"><img src="/assets/img/posts/vpn/image9.png" alt="image" loading="lazy"></a></p>

<p>Analizando esta configuración, observamos que en la sección <strong>[Interface]</strong> se especifica la clave privada del cliente, el puerto en el que escuchará y la dirección IP asignada dentro de la VPN. En la sección <strong>[Peer]</strong>, se define el servidor al que nos conectaremos, incluyendo su clave pública, las IPs permitidas en la VPN y la dirección del endpoint, que corresponde al servidor WireGuard.</p>

<p>Después de guardar la configuración, activamos el túnel y verificamos que la conexión se haya establecido correctamente mediante el handshake:</p>

<p><a href="/assets/img/posts/vpn/image10.png" class="popup img-link  shimmer"><img src="/assets/img/posts/vpn/image10.png" alt="image" loading="lazy"></a></p>

<p>También podemos observar que se ha creado una nueva interfaz de red asociada a WireGuard:</p>

<p><a href="/assets/img/posts/vpn/image18.png" class="popup img-link  shimmer"><img src="/assets/img/posts/vpn/image18.png" alt="image" loading="lazy"></a></p>

<p>A continuación, nos dirigimos al servidor y añadimos la información del nuevo cliente Windows en su archivo de configuración (<code class="language-plaintext highlighter-rouge">/etc/wireguard/wg0.conf</code>):</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre></td><td class="rouge-code"><pre>root@Servidor:/etc/wireguard# <span class="nb">cat </span>wg0.conf 
<span class="c"># SERVIDOR</span>
<span class="o">[</span>Interface]

<span class="c"># Aquí ponemos la IP virtual que tomará el túnel</span>
Address <span class="o">=</span> 10.99.99.1

<span class="c"># Clave privada del servidor creada hace momentos</span>
PrivateKey <span class="o">=</span> <span class="nv">oOWo8ekqChcY31za9QsNHu75NqioypbFqZgFcTc9WEQ</span><span class="o">=</span>

<span class="c"># Puerto escucha y por defecto de Wireguard</span>
ListenPort <span class="o">=</span> 51820


<span class="c"># CLIENTE LINUX</span>
<span class="o">[</span>Peer]

<span class="c"># Clave pública del cliente</span>

Publickey <span class="o">=</span> F/eZilIdeYh1iY2Fx6GHfVRlAM0AoVvBamiZ/Zbf+Aw<span class="o">=</span>

<span class="c"># IP túnel del cliente</span>

AllowedIPs <span class="o">=</span> 10.99.99.2/32

<span class="c">#Tiempo de espera de respuesta</span>

PersistentKeepAlive <span class="o">=</span> 25


<span class="c"># CLIENTE WINDOWS</span>

<span class="o">[</span>Peer]

Publickey <span class="o">=</span> Gw9vvlbUvr/Q2t2poFA1R53Y9mYlP718EKPCaWvsTns<span class="o">=</span>

AllowedIPs <span class="o">=</span> 10.99.99.3/32

PersistentKeepAlive <span class="o">=</span> 25
</pre></td></tr></tbody></table></code></div></div>

<p>Para aplicar los cambios, reiniciamos la interfaz de WireGuard en el servidor:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>root@Servidor:/etc/wireguard# wg-quick up wg0
<span class="o">[</span><span class="c">#] ip link add wg0 type wireguard</span>
<span class="o">[</span> 1439.522887] wireguard: WireGuard 1.0.0 loaded. See www.wireguard.com <span class="k">for </span>information.
<span class="o">[</span> 1439.524019] wireguard: Copyright <span class="o">(</span>C<span class="o">)</span> 2015-2019 Jason A. Donenfeld &lt;Jason@zx2c4.com&gt;. All Rights Reserved.
<span class="o">[</span><span class="c">#] wg setconf wg0 /dev/fd/63</span>
<span class="o">[</span><span class="c">#] ip -4 address add 10.99.99.1 dev wg0</span>
<span class="o">[</span><span class="c">#] ip link set mtu 1420 up dev wg0</span>
<span class="o">[</span><span class="c">#] ip -4 route add 10.99.99.3/32 dev wg0</span>
<span class="o">[</span><span class="c">#] ip -4 route add 10.99.99.2/32 dev wg0</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Si ejecutamos <code class="language-plaintext highlighter-rouge">wg</code>, podemos comprobar que ambos clientes (Linux y Windows) están conectados correctamente, ya que se observa el handshake reciente y tráfico intercambiado con el servidor:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre>root@Servidor:/etc/wireguard# wg
interface: wg0
  public key: 7+qFaDTqy/WIHiPrucnpTdCJRNbqFvlANVQdwsmITCo<span class="o">=</span>
  private key: <span class="o">(</span>hidden<span class="o">)</span>
  listening port: 51820

peer: F/eZilIdeYh1iY2Fx6GHfVRlAM0AoVvBamiZ/Zbf+Aw<span class="o">=</span>
  endpoint: 172.22.0.4:51820
  allowed ips: 10.99.99.2/32
  latest handshake: 26 seconds ago
  transfer: 2.20 KiB received, 1.46 KiB sent
  persistent keepalive: every 25 seconds

peer: Gw9vvlbUvr/Q2t2poFA1R53Y9mYlP718EKPCaWvsTns<span class="o">=</span>
  endpoint: 172.22.0.2:51820
  allowed ips: 10.99.99.3/32
  latest handshake: 1 minute, 11 seconds ago
  transfer: 61.41 KiB received, 632 B sent
  persistent keepalive: every 25 seconds
</pre></td></tr></tbody></table></code></div></div>

<h3 id="comprobación-funcionamiento-1"><span class="me-2">Comprobación funcionamiento</span><a href="#comprobación-funcionamiento-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Para finalizar, realizamos una prueba de conectividad ejecutando un traceroute desde el cliente Windows hacia el dispositivo que tenemos en la red local. Esto nos confirmará que el tráfico está siendo correctamente enrutado a través de la VPN.</p>

<p><a href="/assets/img/posts/vpn/image11.png" class="popup img-link  shimmer"><img src="/assets/img/posts/vpn/image11.png" alt="image" loading="lazy"></a></p>

<p>Y como podemos ver funciona correctamente. Este proceso garantiza que el cliente Windows pueda comunicarse con el servidor y con otros clientes conectados a la VPN de WireGuard, proporcionando una conexión segura y estable.</p>

<h2 id="configuración-android"><span class="me-2">Configuración Android</span><a href="#configuración-android" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Para comenzar nuestra configuración en Android, necesitaremos instalar dos aplicaciones fundamentales desde la Play Store. La primera es WireGuard, que nos permitirá crear y gestionar nuestro túnel VPN. La segunda es Termius, un versátil cliente SSH que además nos proporciona una terminal integrada, esta será esencial para realizar nuestras pruebas de conectividad y verificar la correcta creación del túnel.</p>

<p>Una vez que hayamos completado la instalación de ambas aplicaciones, debemos proceder a configurar nuestra conexión Wi-Fi. En este caso, necesitaremos modificar la configuración de red para utilizar la dirección IP <code class="language-plaintext highlighter-rouge">172.22.0.3/24</code>. Para realizar este cambio, nos dirigiremos a los Ajustes de nuestro dispositivo, donde tendremos que añadir manualmente la configuración:</p>

<p><a href="/assets/img/posts/vpn/image16.png" class="popup img-link  shimmer"><img src="/assets/img/posts/vpn/image16.png" alt="image" loading="lazy"></a></p>

<p>Con la red correctamente configurada, procedemos a crear nuestro túnel VPN mediante la aplicación WireGuard. La configuración que utilizaremos sigue el mismo patrón que hemos venido utilizando en nuestras configuraciones anteriores:</p>

<p><a href="/assets/img/posts/vpn/image12.png" class="popup img-link  shimmer"><img src="/assets/img/posts/vpn/image12.png" alt="image" loading="lazy"></a></p>

<p>Podemos observar que el handshake está funcionando correctamente, lo cual nos indica que el intercambio inicial de claves se ha realizado con éxito.</p>

<p>Para verificar la creación del túnel, abrimos nuestra terminal en <strong>Termius</strong> y ejecutamos el comando <code class="language-plaintext highlighter-rouge">ip a</code>. Este nos mostrará todas las interfaces de red, donde podremos confirmar la presencia de nuestro túnel WireGuard:</p>

<p><a href="/assets/img/posts/vpn/image13.png" class="popup img-link  shimmer"><img src="/assets/img/posts/vpn/image13.png" alt="image" loading="lazy"></a></p>

<p>El siguiente paso nos lleva de vuelta a nuestro <strong>Servidor</strong>, donde necesitamos actualizar el archivo <code class="language-plaintext highlighter-rouge">wg0.conf</code> con los parámetros correspondientes a nuestro cliente Android:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="c"># CLIENTE ANDROID</span>

<span class="o">[</span>Peer]

Publickey <span class="o">=</span> YlKnopzZ1myt29MnP6rZ1WwMgLm1QVSOY+t0vyngtD8<span class="o">=</span>

AllowedIPs <span class="o">=</span> 10.99.99.4/32

PersistentKeepAlive <span class="o">=</span> 25
</pre></td></tr></tbody></table></code></div></div>

<p>Tras añadir esta configuración, debemos reiniciar la interfaz del túnel para que los cambios surtan efecto. Podemos verificar el estado actual de nuestras conexiones mediante el comando <code class="language-plaintext highlighter-rouge">wg</code>:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="rouge-code"><pre>root@Servidor:/etc/wireguard# wg
interface: wg0
  public key: 7+qFaDTqy/WIHiPrucnpTdCJRNbqFvlANVQdwsmITCo<span class="o">=</span>
  private key: <span class="o">(</span>hidden<span class="o">)</span>
  listening port: 51820

peer: F/eZilIdeYh1iY2Fx6GHfVRlAM0AoVvBamiZ/Zbf+Aw<span class="o">=</span>
  endpoint: 172.22.0.4:51820
  allowed ips: 10.99.99.2/32
  latest handshake: 26 seconds ago
  transfer: 2.20 KiB received, 1.46 KiB sent
  persistent keepalive: every 25 seconds

peer: Gw9vvlbUvr/Q2t2poFA1R53Y9mYlP718EKPCaWvsTns<span class="o">=</span>
  endpoint: 172.22.0.2:51820
  allowed ips: 10.99.99.3/32
  latest handshake: 1 minute, 11 seconds ago
  transfer: 61.41 KiB received, 632 B sent
  persistent keepalive: every 25 seconds

peer: YlKnopzZ1myt29MnP6rZ1WwMgLm1QVSOY+t0vyngtD8<span class="o">=</span>
  allowed ips: 10.99.99.4/32
  persistent keepalive: every 25 seconds
</pre></td></tr></tbody></table></code></div></div>

<h3 id="comprobación-funcionamiento-2"><span class="me-2">Comprobación funcionamiento</span><a href="#comprobación-funcionamiento-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Para asegurarnos de que todo está funcionando correctamente, realizaremos una prueba de conectividad utilizando la terminal de <strong>Termius</strong>. Ejecutamos un <code class="language-plaintext highlighter-rouge">traceroute</code> para visualizar la ruta que siguen nuestros paquetes:</p>

<p><a href="/assets/img/posts/vpn/image14.png" class="popup img-link  shimmer"><img src="/assets/img/posts/vpn/image14.png" alt="image" loading="lazy"></a></p>

<p>Como podemos ver, el túnel está funcionando a la perfección.</p>

<p>Para tener una visión completa del funcionamiento de nuestra red, podemos ver el estado del tráfico entre todos los clientes conectados:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td><td class="rouge-code"><pre>root@Servidor:/etc/wireguard# wg
interface: wg0
  public key: 7+qFaDTqy/WIHiPrucnpTdCJRNbqFvlANVQdwsmITCo<span class="o">=</span>
  private key: <span class="o">(</span>hidden<span class="o">)</span>
  listening port: 51820

peer: YlKnopzZ1myt29MnP6rZ1WwMgLm1QVSOY+t0vyngtD8<span class="o">=</span>
  endpoint: 172.22.0.3:51820
  allowed ips: 10.99.99.4/32
  latest handshake: 45 seconds ago
  transfer: 3.62 KiB received, 8.24 KiB sent
  persistent keepalive: every 25 seconds

peer: Gw9vvlbUvr/Q2t2poFA1R53Y9mYlP718EKPCaWvsTns<span class="o">=</span>
  endpoint: 172.22.0.2:51820
  allowed ips: 10.99.99.3/32
  latest handshake: 1 minute, 15 seconds ago
  transfer: 205.21 KiB received, 11.40 KiB sent
  persistent keepalive: every 25 seconds

peer: F/eZilIdeYh1iY2Fx6GHfVRlAM0AoVvBamiZ/Zbf+Aw<span class="o">=</span>
  endpoint: 172.22.0.4:51820
  allowed ips: 10.99.99.2/32
  latest handshake: 2 minutes, 8 seconds ago
  transfer: 14.00 KiB received, 6.36 KiB sent
  persistent keepalive: every 25 seconds
</pre></td></tr></tbody></table></code></div></div>

<p><a href="/assets/img/posts/vpn/image15.png" class="popup img-link  shimmer"><img src="/assets/img/posts/vpn/image15.png" alt="image" loading="lazy"></a></p>

<h2 id="conclusión"><span class="me-2">Conclusión</span><a href="#conclusión" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Sin ningún tipo de duda me ha parecido mucho mejor y más práctico esta forma de hacerlo con WireGuard que con OpenVPN. De la otra forma pienso que es más lioso ya que tienes que estar creando y moviendo ficheros de certificado con lo que ello conlleva. Esta forma es mucho más intuitiva y fácil de entender en mi opinión.</p>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/seguridad/">Seguridad</a>,
          <a href="/categories/vpn/">VPN</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/vpn/"
            class="post-tag no-text-decoration"
          >VPN</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=VPN%20de%20acceso%20remoto%20con%20WireGuard%20-%20Blog%20personal&url=%2Fposts%2Facceso_remoto_wireguard%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=VPN%20de%20acceso%20remoto%20con%20WireGuard%20-%20Blog%20personal&u=%2Fposts%2Facceso_remoto_wireguard%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=%2Fposts%2Facceso_remoto_wireguard%2F&text=VPN%20de%20acceso%20remoto%20con%20WireGuard%20-%20Blog%20personal" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/auditoria/">Auditoría</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/systemd-boot/">Systemd-Boot</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/forense/">Informática forense</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/selinux/">Configuración/activación de SELinux</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/systemd/">systemd/sshfs</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/vpn/">VPN</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/criptograf%C3%ADa/">Criptografía</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/systemd/">Systemd</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/an%C3%A1lisis/">Análisis</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/aplicaciones/">Aplicaciones</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/automatizaci%C3%B3n/">Automatización</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/cloud/">Cloud</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/compartici%C3%B3n-de-archivos/">Compartición de archivos</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/instalaci%C3%B3n/">Instalación</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/monitoreo-y-gesti%C3%B3n-de-logs/">Monitoreo y Gestión de Logs</a>
      
    </div>
  </section>


            </div>

            
              
              



  <section id="toc-wrapper" class="d-none ps-0 pe-4">
    <h2 class="panel-heading ps-3 mb-2">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  

  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/site_to_site_wireguard/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1738177200"
  data-df="ll"
  
>
  Jan 29, 2025
</time>

              <h4 class="pt-0 my-2">VPN sitio a sitio con WireGuard</h4>
              <div class="text-muted">
                <p>En esta práctica implementamos una solución VPN utilizando WireGuard para establecer una conexión segura y eficiente entre dos redes distintas. La configuración permite la comunicación bidirecciona...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/site_to_site_openvpn/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1737910800"
  data-df="ll"
  
>
  Jan 26, 2025
</time>

              <h4 class="pt-0 my-2">VPN sitio a sitio con OpenVPN y certificados x509</h4>
              <div class="text-muted">
                <p>En esta práctica configuraremos una VPN con OpenVPN en GNS3, implementando tanto una VPN de acceso remoto como una VPN sitio a sitio. Usaremos autenticación con certificados x509 generados con Open...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/acceso_remoto_openvpn/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1737633600"
  data-df="ll"
  
>
  Jan 23, 2025
</time>

              <h4 class="pt-0 my-2">VPN de acceso remoto con OpenVPN y certificados x509</h4>
              <div class="text-muted">
                <p>Las VPNs son esenciales para garantizar conexiones seguras a redes privadas a través de Internet. En este artículo exploramos cómo configurar una VPN de acceso remoto con OpenVPN en un entorno de s...</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/site_to_site_openvpn/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>VPN sitio a sitio con OpenVPN y certificados x509</p>
    </a>
  

  
    <a
      href="/posts/site_to_site_wireguard/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>VPN sitio a sitio con WireGuard</p>
    </a>
  
</nav>

            
              
              <!-- The comments switcher -->


            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2025</time>

    
      <a href="https://github.com/PabloMartin19">Pablo Martín Hidalgo</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.1.1"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/vpn/">VPN</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/criptograf%C3%ADa/">Criptografía</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/systemd/">Systemd</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/an%C3%A1lisis/">Análisis</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/aplicaciones/">Aplicaciones</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/automatizaci%C3%B3n/">Automatización</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/cloud/">Cloud</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/compartici%C3%B3n-de-archivos/">Compartición de archivos</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/instalaci%C3%B3n/">Instalación</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/monitoreo-y-gesti%C3%B3n-de-logs/">Monitoreo y Gestión de Logs</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- JavaScripts -->
    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.29.0/dist/tocbot.min.js"></script>







<script src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  







    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
    noResultsText: '<p class="mt-5">Oops! No results found.</p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
</html>


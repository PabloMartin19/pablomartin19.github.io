<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="es" >
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="Escenario en OpenStack" />
<meta name="author" content="Pablo Martín Hidalgo" />
<meta property="og:locale" content="es" />
<meta name="description" content="En esta tarea se va a crear el escenario de trabajo que se va a usar durante todo el curso, que va a constar inicialmente de 4 máquinas: 2 instancias en OpenStack y dos contenedores LXC que se ejecutarán en una de las instancias." />
<meta property="og:description" content="En esta tarea se va a crear el escenario de trabajo que se va a usar durante todo el curso, que va a constar inicialmente de 4 máquinas: 2 instancias en OpenStack y dos contenedores LXC que se ejecutarán en una de las instancias." />
<link rel="canonical" href="/posts/openstack/" />
<meta property="og:url" content="/posts/openstack/" />
<meta property="og:site_name" content="Blog personal" />
<meta property="og:image" content="/assets/img/posts/openstack/openstack.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-12-11T18:15:00+01:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="/assets/img/posts/openstack/openstack.png" />
<meta property="twitter:title" content="Escenario en OpenStack" />
<meta name="twitter:site" content="@Tagarnina10" />
<meta name="twitter:creator" content="@Tagarnina10" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Pablo Martín Hidalgo","url":"https://github.com/PabloMartin19/"},"dateModified":"2024-12-16T12:17:02+01:00","datePublished":"2024-12-11T18:15:00+01:00","description":"En esta tarea se va a crear el escenario de trabajo que se va a usar durante todo el curso, que va a constar inicialmente de 4 máquinas: 2 instancias en OpenStack y dos contenedores LXC que se ejecutarán en una de las instancias.","headline":"Escenario en OpenStack","image":"/assets/img/posts/openstack/openstack.png","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/openstack/"},"url":"/posts/openstack/"}</script>
<!-- End Jekyll SEO tag -->


  <title>Escenario en OpenStack | Blog personal
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Blog personal">
<meta name="application-name" content="Blog personal">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.6.0/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.29.0/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- JavaScript -->

  
    <!-- Switch the mode between dark and light. -->

<script type="text/javascript">
  class ModeToggle {
    static get MODE_KEY() {
      return 'mode';
    }
    static get MODE_ATTR() {
      return 'data-mode';
    }
    static get DARK_MODE() {
      return 'dark';
    }
    static get LIGHT_MODE() {
      return 'light';
    }
    static get ID() {
      return 'mode-toggle';
    }

    constructor() {
      let self = this;this.sysDarkPrefers.addEventListener('change', () => {
        if (self.hasMode) {
          self.clearMode();
        }
        self.notify();
      });

      if (!this.hasMode) {
        return;
      }

      if (this.isDarkMode) {
        this.setDark();
      } else {
        this.setLight();
      }
    }

    get sysDarkPrefers() {
      return window.matchMedia('(prefers-color-scheme: dark)');
    }

    get isPreferDark() {
      return this.sysDarkPrefers.matches;
    }

    get isDarkMode() {
      return this.mode === ModeToggle.DARK_MODE;
    }

    get hasMode() {
      return this.mode != null;
    }

    get mode() {
      return sessionStorage.getItem(ModeToggle.MODE_KEY);
    }get modeStatus() {
      if (this.hasMode) {
        return this.mode;
      } else {
        return this.isPreferDark ? ModeToggle.DARK_MODE : ModeToggle.LIGHT_MODE;
      }
    }

    setDark() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }

    setLight() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }

    clearMode() {
      document.documentElement.removeAttribute(ModeToggle.MODE_ATTR);
      sessionStorage.removeItem(ModeToggle.MODE_KEY);
    }notify() {
      window.postMessage(
        {
          direction: ModeToggle.ID,
          message: this.modeStatus
        },
        '*'
      );
    }

    flipMode() {
      if (this.hasMode) {
        this.clearMode();
      } else {
        if (this.isPreferDark) {
          this.setLight();
        } else {
          this.setDark();
        }
      }

      this.notify();
    }
  }

  const modeToggle = new ModeToggle();
</script>

  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/avatar.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">Blog personal</a>
    <p class="site-subtitle fst-italic mb-0">Los mejores programas son aquellos que funcionan.</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
      

      
        <a
          href="https://github.com/PabloMartin19"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://twitter.com/Tagarnina10"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fa-brands fa-x-twitter"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['pmartinhidalgo19','gmail.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="https://www.linkedin.com/in/pablomartinhidalgo/"
          aria-label="linkedin"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-linkedin"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>Escenario en OpenStack</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  




<!-- return -->




<article class="px-1">
  <header>
    <h1 data-toc-skip>Escenario en OpenStack</h1>
    
      <p class="post-desc fw-light mb-4">En esta tarea se va a crear el escenario de trabajo que se va a usar durante todo el curso, que va a constar inicialmente de 4 máquinas: 2 instancias en OpenStack y dos contenedores LXC que se ejecutarán en una de las instancias.</p>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1733937300"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Dec 11, 2024
</time>

      </span>

      <!-- lastmod date -->
      
        <span>
          Updated
          <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1734347822"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Dec 16, 2024
</time>

        </span>
      

      
        
        
        

        

        <div class="mt-3 mb-3">
          <a href="/assets/img/posts/openstack/openstack.png" class="popup img-link preview-img shimmer"><img src="/assets/img/posts/openstack/openstack.png"  alt="Preview Image" width="1200" height="630"  loading="lazy"></a></div>
      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              
                <a href="https://github.com/PabloMartin19/">Pablo Martín Hidalgo</a>
                
              
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="5587 words"
>
  <em>31 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  <div class="content">
    <h2 id="práctica-1--2-escenario-en-openstack"><span class="me-2">Práctica (1 / 2): Escenario en OpenStack</span><a href="#práctica-1--2-escenario-en-openstack" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Para nombrar las máquinas se van a utilizar los siguientes nombres: <strong>luffy</strong>, <strong>zoro</strong>, <strong>nami</strong>, <strong>sanji</strong>. Estos nombres pertenecen la serie manga <strong>One Piece</strong>.</p>

<p>Además el dominio será un subdominio de la forma tunombre.gonzalonazareno.org. De esta forma tendremos:</p>

<ul>
  <li>Máquina 1: Instancia en OpenStack con <strong>Debian 12 Bookworm</strong> que se llama luffy.tunombre.gonzalonazareno.org.</li>
  <li>Máquina 2: Instancia en OpenStack con <strong>Rocky Linux 9</strong> que se llama zoro.tunombre.gonzalonazareno.org.</li>
  <li>Máquina 3: Contenedor LXC con <strong>Ubuntu 22.04</strong> que se llama nami.tunombre.gonzalonazareno.org.</li>
  <li>Máquina 4: Contenedor LXC con <strong>Ubuntu 22.04</strong> que se llama sanji.tunombre.gonzalonazareno.org.</li>
</ul>

<p>Todas las operaciones que realices sobre recursos de OpenStack lo tienes que hacer usando OSC.</p>

<p><a href="/assets/img/posts/openstack/os.drawio.png" class="popup img-link  shimmer"><img src="/assets/img/posts/openstack/os.drawio.png" alt="image1" loading="lazy"></a></p>

<h3 id="creación-de-la-infraestructura-de-red"><span class="me-2">Creación de la infraestructura de red</span><a href="#creación-de-la-infraestructura-de-red" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<ul>
  <li>Crea un nuevo router llamado <strong>RouterPractica</strong> conectado a la red externa.</li>
</ul>

<p>Para crear el router ejecutamos el siguiente comando:</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre>(os) pavlo@debian:~/OpenStack()$ openstack router create RouterPractica
+---------------------------+--------------------------------------+
| Field                     | Value                                |
+---------------------------+--------------------------------------+
| admin_state_up            | UP                                   |
| availability_zone_hints   |                                      |
| availability_zones        |                                      |
| created_at                | 2024-12-11T17:32:26Z                 |
| description               |                                      |
| enable_default_route_bfd  | False                                |
| enable_default_route_ecmp | False                                |
| enable_ndp_proxy          | None                                 |
| external_gateway_info     | null                                 |
| external_gateways         | []                                   |
| flavor_id                 | None                                 |
| id                        | c94e22f0-5551-4842-9628-a9d3929b5539 |
| name                      | RouterPractica                       |
| project_id                | 07df99f775d343a58e702b5c99adcbad     |
| revision_number           | 1                                    |
| routes                    |                                      |
| status                    | ACTIVE                               |
| tags                      |                                      |
| tenant_id                 | 07df99f775d343a58e702b5c99adcbad     |
| updated_at                | 2024-12-11T17:32:26Z                 |
+---------------------------+--------------------------------------+
</pre></td></tr></tbody></table></code></div></div>

<p>Luego, lo añadimos a la red pública que por lo general suele ser <em>public</em>, aunque en este caso es <em>ext-net</em>:</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>(os) pavlo@debian:~/OpenStack()$ openstack router set RouterPractica --external-gateway ext-net
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>
    <p>Crea una red interna que se llame <strong>Red Intra de tu_usuario</strong>, con las siguientes características:</p>

    <ul>
      <li>
        <p>Está conectada al router que has creado en el punto anterior.</p>
      </li>
      <li>
        <p>Direccionamiento: <code class="language-plaintext highlighter-rouge">10.0.200.0/24</code></p>
      </li>
      <li>
        <p>Con DHCP y DNS <code class="language-plaintext highlighter-rouge">(172.22.0.1)</code>.</p>
      </li>
      <li>
        <p>La puerta de enlace de los dispositivos conectados a esta red será el <code class="language-plaintext highlighter-rouge">10.0.200.1</code>.</p>
      </li>
    </ul>
  </li>
</ul>

<p>Para este paso debemos crear una red:</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre></td><td class="rouge-code"><pre>(os) pavlo@debian:~/OpenStack()$ openstack network create red-intra-pablo
+---------------------------+--------------------------------------+
| Field                     | Value                                |
+---------------------------+--------------------------------------+
| admin_state_up            | UP                                   |
| availability_zone_hints   |                                      |
| availability_zones        |                                      |
| created_at                | 2024-12-11T17:33:53Z                 |
| description               |                                      |
| dns_domain                | None                                 |
| id                        | 260d2b52-38e8-449f-a368-a68824d2474f |
| ipv4_address_scope        | None                                 |
| ipv6_address_scope        | None                                 |
| is_default                | False                                |
| is_vlan_transparent       | None                                 |
| mtu                       | 1442                                 |
| name                      | red-intra-pablo                      |
| port_security_enabled     | True                                 |
| project_id                | 07df99f775d343a58e702b5c99adcbad     |
| provider:network_type     | None                                 |
| provider:physical_network | None                                 |
| provider:segmentation_id  | None                                 |
| qos_policy_id             | None                                 |
| revision_number           | 1                                    |
| router:external           | Internal                             |
| segments                  | None                                 |
| shared                    | False                                |
| status                    | ACTIVE                               |
| subnets                   |                                      |
| tags                      |                                      |
| updated_at                | 2024-12-11T17:33:53Z                 |
+---------------------------+--------------------------------------+
</pre></td></tr></tbody></table></code></div></div>

<p>Luego, crear la subred con las especificaciones:</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre></td><td class="rouge-code"><pre>(os) pavlo@debian:~/OpenStack()$ openstack subnet create red-intra-pablo-subnet \
&gt; --network red-intra-pablo \
&gt; --subnet-range 10.0.200.0/24 \
&gt; --dhcp \
&gt; --gateway 10.0.200.1 \
&gt; --dns-nameserver 172.22.0.1
+----------------------+--------------------------------------+
| Field                | Value                                |
+----------------------+--------------------------------------+
| allocation_pools     | 10.0.200.2-10.0.200.254              |
| cidr                 | 10.0.200.0/24                        |
| created_at           | 2024-12-11T17:35:40Z                 |
| description          |                                      |
| dns_nameservers      | 172.22.0.1                           |
| dns_publish_fixed_ip | None                                 |
| enable_dhcp          | True                                 |
| gateway_ip           | 10.0.200.1                           |
| host_routes          |                                      |
| id                   | 7ef74cd9-63bf-4b2e-8479-69250a4a087b |
| ip_version           | 4                                    |
| ipv6_address_mode    | None                                 |
| ipv6_ra_mode         | None                                 |
| name                 | red-intra-pablo-subnet               |
| network_id           | 260d2b52-38e8-449f-a368-a68824d2474f |
| project_id           | 07df99f775d343a58e702b5c99adcbad     |
| revision_number      | 0                                    |
| segment_id           | None                                 |
| service_types        |                                      |
| subnetpool_id        | None                                 |
| tags                 |                                      |
| updated_at           | 2024-12-11T17:35:40Z                 |
+----------------------+--------------------------------------+
</pre></td></tr></tbody></table></code></div></div>

<p>Por último añadimos la subnet creada en el paso anterior al router creado al principio:</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>(os) pavlo@debian:~/OpenStack()$ openstack router add subnet RouterPractica red-intra-pablo-subnet
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>
    <p>Crea una red interna que se llame <strong>Red DMZ de tu_usuario</strong>, con las siguientes características:</p>

    <ul>
      <li>
        <p>Direccionamiento: <code class="language-plaintext highlighter-rouge">172.16.0.0/16</code></p>
      </li>
      <li>
        <p><strong>Sin DHCP</strong>.</p>
      </li>
      <li>
        <p><strong>Deshabilitamos la puerta de enlace</strong>. Esto es para que cloud-init no configure la puerta de enlace en las instancias conectada a esta red.</p>
      </li>
      <li>
        <p>La puerta de enlace de los dispositivos conectados a esta red será el <code class="language-plaintext highlighter-rouge">172.16.0.1</code>.</p>
      </li>
    </ul>
  </li>
</ul>

<p>Para crear esta red hacemos lo mismo que antes:</p>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre></td><td class="rouge-code"><pre>(os) pavlo@debian:~/OpenStack()$ openstack network create red-dmz-pablo
+---------------------------+--------------------------------------+
| Field                     | Value                                |
+---------------------------+--------------------------------------+
| admin_state_up            | UP                                   |
| availability_zone_hints   |                                      |
| availability_zones        |                                      |
| created_at                | 2024-12-11T17:41:36Z                 |
| description               |                                      |
| dns_domain                | None                                 |
| id                        | b6ae55f9-e6fb-4509-bd3b-fd627a3da1d8 |
| ipv4_address_scope        | None                                 |
| ipv6_address_scope        | None                                 |
| is_default                | False                                |
| is_vlan_transparent       | None                                 |
| mtu                       | 1442                                 |
| name                      | red-dmz-pablo                        |
| port_security_enabled     | True                                 |
| project_id                | 07df99f775d343a58e702b5c99adcbad     |
| provider:network_type     | None                                 |
| provider:physical_network | None                                 |
| provider:segmentation_id  | None                                 |
| qos_policy_id             | None                                 |
| revision_number           | 1                                    |
| router:external           | Internal                             |
| segments                  | None                                 |
| shared                    | False                                |
| status                    | ACTIVE                               |
| subnets                   |                                      |
| tags                      |                                      |
| updated_at                | 2024-12-11T17:41:36Z                 |
+---------------------------+--------------------------------------+
</pre></td></tr></tbody></table></code></div></div>

<p>Luego creamos la subnet indicando que no queremos dhcp ni puerta de enlace:</p>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre></td><td class="rouge-code"><pre>(os) pavlo@debian:~/OpenStack()$ openstack subnet create red-dmz-pablo-subnet \
&gt; --network red-dmz-pablo \
&gt; --subnet-range 172.16.0.0/16 \
&gt; --no-dhcp \
&gt; --gateway none
+----------------------+--------------------------------------+
| Field                | Value                                |
+----------------------+--------------------------------------+
| allocation_pools     | 172.16.0.1-172.16.255.254            |
| cidr                 | 172.16.0.0/16                        |
| created_at           | 2024-12-11T17:44:05Z                 |
| description          |                                      |
| dns_nameservers      |                                      |
| dns_publish_fixed_ip | None                                 |
| enable_dhcp          | False                                |
| gateway_ip           | None                                 |
| host_routes          |                                      |
| id                   | 450496f9-646a-42a4-9a8e-b07b5b3a992d |
| ip_version           | 4                                    |
| ipv6_address_mode    | None                                 |
| ipv6_ra_mode         | None                                 |
| name                 | red-dmz-pablo-subnet                 |
| network_id           | b6ae55f9-e6fb-4509-bd3b-fd627a3da1d8 |
| project_id           | 07df99f775d343a58e702b5c99adcbad     |
| revision_number      | 0                                    |
| segment_id           | None                                 |
| service_types        |                                      |
| subnetpool_id        | None                                 |
| tags                 |                                      |
| updated_at           | 2024-12-11T17:44:05Z                 |
+----------------------+--------------------------------------+
</pre></td></tr></tbody></table></code></div></div>

<p>Aunque no configuramos la puerta de enlace en la red (para evitar que cloud-init lo haga automáticamente), las instancias se pueden configurar manualmente si es necesario.</p>

<p>La dirección <code class="language-plaintext highlighter-rouge">172.16.0.1</code> será la puerta de enlace predeterminada que los dispositivos pueden usar.</p>

<p><a href="/assets/img/posts/openstack/proyecto.png" class="popup img-link  shimmer"><img src="/assets/img/posts/openstack/proyecto.png" alt="image2" loading="lazy"></a></p>

<h3 id="instalación-de-las-instancias-de-openstack"><span class="me-2">Instalación de las instancias de OpenStack</span><a href="#instalación-de-las-instancias-de-openstack" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<h4 id="configuración-de-las-instancias"><span class="me-2">Configuración de las instancias</span><a href="#configuración-de-las-instancias" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p>Las dos instancias que vamos a crear se van a configurar con <code class="language-plaintext highlighter-rouge">cloud-init</code> de la siguiente manera:</p>

<ul>
  <li>
    <p>Deben actualizar los paquetes de la distribución de la instancia.</p>
  </li>
  <li>
    <p>El dominio utilizado será del tipo <code class="language-plaintext highlighter-rouge">tunombre.gonzalonazareno.org</code>. Por lo tanto en la configuración con <code class="language-plaintext highlighter-rouge">cloud-init</code> habrá que indicar el hostname y el FQDN.</p>
  </li>
  <li>
    <p>Se crearán dos usuarios:</p>

    <ul>
      <li>
        <p>Un usuario sin privilegios. Se puede llamar como quieras (pero el nombre será el mismo en todas las máquinas) y accederás a las máquinas usando tu clave ssh privada.</p>
      </li>
      <li>
        <p>Un usuario <code class="language-plaintext highlighter-rouge">profesor</code>, que puede utilizar <code class="language-plaintext highlighter-rouge">sudo</code> sin contraseña. Copia de las claves públicas de todos los profesores en las instancias para que puedan acceder con el usuario <code class="language-plaintext highlighter-rouge">profesor</code>.</p>
      </li>
    </ul>
  </li>
  <li>
    <p>Cambia la contraseña al usuario <code class="language-plaintext highlighter-rouge">root</code>.</p>
  </li>
</ul>

<p>Bueno pues para ello debemos crear el fichero <code class="language-plaintext highlighter-rouge">cloud-init-luffy.yaml</code> en donde añadiremos las configuraciones que se pide:</p>

<div class="language-yaml highlighter-rouge"><div class="code-header">
        <span data-label-text="YAML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td><td class="rouge-code"><pre><span class="c1">#cloud-config</span>
<span class="na">package_update</span><span class="pi">:</span> <span class="kc">true</span>
<span class="na">package_upgrade</span><span class="pi">:</span> <span class="kc">true</span>

<span class="na">hostname</span><span class="pi">:</span> <span class="s">luffy</span>
<span class="na">fqdn</span><span class="pi">:</span> <span class="s">luffy.pablo.gonzalonazareno.org</span>

<span class="na">users</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">pablo</span>
    <span class="na">shell</span><span class="pi">:</span> <span class="s">/bin/bash</span>
    <span class="na">sudo</span><span class="pi">:</span> <span class="pi">[</span><span class="s1">'</span><span class="s">ALL=(ALL)</span><span class="nv"> </span><span class="s">NOPASSWD:ALL'</span><span class="pi">]</span>
    <span class="na">ssh_authorized_keys</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">ssh-rsa</span><span class="nv"> </span><span class="s">AAAAB3NzaC1yc2EAAAADAQABAAABgQClFcnIhYd1oaEpvGi/f4psQc4+DaAZvSNIxVRRJHtRoJui8wbJybi3Om8yTOflgEcmBaUrJLkfmzmWqVq1j6MpESq72p7J2hdq2lXnvzdt3huYv5evFwyd0p/r72RfpVZzr3ILi/BS//SJqfVKlDEVbZRaOE5MU2XuElmFFY4EO7NiiZAkbatVqUOT8H/nrfXcad0mjZVxroVqHhsHV+06rxiB0xifG0xZv204Qj4zRura8uqZlEVAAwU+NO/SIGdRwpLY7n7xbQGe1DbjHgPUeVPjJX6HpMK41a43eGj4XYdYtZBLugaU8Mq1y6Kl3tE6cvYkQ9WFTYTLLNy3bvNRZpP2p6qAy5qn03ZLFICiXBNXPmrl5+KVrKaSipNaPHkmInvczbYJjXpfyVBsfEabt+0Y1629M+eEKkkl+iZmVr2ySDSS1gHxMC7zlJRaUhG27o26agpNPYPHH3mVXVjqdGg0ryH0YHZk1V8+Gt1Z9hZ7UYWE1UX8DCgFfecqdX0=</span><span class="nv"> </span><span class="s">pavlo@debian"</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">profesor</span>
    <span class="na">shell</span><span class="pi">:</span> <span class="s">/bin/bash</span>
    <span class="na">sudo</span><span class="pi">:</span> <span class="pi">[</span><span class="s1">'</span><span class="s">ALL=(ALL)</span><span class="nv"> </span><span class="s">NOPASSWD:ALL'</span><span class="pi">]</span>
    <span class="na">ssh_authorized_keys</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">ssh-rsa</span><span class="nv"> </span><span class="s">AAAAB3NzaC1yc2EAAAADAQABAAABAQCmjoVIoZCx4QFXvljqozXGqxxlSvO7V2aizqyPgMfGqnyl0J9YXo6zrcWYwyWMnMdRdwYZgHqfiiFCUn2QDm6ZuzC4Lcx0K3ZwO2lgL4XaATykVLneHR1ib6RNroFcClN69cxWsdwQW6dpjpiBDXf8m6/qxVP3EHwUTsP8XaOV7WkcCAqfYAMvpWLISqYme6e+6ZGJUIPkDTxavu5JTagDLwY+py1WB53eoDWsG99gmvyit2O1Eo+jRWN+mgRHIxJTrFtLS6o4iWeshPZ6LvCZ/Pum12Oj4B4bjGSHzrKjHZgTwhVJ/LDq3v71/PP4zaI3gVB9ZalemSxqomgbTlnT</span><span class="nv"> </span><span class="s">jose@debian"</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">ssh-rsa</span><span class="nv"> </span><span class="s">AAAAB3NzaC1yc2EAAAADAQABAAABgQDf9lnBH2nCT2ezpDZnqSBeDuSsVGGFD1Kzqa4KyIVkzkrD7pNHHkkpSuO4isKcCsUcopYOcA38QtG7wB0v/qn8Jsq731N8bjaKOdQN25vqLjwVj8DpYtvGc+ZA0uaChe7TS+QBzlMC9ypwj4wf15Q/z3v/ip4FF2cORT0cQC04cNRQDgUg4p1rlOs8+ma7OPh3P3UvzlPfLhi2H1yl+/mo4XLOcAMNr/jiZCwYxom6OEOYVBNk8MZX/Zn+qRi71D0RPiKg27AcXSD/FPWdQW9hBH1Zq5xGicUFS4C9yXvHKru7cMmmxV2G80p/ArRscKWq92UT5jIJQpccmHxsxdIi6o25LhcxH1dOnZy6kHcJ2yP24CnBHK5Y3SsovCD0Th6MN1VlTySbl8Ar0ypmY+GYO+oVd4bM3ioHzL0AMqYnS29m0UtEDvFEUUoSkOoLK4uSlcvej+OIVp7X5G7oZ56nZZf+qHEgodv++a6vPmhH2ZSgoOj1sE39DK7InuKSqCE=</span><span class="nv"> </span><span class="s">rafa@eco"</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">ssh-rsa</span><span class="nv"> </span><span class="s">AAAAB3NzaC1yc2EAAAADAQABAAABgQDASDwvkY5SbIgM+/j14mNQluPV+/HGcM3ZgXrYDWt7zhQKq8KAXqJLs1vw1HcRv5PRV071caZQxV2ssfrNqIDofjSzWM1I1JkVIqIj4NCOsRFsQQFN8HwfkE9ic/X6vRaV+NfkEF+t3VmX2YgBd02ZbmGt53qjDaGMQRS/qxw3MPS+ynf2Fj8ZibT6DZeWnyjEGhFcyrggFWiPDqw77MNaiDr+31SO0TaP1WeIWFMrSwPVMVG1zvSxAQ9L13SQ5XzwK0Xs2A8kBPiZmPuUFRqYlBWeffhUnRPSg4TdOsWqJjEwFb5OwpQmTDCT5z0MSFCNVLV5GGwvvqCrw5jd1Xfdswdqazc8mCaIPIrCmhsiwz7uZvQDYr1HDrKxJ1L8LLo3usp4FM5cCCM5jptK+XffhmIyJSkMrcg6tYawBeNuAiY3dwPRIyKeV1Ku3UUctkN+kbuOpMQ4nSvAK0DyhUiTakc8qMJDNLD8oHhSEp49G2bzsLwFOmaEgb8falVMLyk=</span><span class="nv"> </span><span class="s">javji@Javier"</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">root</span>
    <span class="na">passwd</span><span class="pi">:</span> <span class="s2">"</span><span class="s">root"</span>

<span class="na">final_message</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Instancia</span><span class="nv"> </span><span class="s">configurada</span><span class="nv"> </span><span class="s">correctamente."</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Este fichero está destinado a la configuración de la instancia <em>luffy</em>.</p>

<p>A continuación, crearé el archivo <code class="language-plaintext highlighter-rouge">cloud-init-zoro.yaml</code> para la posterior creación de la instancia <em>zoro</em>.</p>

<div class="language-yaml highlighter-rouge"><div class="code-header">
        <span data-label-text="YAML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td><td class="rouge-code"><pre><span class="c1">#cloud-config</span>
<span class="na">package_update</span><span class="pi">:</span> <span class="kc">true</span>
<span class="na">package_upgrade</span><span class="pi">:</span> <span class="kc">true</span>
<span class="na">hostname</span><span class="pi">:</span> <span class="s">zoro</span>
<span class="na">fqdn</span><span class="pi">:</span> <span class="s">zoro.pablo.gonzalonazareno.org</span>
<span class="na">users</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">pablo</span>
    <span class="na">gecos</span><span class="pi">:</span> <span class="s">Usuario sin privilegios</span>
    <span class="na">groups</span><span class="pi">:</span> <span class="pi">[]</span>
    <span class="na">shell</span><span class="pi">:</span> <span class="s">/bin/bash</span>
    <span class="na">sudo</span><span class="pi">:</span> <span class="pi">[</span><span class="s1">'</span><span class="s">ALL=(ALL)</span><span class="nv"> </span><span class="s">NOPASSWD:ALL'</span><span class="pi">]</span>
    <span class="na">ssh_authorized_keys</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">ssh-rsa</span><span class="nv"> </span><span class="s">AAAAB3NzaC1yc2EAAAADAQABAAABgQClFcnIhYd1oaEpvGi/f4psQc4+DaAZvSNIxVRRJHtRoJui8wbJybi3Om8yTOflgEcmBaUrJLkfmzmWqVq1j6MpESq72p7J2hdq2lXnvzdt3huYv5evFwyd0p/r72RfpVZzr3ILi/BS//SJqfVKlDEVbZRaOE5MU2XuElmFFY4EO7NiiZAkbatVqUOT8H/nrfXcad0mjZVxroVqHhsHV+06rxiB0xifG0xZv204Qj4zRura8uqZlEVAAwU+NO/SIGdRwpLY7n7xbQGe1DbjHgPUeVPjJX6HpMK41a43eGj4XYdYtZBLugaU8Mq1y6Kl3tE6cvYkQ9WFTYTLLNy3bvNRZpP2p6qAy5qn03ZLFICiXBNXPmrl5+KVrKaSipNaPHkmInvczbYJjXpfyVBsfEabt+0Y1629M+eEKkkl+iZmVr2ySDSS1gHxMC7zlJRaUhG27o26agpNPYPHH3mVXVjqdGg0ryH0YHZk1V8+Gt1Z9hZ7UYWE1UX8DCgFfecqdX0=</span><span class="nv"> </span><span class="s">pavlo@debian"</span>

  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">profesor</span>
    <span class="na">gecos</span><span class="pi">:</span> <span class="s">Usuario Profesor</span>
    <span class="na">groups</span><span class="pi">:</span> <span class="s">sudo</span>
    <span class="na">shell</span><span class="pi">:</span> <span class="s">/bin/bash</span>
    <span class="na">sudo</span><span class="pi">:</span> <span class="pi">[</span><span class="s1">'</span><span class="s">ALL=(ALL)</span><span class="nv"> </span><span class="s">NOPASSWD:ALL'</span><span class="pi">]</span>
    <span class="na">ssh_authorized_keys</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">ssh-rsa</span><span class="nv"> </span><span class="s">AAAAB3NzaC1yc2EAAAADAQABAAABAQCmjoVIoZCx4QFXvljqozXGqxxlSvO7V2aizqyPgMfGqnyl0J9YXo6zrcWYwyWMnMdRdwYZgHqfiiFCUn2QDm6ZuzC4Lcx0K3ZwO2lgL4XaATykVLneHR1ib6RNroFcClN69cxWsdwQW6dpjpiBDXf8m6/qxVP3EHwUTsP8XaOV7WkcCAqfYAMvpWLISqYme6e+6ZGJUIPkDTxavu5JTagDLwY+py1WB53eoDWsG99gmvyit2O1Eo+jRWN+mgRHIxJTrFtLS6o4iWeshPZ6LvCZ/Pum12Oj4B4bjGSHzrKjHZgTwhVJ/LDq3v71/PP4zaI3gVB9ZalemSxqomgbTlnT</span><span class="nv"> </span><span class="s">jose@debian"</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">ssh-rsa</span><span class="nv"> </span><span class="s">AAAAB3NzaC1yc2EAAAADAQABAAABgQDf9lnBH2nCT2ezpDZnqSBeDuSsVGGFD1Kzqa4KyIVkzkrD7pNHHkkpSuO4isKcCsUcopYOcA38QtG7wB0v/qn8Jsq731N8bjaKOdQN25vqLjwVj8DpYtvGc+ZA0uaChe7TS+QBzlMC9ypwj4wf15Q/z3v/ip4FF2cORT0cQC04cNRQDgUg4p1rlOs8+ma7OPh3P3UvzlPfLhi2H1yl+/mo4XLOcAMNr/jiZCwYxom6OEOYVBNk8MZX/Zn+qRi71D0RPiKg27AcXSD/FPWdQW9hBH1Zq5xGicUFS4C9yXvHKru7cMmmxV2G80p/ArRscKWq92UT5jIJQpccmHxsxdIi6o25LhcxH1dOnZy6kHcJ2yP24CnBHK5Y3SsovCD0Th6MN1VlTySbl8Ar0ypmY+GYO+oVd4bM3ioHzL0AMqYnS29m0UtEDvFEUUoSkOoLK4uSlcvej+OIVp7X5G7oZ56nZZf+qHEgodv++a6vPmhH2ZSgoOj1sE39DK7InuKSqCE=</span><span class="nv"> </span><span class="s">rafa@eco"</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">ssh-rsa</span><span class="nv"> </span><span class="s">AAAAB3NzaC1yc2EAAAADAQABAAABgQDASDwvkY5SbIgM+/j14mNQluPV+/HGcM3ZgXrYDWt7zhQKq8KAXqJLs1vw1HcRv5PRV071caZQxV2ssfrNqIDofjSzWM1I1JkVIqIj4NCOsRFsQQFN8HwfkE9ic/X6vRaV+NfkEF+t3VmX2YgBd02ZbmGt53qjDaGMQRS/qxw3MPS+ynf2Fj8ZibT6DZeWnyjEGhFcyrggFWiPDqw77MNaiDr+31SO0TaP1WeIWFMrSwPVMVG1zvSxAQ9L13SQ5XzwK0Xs2A8kBPiZmPuUFRqYlBWeffhUnRPSg4TdOsWqJjEwFb5OwpQmTDCT5z0MSFCNVLV5GGwvvqCrw5jd1Xfdswdqazc8mCaIPIrCmhsiwz7uZvQDYr1HDrKxJ1L8LLo3usp4FM5cCCM5jptK+XffhmIyJSkMrcg6tYawBeNuAiY3dwPRIyKeV1Ku3UUctkN+kbuOpMQ4nSvAK0DyhUiTakc8qMJDNLD8oHhSEp49G2bzsLwFOmaEgb8falVMLyk=</span><span class="nv"> </span><span class="s">javji@Javier"</span>
<span class="na">chpasswd</span><span class="pi">:</span>
  <span class="na">list</span><span class="pi">:</span> <span class="pi">|</span>
    <span class="s">root:root</span>
  <span class="na">expire</span><span class="pi">:</span> <span class="s">False</span>
</pre></td></tr></tbody></table></code></div></div>

<h4 id="creación-de-las-instancias"><span class="me-2">Creación de las instancias</span><a href="#creación-de-las-instancias" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p><strong>máquina1 (luffy)</strong></p>

<ul>
  <li>
    <p>Crea una instancia sobre un volumen de 15Gb (el volumen se crea durante la creación de la instancia), usando una imagen de <strong>Debian 12 Bookworm</strong>. Elige el sabor <code class="language-plaintext highlighter-rouge">vol.medium</code>. Y configuralá con <code class="language-plaintext highlighter-rouge">cloud-init</code> como se ha indicado anteriormente.</p>
  </li>
  <li>
    <p>Está instancia estará conectada a las dos redes. Recuerda que en la red <strong>Red DMZ</strong> debe tomar la dirección <code class="language-plaintext highlighter-rouge">172.16.0.1</code> (puerta de enlace las máquinas conectadas a esta red). Asigna a la instancia una IP flotante.</p>
  </li>
  <li>
    <p>Deshabilita la seguridad de los puertos en las dos interfaces de red para que funcione de manera adecuada el NAT.</p>
  </li>
  <li>
    <p>Configura de forma permanente la regla SNAT para que las máquinas de la <strong>Red DMZ</strong> tengan acceso a internet.</p>
  </li>
</ul>

<p>En primer lugar debemos crear la instancia:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="o">(</span>os<span class="o">)</span> pavlo@debian:~/OpenStack<span class="o">()</span><span class="nv">$ </span>openstack server create luffy <span class="se">\</span>
<span class="o">&gt;</span> <span class="nt">--flavor</span> vol.medium <span class="se">\</span>
<span class="o">&gt;</span> <span class="nt">--image</span> <span class="s2">"Debian 12 Bookworm"</span> <span class="se">\</span>
<span class="o">&gt;</span> <span class="nt">--network</span> red-intra-pablo <span class="se">\</span>
<span class="o">&gt;</span> <span class="nt">--network</span> red-dmz-pablo <span class="se">\</span>
<span class="o">&gt;</span> <span class="nt">--user-data</span> cloud-init-luffy.yaml <span class="se">\</span>
<span class="o">&gt;</span> <span class="nt">--boot-from-volume</span> 15 <span class="se">\</span>
<span class="o">&gt;</span> <span class="nt">--security-group</span> default
</pre></td></tr></tbody></table></code></div></div>

<p>Luego, le asignamos una IP flotante, para ello:</p>

<div class="language-shell highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="o">(</span>os<span class="o">)</span> pavlo@debian:~/OpenStack<span class="o">()</span><span class="nv">$ </span>openstack server add floating ip luffy 172.22.200.100
</pre></td></tr></tbody></table></code></div></div>

<p>Comprobamos que se hayan añadido las interfaces correctamente:</p>

<div class="language-shell highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="o">(</span>os<span class="o">)</span> pavlo@debian:~/OpenStack<span class="o">()</span><span class="nv">$ </span>openstack server list
+--------------------------------------+-------+--------+--------------------------------------------------------------------------+--------------------------+------------+
| ID                                   | Name  | Status | Networks                                                                 | Image                    | Flavor     |
+--------------------------------------+-------+--------+--------------------------------------------------------------------------+--------------------------+------------+
| 91e29177-4a4f-4529-8594-4f867d2dd6bd | luffy | ACTIVE | red-dmz-pablo<span class="o">=</span>172.16.3.142<span class="p">;</span> red-intra-pablo<span class="o">=</span>10.0.200.181, 172.22.200.100 | N/A <span class="o">(</span>booted from volume<span class="o">)</span> | vol.medium |
+--------------------------------------+-------+--------+--------------------------------------------------------------------------+--------------------------+------------+
</pre></td></tr></tbody></table></code></div></div>

<p>Ahora debemos deshabilitar la seguridad de los puertos en las dos interfaces de red, para ello primero obtenemos las IDs de los puertos:</p>

<div class="language-shell highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="o">(</span>os<span class="o">)</span> pavlo@debian:~/OpenStack<span class="o">()</span><span class="nv">$ </span>openstack port list <span class="nt">--server</span> luffy
+--------------------------------------+------+-------------------+-----------------------------------------------------------------------------+--------+
| ID                                   | Name | MAC Address       | Fixed IP Addresses                                                          | Status |
+--------------------------------------+------+-------------------+-----------------------------------------------------------------------------+--------+
| 1505f6e0-7c0f-47d3-b865-1a5420c69246 |      | fa:16:3e:d9:cb:6a | <span class="nv">ip_address</span><span class="o">=</span><span class="s1">'172.16.3.142'</span>, <span class="nv">subnet_id</span><span class="o">=</span><span class="s1">'450496f9-646a-42a4-9a8e-b07b5b3a992d'</span> | ACTIVE |
| 3168307f-1878-4306-a1c3-81256a9dd85a |      | fa:16:3e:ff:1e:6d | <span class="nv">ip_address</span><span class="o">=</span><span class="s1">'10.0.200.181'</span>, <span class="nv">subnet_id</span><span class="o">=</span><span class="s1">'7ef74cd9-63bf-4b2e-8479-69250a4a087b'</span> | ACTIVE |
+--------------------------------------+------+-------------------+-----------------------------------------------------------------------------+--------+
</pre></td></tr></tbody></table></code></div></div>

<p>Y una vez sabemos las IDs ya podemos deshabilitarlos:</p>

<div class="language-shell highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="o">(</span>os<span class="o">)</span> pavlo@debian:~/OpenStack<span class="o">()</span><span class="nv">$ </span>openstack port <span class="nb">set </span>1505f6e0-7c0f-47d3-b865-1a5420c69246 <span class="nt">--no-security-group</span> <span class="nt">--disable-port-security</span>
</pre></td></tr></tbody></table></code></div></div>

<div class="language-shell highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="o">(</span>os<span class="o">)</span> pavlo@debian:~/OpenStack<span class="o">()</span><span class="nv">$ </span>openstack port <span class="nb">set </span>3168307f-1878-4306-a1c3-81256a9dd85a <span class="nt">--no-security-group</span> <span class="nt">--disable-port-security</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Antes de aceder al router (luffy) y realizar el SNAT voy a añadir en el <code class="language-plaintext highlighter-rouge">~/.ssh/config</code> la máquina para poder conectarme de forma más sencilla:</p>

<div class="language-shell highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>Host luffy
  HostName 172.22.200.100
  User pablo
  ForwardAgent <span class="nb">yes</span>
</pre></td></tr></tbody></table></code></div></div>

<p>De forma que ya puedo acceder a la instancia:</p>

<div class="language-shell highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="o">(</span>os<span class="o">)</span> pavlo@debian:~/OpenStack<span class="o">()</span><span class="nv">$ </span>ssh luffy 
Linux luffy 6.1.0-28-amd64 <span class="c">#1 SMP PREEMPT_DYNAMIC Debian 6.1.119-1 (2024-11-22) x86_64</span>

The programs included with the Debian GNU/Linux system are free software<span class="p">;</span>
the exact distribution terms <span class="k">for </span>each program are described <span class="k">in </span>the
individual files <span class="k">in</span> /usr/share/doc/<span class="k">*</span>/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Wed Dec 11 22:48:14 2024 from 172.29.0.34
pablo@luffy:~<span class="err">$</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Una vez accedido a luffy habilitamos el bit de forwarding en el fichero <code class="language-plaintext highlighter-rouge">/etc/sysctl.conf</code>, en donde descomentamos la siguiente línea:</p>

<div class="language-shell highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>net.ipv4.ip_forward<span class="o">=</span>1
</pre></td></tr></tbody></table></code></div></div>

<p>Aplicamos los cambios:</p>
<div class="language-shell highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>pablo@luffy:~<span class="nv">$ </span><span class="nb">sudo </span>sysctl <span class="nt">-p</span>
net.ipv4.ip_forward <span class="o">=</span> 1
</pre></td></tr></tbody></table></code></div></div>

<p>Ahora debemos configurar la reglas SNAT con <code class="language-plaintext highlighter-rouge">iptables</code>, pero antes miramos las direcciones IP de las interfaces:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="rouge-code"><pre>pablo@luffy:~<span class="nv">$ </span>ip a
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    <span class="nb">link</span>/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host noprefixroute 
       valid_lft forever preferred_lft forever
2: ens3: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1442 qdisc fq_codel state UP group default qlen 1000
    <span class="nb">link</span>/ether fa:16:3e:8c:07:52 brd ff:ff:ff:ff:ff:ff
    altname enp0s3
    inet 10.0.200.231/24 metric 100 brd 10.0.200.255 scope global dynamic ens3
       valid_lft 42718sec preferred_lft 42718sec
    inet6 fe80::f816:3eff:fe8c:752/64 scope <span class="nb">link 
       </span>valid_lft forever preferred_lft forever
3: ens4: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1442 qdisc fq_codel state UP group default qlen 1000
    <span class="nb">link</span>/ether fa:16:3e:67:5a:49 brd ff:ff:ff:ff:ff:ff
    altname enp0s4
    inet 172.16.0.16/16 brd 172.16.255.255 scope global ens4
       valid_lft forever preferred_lft forever
    inet6 fe80::f816:3eff:fe67:5a49/64 scope <span class="nb">link 
       </span>valid_lft forever preferred_lft forever
</pre></td></tr></tbody></table></code></div></div>

<p>En base a esta configuración de interfaces de red:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">ens3</code>: Interfaz conectada a la red interna (<code class="language-plaintext highlighter-rouge">red-intra-pablo</code>, 10.0.200.0/24).</li>
  <li><code class="language-plaintext highlighter-rouge">ens4</code>: Interfaz conectada a la red DMZ (<code class="language-plaintext highlighter-rouge">red-dmz-pablo</code>, 172.16.0.0/16).</li>
</ul>

<p>Dado esto, necesitamos configurar las reglas SNAT para que el tráfico desde Red DMZ pueda salir a Internet a través de ens3. Para ello:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>iptables <span class="nt">-t</span> nat <span class="nt">-A</span> POSTROUTING <span class="nt">-o</span> ens3 <span class="nt">-s</span> 172.16.0.0/16 <span class="nt">-j</span> MASQUERADE
</pre></td></tr></tbody></table></code></div></div>

<p>De forma que quede así:</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre>pablo@luffy:~<span class="nv">$ </span><span class="nb">sudo </span>iptables <span class="nt">-t</span> nat <span class="nt">-L</span> <span class="nt">-v</span>
Chain PREROUTING <span class="o">(</span>policy ACCEPT 0 packets, 0 bytes<span class="o">)</span>
 pkts bytes target     prot opt <span class="k">in     </span>out     <span class="nb">source               </span>destination         

Chain INPUT <span class="o">(</span>policy ACCEPT 0 packets, 0 bytes<span class="o">)</span>
 pkts bytes target     prot opt <span class="k">in     </span>out     <span class="nb">source               </span>destination         

Chain OUTPUT <span class="o">(</span>policy ACCEPT 0 packets, 0 bytes<span class="o">)</span>
 pkts bytes target     prot opt <span class="k">in     </span>out     <span class="nb">source               </span>destination         

Chain POSTROUTING <span class="o">(</span>policy ACCEPT 0 packets, 0 bytes<span class="o">)</span>
 pkts bytes target     prot opt <span class="k">in     </span>out     <span class="nb">source               </span>destination         
    0     0 MASQUERADE  all  <span class="nt">--</span>  any    ens3    172.16.0.0/16        anywhere
</pre></td></tr></tbody></table></code></div></div>

<p>Para hacer las reglas persistentes instalamos el siguiente paquete:</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>apt <span class="nb">install </span>iptables-persistent
</pre></td></tr></tbody></table></code></div></div>

<p>En la misma instalación si detecta reglas existentes las guarda automáticamente, aunque si añadimos otras reglas debemos hacerlo manualmente.</p>

<p>Con esto, ya habríamos terminado la instalación y configuración al completo del router luffy.</p>

<p><strong>maquina2 (zoro)</strong></p>

<ul>
  <li>
    <p>Crea un volumen de 15Gb con la imagen <code class="language-plaintext highlighter-rouge">Rocky Linux 9</code>.</p>
  </li>
  <li>
    <p>Crea la instancia a partir de este volumen. Elige el sabor <code class="language-plaintext highlighter-rouge">vol.medium</code>. Y configúrala con <code class="language-plaintext highlighter-rouge">cloud-init</code> como se ha indicado anteriormente.</p>
  </li>
  <li>
    <p>En un primer momento, para que la instancia se configure mediante cloud-init conecta esta instancia a un red con DHCP.</p>
  </li>
  <li>
    <p>Posteriormente, desconecta la interfaz de red de esa red y conéctala a la red <strong>Red DMZ</strong> a la dirección <code class="language-plaintext highlighter-rouge">172.16.0.200</code>.</p>
  </li>
  <li>
    <p>Recuerda, que esa configuración no se hará de forma automática por lo que deberas, de forma manual, configurar la red en esta máquina. recuerda que Rocky Linux tiene instalado por defecto NetwokManager.</p>
  </li>
  <li>
    <p>Deshabilita la seguridad de los puertos en la interfaz de red para que funcione de manera adecuada el NAT.</p>
  </li>
  <li>
    <p>Comprueba que tiene acceso a internet.</p>
  </li>
</ul>

<p>Empezamos creando el volumen a partir de la imagen:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td><td class="rouge-code"><pre><span class="o">(</span>os<span class="o">)</span> pavlo@debian:~/OpenStack<span class="o">()</span><span class="nv">$ </span>openstack volume create <span class="nt">--size</span> 15 <span class="nt">--image</span> <span class="s2">"Rocky Linux 9"</span> volumen-zoro
+---------------------+------------------------------------------------------------------+
| Field               | Value                                                            |
+---------------------+------------------------------------------------------------------+
| attachments         | <span class="o">[]</span>                                                               |
| availability_zone   | nova                                                             |
| bootable            | <span class="nb">false</span>                                                            |
| consistencygroup_id | None                                                             |
| created_at          | 2024-12-12T07:44:39.479661                                       |
| description         | None                                                             |
| encrypted           | False                                                            |
| <span class="nb">id</span>                  | 786b9400-013c-4bf3-9986-1896891628bf                             |
| multiattach         | False                                                            |
| name                | volumen-zoro                                                     |
| properties          |                                                                  |
| replication_status  | None                                                             |
| size                | 15                                                               |
| snapshot_id         | None                                                             |
| source_volid        | None                                                             |
| status              | creating                                                         |
| <span class="nb">type</span>                | lvmdriver-1                                                      |
| updated_at          | None                                                             |
| user_id             | a74499e28f7622936621adb74c2b02fe4a18a1f6964a32bdbb23af09b776065f |
+---------------------+------------------------------------------------------------------+
</pre></td></tr></tbody></table></code></div></div>

<p>Seguidamente creamos la instancia a partir del volumen, conectándola en un principio a una red con DHCP como <code class="language-plaintext highlighter-rouge">red-intra-pablo</code>.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="o">(</span>os<span class="o">)</span> pavlo@debian:~/OpenStack<span class="o">()</span><span class="nv">$ </span>openstack server create zoro <span class="se">\</span>
    <span class="nt">--flavor</span> vol.medium <span class="se">\</span>
    <span class="nt">--volume</span> volumen-zoro <span class="se">\</span>
    <span class="nt">--network</span> red-intra-pablo <span class="se">\</span>
    <span class="nt">--user-data</span> cloud-init-zoro.yaml <span class="se">\</span>
    <span class="nt">--security-group</span> default
</pre></td></tr></tbody></table></code></div></div>

<p>Comprobamos que se haya creado correctamente:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="o">(</span>os<span class="o">)</span> pavlo@debian:~/OpenStack<span class="o">()</span><span class="nv">$ </span>openstack server list
+--------------------------------------+-------+--------+-------------------------------------------------------------------------+--------------------------+------------+
| ID                                   | Name  | Status | Networks                                                                | Image                    | Flavor     |
+--------------------------------------+-------+--------+-------------------------------------------------------------------------+--------------------------+------------+
| 82692c6d-9d36-4bdd-86b6-46e90bea1892 | zoro  | ACTIVE | red-intra-pablo<span class="o">=</span>10.0.200.132                                            | N/A <span class="o">(</span>booted from volume<span class="o">)</span> | vol.medium |
| 9c9e8c12-7712-404e-aa3b-2e2bf566ca0c | luffy | ACTIVE | red-dmz-pablo<span class="o">=</span>172.16.0.16<span class="p">;</span> red-intra-pablo<span class="o">=</span>10.0.200.231, 172.22.200.100 | N/A <span class="o">(</span>booted from volume<span class="o">)</span> | vol.medium |
+--------------------------------------+-------+--------+-------------------------------------------------------------------------+--------------------------+------------+
</pre></td></tr></tbody></table></code></div></div>

<p>Ya que se ha creado la instancia y el cloud-init se ha configurado correctamente, añadimos en el fichero <code class="language-plaintext highlighter-rouge">~/.ssh/config</code> la nueva configuración <strong>temporal</strong>:</p>
<div class="language-shell highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>Host luffy
  HostName 172.22.200.100
  User pablo
  ForwardAgent <span class="nb">yes

</span>Host zoro
  HostName 10.0.200.244
  User pablo
  ForwardAgent <span class="nb">yes
  </span>ProxyJump luffy
</pre></td></tr></tbody></table></code></div></div>

<p>Además, añadimos la nueva interfaz que estará conectada a la <strong>Red DMZ</strong> con la dirección <code class="language-plaintext highlighter-rouge">172.16.0.200</code>, la que posteriormente vamos a configurar manualmente:</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="o">(</span>os<span class="o">)</span> pavlo@debian:~/OpenStack<span class="o">()</span><span class="nv">$ </span>openstack server add port zoro <span class="se">\</span>
<span class="o">&gt;</span> <span class="si">$(</span>openstack port create <span class="nt">--network</span> red-dmz-pablo <span class="nt">--fixed-ip</span> <span class="nv">subnet</span><span class="o">=</span>red-dmz-pablo-subnet,ip-address<span class="o">=</span>172.16.0.200 puerto-zoro <span class="nt">-f</span> value <span class="nt">-c</span> <span class="nb">id</span><span class="si">)</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Accedemos a la instancia:</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="o">(</span>os<span class="o">)</span> pavlo@debian:~/OpenStack<span class="o">()</span><span class="nv">$ </span>ssh zoro 
The authenticity of host <span class="s1">'10.0.200.244 (&lt;no hostip for proxy command&gt;)'</span> can<span class="s1">'t be established.
ED25519 key fingerprint is SHA256:JrbuXBRRZ4JoLGdRCCiKNThDEKWqINQtX2NVLKP7Gvo.
This host key is known by the following other names/addresses:
    ~/.ssh/known_hosts:421: [hashed name]
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '</span>10.0.200.244<span class="s1">' (ED25519) to the list of known hosts.
Last login: Thu Dec 12 07:52:34 2024 from 10.0.200.231
</span></pre></td></tr></tbody></table></code></div></div>

<p>Y hacemos algunas comprobaciones:</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="rouge-code"><pre><span class="o">[</span>pablo@zoro ~]<span class="nv">$ </span><span class="nb">hostname</span> <span class="nt">-f</span>
zoro.pablo.gonzalonazareno.org
<span class="o">[</span>pablo@zoro ~]<span class="nv">$ </span>ip a
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    <span class="nb">link</span>/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever
2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1442 qdisc fq_codel state UP group default qlen 1000
    <span class="nb">link</span>/ether fa:16:3e:78:8b:9e brd ff:ff:ff:ff:ff:ff
    altname enp0s3
    altname ens3
3: eth1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1442 qdisc fq_codel state UP group default qlen 1000
    <span class="nb">link</span>/ether fa:16:3e:87:ca:cd brd ff:ff:ff:ff:ff:ff
    altname enp0s7
    altname ens7
    inet 10.0.200.244/24 brd 10.0.200.255 scope global dynamic noprefixroute eth1
       valid_lft 43120sec preferred_lft 43120sec
    inet6 fe80::7f34:f482:b58c:edcc/64 scope <span class="nb">link </span>noprefixroute 
       valid_lft forever preferred_lft forever
</pre></td></tr></tbody></table></code></div></div>

<p>Como vemos la interfaz <code class="language-plaintext highlighter-rouge">eth0</code> está sin direccionamiento, por lo que vamos a añadir la IP para luego poder eliminar la <code class="language-plaintext highlighter-rouge">red-intra-pablo</code>.</p>

<p>Para ello, creamos el fichero <code class="language-plaintext highlighter-rouge">/etc/NetworkManager/system-connections/dmz.nmconnection</code> con la siguiente configuración:</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="o">[</span>connection]
<span class="nb">id</span><span class="o">=</span>dmz
<span class="nb">type</span><span class="o">=</span>ethernet
interface-name<span class="o">=</span>eth0

<span class="o">[</span>ipv4]
<span class="nv">method</span><span class="o">=</span>manual
<span class="nv">addresses</span><span class="o">=</span>172.16.0.200/16
<span class="nv">gateway</span><span class="o">=</span>172.16.0.16
<span class="nv">dns</span><span class="o">=</span>8.8.8.8<span class="p">;</span>1.1.1.1

<span class="o">[</span>ipv6]
<span class="nv">method</span><span class="o">=</span>ignore
</pre></td></tr></tbody></table></code></div></div>

<p>Seguidamente reiniciamos los servicios:</p>
<div class="language-shell highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="o">[</span>pablo@zoro ~]<span class="nv">$ </span><span class="nb">sudo </span>nmcli connection reload
<span class="o">[</span>pablo@zoro ~]<span class="nv">$ </span><span class="nb">sudo </span>systemctl restart NetworkManager
<span class="o">[</span>pablo@zoro ~]<span class="nv">$ </span><span class="nb">sudo </span>nmcli connection up dmz
Connection successfully activated <span class="o">(</span>D-Bus active path: /org/freedesktop/NetworkManager/ActiveConnection/4<span class="o">)</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Y ya tenemos dirección IP:</p>
<div class="language-shell highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="rouge-code"><pre><span class="o">[</span>pablo@zoro ~]<span class="nv">$ </span>ip a
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    <span class="nb">link</span>/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever
2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1442 qdisc fq_codel state UP group default qlen 1000
    <span class="nb">link</span>/ether fa:16:3e:78:8b:9e brd ff:ff:ff:ff:ff:ff
    altname enp0s3
    altname ens3
    inet 172.16.0.200/16 brd 172.16.255.255 scope global noprefixroute eth0
       valid_lft forever preferred_lft forever
    inet6 fe80::f816:3eff:fe78:8b9e/64 scope <span class="nb">link 
       </span>valid_lft forever preferred_lft forever
3: eth1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1442 qdisc fq_codel state UP group default qlen 1000
    <span class="nb">link</span>/ether fa:16:3e:87:ca:cd brd ff:ff:ff:ff:ff:ff
    altname enp0s7
    altname ens7
    inet 10.0.200.244/24 brd 10.0.200.255 scope global dynamic noprefixroute eth1
       valid_lft 43193sec preferred_lft 43193sec
    inet6 fe80::7f34:f482:b58c:edcc/64 scope <span class="nb">link </span>noprefixroute 
       valid_lft forever preferred_lft forever
</pre></td></tr></tbody></table></code></div></div>

<p>Ahora, nos salimos de la instancia y revocamos la <code class="language-plaintext highlighter-rouge">red-intra-pablo</code>:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>pavlo@debian:~/OpenStack<span class="o">()</span><span class="nv">$ </span>openstack server remove network zoro red-intra-pablo
</pre></td></tr></tbody></table></code></div></div>

<p>Más tarde, modificamos el fichero <code class="language-plaintext highlighter-rouge">~/.ssh/config</code> para que acceda con la nueva IP:</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>Host luffy
  HostName 172.22.200.100
  User pablo
  ForwardAgent <span class="nb">yes

</span>Host zoro
  HostName 172.16.0.200
  User pablo
  ForwardAgent <span class="nb">yes
  </span>ProxyJump luffy
</pre></td></tr></tbody></table></code></div></div>

<p>Y ya nos dejaría acceder:</p>
<div class="language-shell highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>pavlo@debian:~/OpenStack<span class="o">()</span><span class="nv">$ </span>ssh zoro 
The authenticity of host <span class="s1">'172.16.0.200 (&lt;no hostip for proxy command&gt;)'</span> can<span class="s1">'t be established.
ED25519 key fingerprint is SHA256:JrbuXBRRZ4JoLGdRCCiKNThDEKWqINQtX2NVLKP7Gvo.
This host key is known by the following other names/addresses:
    ~/.ssh/known_hosts:421: [hashed name]
    ~/.ssh/known_hosts:424: [hashed name]
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '</span>172.16.0.200<span class="s1">' (ED25519) to the list of known hosts.
Last login: Thu Dec 12 08:30:57 2024 from 10.0.200.231
[pablo@zoro ~]$
</span></pre></td></tr></tbody></table></code></div></div>

<p>Antes de probar la conexión a Internet debemos deshabilitar la seguridad de los puertos para que el NAT funcione correctamente:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>pavlo@debian:~/OpenStack<span class="o">()</span><span class="nv">$ </span>openstack port list <span class="nt">--server</span> zoro
+--------------------------------------+-------------+-------------------+-----------------------------------------------------------------------------+--------+
| ID                                   | Name        | MAC Address       | Fixed IP Addresses                                                          | Status |
+--------------------------------------+-------------+-------------------+-----------------------------------------------------------------------------+--------+
| 3dd6bcc3-0c30-4f37-ae10-3d70767efff1 | puerto-zoro | fa:16:3e:78:8b:9e | <span class="nv">ip_address</span><span class="o">=</span><span class="s1">'172.16.0.200'</span>, <span class="nv">subnet_id</span><span class="o">=</span><span class="s1">'450496f9-646a-42a4-9a8e-b07b5b3a992d'</span> | ACTIVE |
+--------------------------------------+-------------+-------------------+-----------------------------------------------------------------------------+--------+
</pre></td></tr></tbody></table></code></div></div>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>pavlo@debian:~/OpenStack<span class="o">()</span><span class="nv">$ </span>openstack port <span class="nb">set </span>3dd6bcc3-0c30-4f37-ae10-3d70767efff1 <span class="nt">--no-security-group</span> <span class="nt">--disable-port-security</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Pudiendo de esta forma acceder a Internet:</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="o">[</span>pablo@zoro ~]<span class="nv">$ </span>ping <span class="nt">-c</span> 4 8.8.8.8
PING 8.8.8.8 <span class="o">(</span>8.8.8.8<span class="o">)</span> 56<span class="o">(</span>84<span class="o">)</span> bytes of data.
64 bytes from 8.8.8.8: <span class="nv">icmp_seq</span><span class="o">=</span>1 <span class="nv">ttl</span><span class="o">=</span>103 <span class="nb">time</span><span class="o">=</span>18.0 ms
64 bytes from 8.8.8.8: <span class="nv">icmp_seq</span><span class="o">=</span>2 <span class="nv">ttl</span><span class="o">=</span>103 <span class="nb">time</span><span class="o">=</span>17.8 ms
64 bytes from 8.8.8.8: <span class="nv">icmp_seq</span><span class="o">=</span>3 <span class="nv">ttl</span><span class="o">=</span>103 <span class="nb">time</span><span class="o">=</span>17.6 ms
64 bytes from 8.8.8.8: <span class="nv">icmp_seq</span><span class="o">=</span>4 <span class="nv">ttl</span><span class="o">=</span>103 <span class="nb">time</span><span class="o">=</span>17.1 ms

<span class="nt">---</span> 8.8.8.8 ping statistics <span class="nt">---</span>
4 packets transmitted, 4 received, 0% packet loss, <span class="nb">time </span>3005ms
rtt min/avg/max/mdev <span class="o">=</span> 17.086/17.607/17.958/0.325 ms
</pre></td></tr></tbody></table></code></div></div>

<p>Ya habríamos terminado la primera parte del escenario de OpenStack, quedando la topología de la siguiente forma:
<a href="/assets/img/posts/openstack/proyecto2.png" class="popup img-link  shimmer"><img src="/assets/img/posts/openstack/proyecto2.png" alt="image3" loading="lazy"></a></p>

<p>Si queremos hacer algunas comprobaciones como por ejemplo acceder a los FQDN del otro, tendremos que configurar los <code class="language-plaintext highlighter-rouge">/etc/hosts</code>:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>pablo@luffy:~<span class="nv">$ </span><span class="nb">cat</span> /etc/hosts
127.0.0.1	localhost
::1		localhost ip6-localhost ip6-loopback
ff02::1		ip6-allnodes
ff02::2		ip6-allrouters

172.16.0.16 luffy.pablo.gonzalonazareno.org luffy
172.16.0.200 zoro.pablo.gonzalonazareno.org zoro
</pre></td></tr></tbody></table></code></div></div>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="o">[</span>pablo@zoro ~]<span class="nv">$ </span><span class="nb">cat</span> /etc/hosts
127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4
::1         localhost localhost.localdomain localhost6 localhost6.localdomain6

172.16.0.16 luffy.pablo.gonzalonazareno.org luffy
172.16.0.200 zoro.pablo.gonzalonazareno.org zoro
</pre></td></tr></tbody></table></code></div></div>

<p>De forma que tenemos conectividad entre ambos:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>pablo@luffy:~<span class="nv">$ </span>ping <span class="nt">-c</span> 2 zoro.pablo.gonzalonazareno.org 
PING zoro.pablo.gonzalonazareno.org <span class="o">(</span>172.16.0.200<span class="o">)</span> 56<span class="o">(</span>84<span class="o">)</span> bytes of data.
64 bytes from zoro.pablo.gonzalonazareno.org <span class="o">(</span>172.16.0.200<span class="o">)</span>: <span class="nv">icmp_seq</span><span class="o">=</span>1 <span class="nv">ttl</span><span class="o">=</span>64 <span class="nb">time</span><span class="o">=</span>2.40 ms
64 bytes from zoro.pablo.gonzalonazareno.org <span class="o">(</span>172.16.0.200<span class="o">)</span>: <span class="nv">icmp_seq</span><span class="o">=</span>2 <span class="nv">ttl</span><span class="o">=</span>64 <span class="nb">time</span><span class="o">=</span>0.510 ms

<span class="nt">---</span> zoro.pablo.gonzalonazareno.org ping statistics <span class="nt">---</span>
2 packets transmitted, 2 received, 0% packet loss, <span class="nb">time </span>1002ms
rtt min/avg/max/mdev <span class="o">=</span> 0.510/1.457/2.404/0.947 ms
</pre></td></tr></tbody></table></code></div></div>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="o">[</span>pablo@zoro ~]<span class="nv">$ </span>ping <span class="nt">-c</span> 2 luffy.pablo.gonzalonazareno.org
PING luffy.pablo.gonzalonazareno.org <span class="o">(</span>172.16.0.16<span class="o">)</span> 56<span class="o">(</span>84<span class="o">)</span> bytes of data.
64 bytes from luffy.pablo.gonzalonazareno.org <span class="o">(</span>172.16.0.16<span class="o">)</span>: <span class="nv">icmp_seq</span><span class="o">=</span>1 <span class="nv">ttl</span><span class="o">=</span>64 <span class="nb">time</span><span class="o">=</span>0.218 ms
64 bytes from luffy.pablo.gonzalonazareno.org <span class="o">(</span>172.16.0.16<span class="o">)</span>: <span class="nv">icmp_seq</span><span class="o">=</span>2 <span class="nv">ttl</span><span class="o">=</span>64 <span class="nb">time</span><span class="o">=</span>0.441 ms

<span class="nt">---</span> luffy.pablo.gonzalonazareno.org ping statistics <span class="nt">---</span>
2 packets transmitted, 2 received, 0% packet loss, <span class="nb">time </span>1026ms
rtt min/avg/max/mdev <span class="o">=</span> 0.218/0.329/0.441/0.111 ms
</pre></td></tr></tbody></table></code></div></div>

<p>Por último, podemos ver que tenemos conectividad a Internet en ambas máquinas:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>pablo@luffy:~<span class="nv">$ </span>ping <span class="nt">-c</span> 2 google.com
PING google.com <span class="o">(</span>142.250.186.78<span class="o">)</span> 56<span class="o">(</span>84<span class="o">)</span> bytes of data.
64 bytes from fra24s05-in-f14.1e100.net <span class="o">(</span>142.250.186.78<span class="o">)</span>: <span class="nv">icmp_seq</span><span class="o">=</span>1 <span class="nv">ttl</span><span class="o">=</span>101 <span class="nb">time</span><span class="o">=</span>40.0 ms
64 bytes from fra24s05-in-f14.1e100.net <span class="o">(</span>142.250.186.78<span class="o">)</span>: <span class="nv">icmp_seq</span><span class="o">=</span>2 <span class="nv">ttl</span><span class="o">=</span>101 <span class="nb">time</span><span class="o">=</span>38.2 ms

<span class="nt">---</span> google.com ping statistics <span class="nt">---</span>
2 packets transmitted, 2 received, 0% packet loss, <span class="nb">time </span>1002ms
rtt min/avg/max/mdev <span class="o">=</span> 38.183/39.114/40.045/0.931 ms
</pre></td></tr></tbody></table></code></div></div>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="o">[</span>pablo@zoro ~]<span class="nv">$ </span>ping <span class="nt">-c</span> 2 google.com
PING google.com <span class="o">(</span>142.250.186.78<span class="o">)</span> 56<span class="o">(</span>84<span class="o">)</span> bytes of data.
64 bytes from fra24s05-in-f14.1e100.net <span class="o">(</span>142.250.186.78<span class="o">)</span>: <span class="nv">icmp_seq</span><span class="o">=</span>1 <span class="nv">ttl</span><span class="o">=</span>100 <span class="nb">time</span><span class="o">=</span>40.4 ms
64 bytes from fra24s05-in-f14.1e100.net <span class="o">(</span>142.250.186.78<span class="o">)</span>: <span class="nv">icmp_seq</span><span class="o">=</span>2 <span class="nv">ttl</span><span class="o">=</span>100 <span class="nb">time</span><span class="o">=</span>37.1 ms

<span class="nt">---</span> google.com ping statistics <span class="nt">---</span>
2 packets transmitted, 2 received, 0% packet loss, <span class="nb">time </span>1001ms
rtt min/avg/max/mdev <span class="o">=</span> 37.124/38.739/40.355/1.615 ms
</pre></td></tr></tbody></table></code></div></div>

<h2 id="práctica-2--2-escenario-en-openstack"><span class="me-2">Práctica (2 / 2): Escenario en OpenStack</span><a href="#práctica-2--2-escenario-en-openstack" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<h3 id="instalación-de-los-contenedores"><span class="me-2">Instalación de los contenedores</span><a href="#instalación-de-los-contenedores" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>En <strong>máquina1 (luffy)</strong> vamos a crear dos contenedores en un red interna, para ello:</p>

<ul>
  <li>Crea en <strong>máquina1 (luffy)</strong> un linux bridge llamado <code class="language-plaintext highlighter-rouge">br-intra</code> (no lo hagas con <code class="language-plaintext highlighter-rouge">virsh</code> ya que se configura una reglas de cortafuego muy estrictas) y asigna una dirección IP estática <code class="language-plaintext highlighter-rouge">192.168.0.1</code>. Esta será la IP de <strong>máquina1 (luffy)</strong> conectada a este switch virtual y será la puerta de enlace de los contenedores. Tienes que tener en cuenta que la imagen de Debian 12 Bookworm de OpenStack tiene <strong>netplan</strong> para la configuración de las redes, por lo tanto tienes que configurar el bridge usando el fichero de configuración de netplan, para ello te puede ser útil esta <a href="https://fabianlee.org/2022/09/20/kvm-creating-a-bridged-network-with-netplan-on-ubuntu-22-04/">página</a>. No olvides poner la mtu a 1442 al crear el bridge.</li>
</ul>

<p>Para crear el puente tendremos que modificar la configuración del fichero <strong>netplan</strong>, en donde añadiremos las siguientes líneas:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>bridges:
      br-intra:
        addresses: <span class="o">[</span>192.168.0.1/24]
        mtu: 1442
        dhcp4: no
        dhcp6: no
        nameservers:
          addresses: <span class="o">[</span>172.22.0.1]
</pre></td></tr></tbody></table></code></div></div>
<p>Una vez añadido, aplicamos los cambios:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>pablo@luffy:~<span class="nv">$ </span><span class="nb">sudo </span>netplan generate
</pre></td></tr></tbody></table></code></div></div>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>pablo@luffy:~<span class="nv">$ </span><span class="nb">sudo </span>netplan apply
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>Instala LXC y crea dos contenedores con la distribución <strong>Ubuntu 22.04</strong>. Estos contenedores serán la <strong>máquina3 (nami)</strong> y la <strong>máquina4 (sanji)</strong>.</li>
</ul>

<p>Para instalar LXC ejecutamos el siguiente comando:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>pablo@luffy:~<span class="nv">$ </span><span class="nb">sudo </span>apt <span class="nb">install </span>lxc
</pre></td></tr></tbody></table></code></div></div>

<p>Una vez instalado, pasamos a instalar los contenedores:</p>

<ul>
  <li><strong>Nami</strong></li>
</ul>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>pablo@luffy:~<span class="nv">$ </span><span class="nb">sudo </span>lxc-create <span class="nt">-n</span> nami <span class="nt">-t</span> ubuntu <span class="nt">--</span> <span class="nt">-r</span> jammy
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li><strong>Sanji</strong></li>
</ul>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>pablo@luffy:~<span class="nv">$ </span><span class="nb">sudo </span>lxc-create <span class="nt">-n</span> sanji <span class="nt">-t</span> ubuntu <span class="nt">--</span> <span class="nt">-r</span> jammy
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>Configura de forma permanente la regla SNAT para que los contenedores tengan acceso a internet.</li>
</ul>

<p>Para ello es tan simple como añadir la siguiente regla:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>pablo@luffy:~<span class="nv">$ </span><span class="nb">sudo </span>iptables <span class="nt">-t</span> nat <span class="nt">-A</span> POSTROUTING <span class="nt">-s</span> 192.168.0.0/24 <span class="nt">-o</span> ens3 <span class="nt">-j</span> MASQUERADE
</pre></td></tr></tbody></table></code></div></div>

<p>Importante hacer las reglas persistentes para posibles futuros reinicios:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>pablo@luffy:~<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-i</span>
root@luffy:~# iptables-save <span class="o">&gt;</span> /etc/iptables/rules.v4
root@luffy:~# <span class="nb">exit
logout</span>
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>Conecta los contenedores al bridge <code class="language-plaintext highlighter-rouge">br-intra</code> y configúralo de forma estática con las siguientes direcciones: <strong>máquina3 (nami)</strong> la <code class="language-plaintext highlighter-rouge">192.168.0.2</code> y <strong>máquina4 (sanji)</strong> la <code class="language-plaintext highlighter-rouge">192.168.0.3</code>. Su DNS será el <code class="language-plaintext highlighter-rouge">172.22.0.1</code>.</li>
</ul>

<p>Para la configuración de red modificaremos el fichero <code class="language-plaintext highlighter-rouge">/var/lib/lxc/nombrecontenedor/config</code>, quedando de la siguiente forma:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td><td class="rouge-code"><pre>pablo@luffy:~<span class="nv">$ </span><span class="nb">sudo cat</span> /var/lib/lxc/nami/config
<span class="c"># Template used to create this container: /usr/share/lxc/templates/lxc-ubuntu</span>
<span class="c"># Parameters passed to the template: -r jammy</span>
<span class="c"># For additional config options, please look at lxc.container.conf(5)</span>

<span class="c"># Uncomment the following line to support nesting containers:</span>
<span class="c">#lxc.include = /usr/share/lxc/config/nesting.conf</span>
<span class="c"># (Be aware this has security implications)</span>


<span class="c"># Common configuration</span>
lxc.include <span class="o">=</span> /usr/share/lxc/config/ubuntu.common.conf

<span class="c"># Container specific configuration</span>
lxc.apparmor.profile <span class="o">=</span> generated
lxc.apparmor.allow_nesting <span class="o">=</span> 1
lxc.rootfs.path <span class="o">=</span> <span class="nb">dir</span>:/var/lib/lxc/nami/rootfs
lxc.uts.name <span class="o">=</span> nami
lxc.arch <span class="o">=</span> amd64

<span class="c"># Network configuration</span>
lxc.net.0.type <span class="o">=</span> veth
lxc.net.0.hwaddr <span class="o">=</span> 00:16:3e:40:e4:da
lxc.net.0.link <span class="o">=</span> br-intra
lxc.net.0.flags <span class="o">=</span> up
lxc.net.0.ipv4.address <span class="o">=</span> 192.168.0.2/24
lxc.net.0.ipv4.gateway <span class="o">=</span> 192.168.0.1
</pre></td></tr></tbody></table></code></div></div>

<p>Los DNS debemos configurarlos dentro del contenedor, para ello:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>root@nami:/# <span class="nb">rm</span> /etc/resolv.conf
root@nami:/# <span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"nameserver 172.22.0.1</span><span class="se">\n</span><span class="s2">nameserver 8.8.8.8"</span> <span class="o">&gt;</span> /etc/resolv.conf
root@nami:/# <span class="nb">cat</span> /etc/resolv.conf 
nameserver 172.22.0.1
nameserver 8.8.8.8
</pre></td></tr></tbody></table></code></div></div>

<p>En <em>sanji</em> añadimos prácticamente la misma configuración:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="c"># Network configuration</span>
lxc.net.0.type <span class="o">=</span> veth
lxc.net.0.hwaddr <span class="o">=</span> 00:16:3e:c5:5c:70
lxc.net.0.link <span class="o">=</span> br-intra
lxc.net.0.flags <span class="o">=</span> up
lxc.net.0.ipv4.address <span class="o">=</span> 192.168.0.3/24
lxc.net.0.ipv4.gateway <span class="o">=</span> 192.168.0.1
</pre></td></tr></tbody></table></code></div></div>

<p>Antes de acceder tenemos que iniciar los contenedores:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>pablo@luffy:~<span class="nv">$ </span><span class="nb">sudo </span>lxc-start nami
pablo@luffy:~<span class="nv">$ </span><span class="nb">sudo </span>lxc-start sanji
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>Para que la red de OpenStack funcione de forma adecuada las imágenes que usamos tienen configurado la mtu (Unidad máxima de transferencia) a 1442 bytes. Tenemos que adecuar los contenedores a este tamaño de trama. Para ello introduce en la configuración de los contenedores la línea: <code class="language-plaintext highlighter-rouge">lxc.net.0.mtu = 1442</code>.</li>
</ul>

<p>Para ello tendremos que modificar el fichero <strong>config</strong> de ambos contenedores en donde añadimos esta línea:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>lxc.net.0.mtu <span class="o">=</span> 1442
</pre></td></tr></tbody></table></code></div></div>

<p>Para aplicar los cambios apagamos y encendemos el contenedor:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>pablo@luffy:~<span class="nv">$ </span><span class="nb">sudo </span>lxc-stop <span class="nt">-n</span> nami
pablo@luffy:~<span class="nv">$ </span><span class="nb">sudo </span>lxc-start <span class="nt">-n</span> nami
</pre></td></tr></tbody></table></code></div></div>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>pablo@luffy:~<span class="nv">$ </span><span class="nb">sudo </span>lxc-stop <span class="nt">-n</span> sanji
pablo@luffy:~<span class="nv">$ </span><span class="nb">sudo </span>lxc-start <span class="nt">-n</span> sanji
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>Configura los contenedores para que se auto inicien al reiniciar la instancia.</li>
</ul>

<p>Para ello añadimos en el archivo <strong>config</strong> mencionado anteriormente la siguiente línea:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>lxc.start.auto <span class="o">=</span> 1
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>
    <p>Los contenedores tendrán características parecidas a las instancias anteriormente:</p>

    <ul>
      <li>Debes actualizar los paquetes de la distribución instalada.</li>
    </ul>

    <div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>root@nami:/# apt update
</pre></td></tr></tbody></table></code></div>    </div>

    <div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>root@sanji:/# apt update
</pre></td></tr></tbody></table></code></div>    </div>

    <ul>
      <li>El dominio utilizado será del tipo <code class="language-plaintext highlighter-rouge">tunombre.gonzalonazareno.org</code>. Por lo tanto configura de manera adecuada el hostname y el FQDN.</li>
    </ul>

    <p><strong>Nami</strong></p>

    <div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>root@nami:/# <span class="nb">cat</span> /etc/hosts
127.0.0.1   localhost
127.0.1.1   nami.pablo.gonzalonazareno.org nami

<span class="c"># The following lines are desirable for IPv6 capable hosts</span>
::1     ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
</pre></td></tr></tbody></table></code></div>    </div>

    <p>Comprobamos:</p>

    <div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>root@nami:/# <span class="nb">hostname
</span>nami
root@nami:/# <span class="nb">hostname</span> <span class="nt">-f</span>
nami.pablo.gonzalonazareno.org
</pre></td></tr></tbody></table></code></div>    </div>

    <p><strong>Sanji</strong></p>

    <div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>root@sanji:/# <span class="nb">cat</span> /etc/hosts
127.0.0.1   localhost
127.0.1.1   sanji.pablo.gonzalonazareno.org sanji

<span class="c"># The following lines are desirable for IPv6 capable hosts</span>
::1     ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
</pre></td></tr></tbody></table></code></div>    </div>

    <p>Comprobamos:</p>

    <div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>root@sanji:/# <span class="nb">hostname
</span>sanji
root@sanji:/# <span class="nb">hostname</span> <span class="nt">-f</span>
sanji.pablo.gonzalonazareno.org
</pre></td></tr></tbody></table></code></div>    </div>

    <ul>
      <li>
        <p>Para acceder a los contenedores vamos a usar ssh.</p>
      </li>
      <li>
        <p>Crea dos usuarios:</p>

        <ul>
          <li>Un usuario sin privilegios. Se puede llamar como quieras (el nombre de usuario que usaste en las instancias) y accederás a los contenedores usando tu clave ssh privada.</li>
        </ul>

        <div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>root@nami:/# useradd <span class="nt">-m</span> <span class="nt">-s</span> /bin/bash pablo
</pre></td></tr></tbody></table></code></div>        </div>

        <div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>root@sanji:/# useradd <span class="nt">-m</span> <span class="nt">-s</span> /bin/bash pablo
</pre></td></tr></tbody></table></code></div>        </div>

        <p>Luego, en ambos contenedores añadimos nuestra clave pública dentro del <code class="language-plaintext highlighter-rouge">authorized_keys</code>:</p>

        <div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>root@sanji:/# su - pablo
pablo@sanji:~<span class="nv">$ </span><span class="nb">mkdir</span> <span class="nt">-p</span> /home/pablo/.ssh
pablo@sanji:~<span class="nv">$ </span><span class="nb">echo </span>ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQClFcnIhYd1oaEpvGi/f4psQc4+DaAZvSNIxVRRJHtRoJui8wbJybi3Om8yTOflgEcmBaUrJLkfmzmWqVq1j6MpESq72p7J2hdq2lXnvzdt3huYv5evFwyd0p/r72RfpVZzr3ILi/BS//SJqfVKlDEVbZRaOE5MU2XuElmFFY4EO7NiiZAkbatVqUOT8H/nrfXcad0mjZVxroVqHhsHV+06rxiB0xifG0xZv204Qj4zRura8uqZlEVAAwU+NO/SIGdRwpLY7n7xbQGe1DbjHgPUeVPjJX6HpMK41a43eGj4XYdYtZBLugaU8Mq1y6Kl3tE6cvYkQ9WFTYTLLNy3bvNRZpP2p6qAy5qn03ZLFICiXBNXPmrl5+KVrKaSipNaPHkmInvczbYJjXpfyVBsfEabt+0Y1629M+eEKkkl+iZmVr2ySDSS1gHxMC7zlJRaUhG27o26agpNPYPHH3mVXVjqdGg0ryH0YHZk1V8+Gt1Z9hZ7UYWE1UX8DCgFfecqdX0<span class="o">=</span> pavlo@debian <span class="o">&gt;</span> /home/pablo/.ssh/authorized_keys
pablo@sanji:~<span class="nv">$ </span><span class="nb">chown</span> <span class="nt">-R</span> pablo:pablo /home/pablo/.ssh
pablo@sanji:~<span class="nv">$ </span><span class="nb">chmod </span>700 /home/pablo/.ssh
pablo@sanji:~<span class="nv">$ </span><span class="nb">chmod </span>600 /home/pablo/.ssh/authorized_keys
</pre></td></tr></tbody></table></code></div>        </div>

        <p>Modificamos también el fichero <code class="language-plaintext highlighter-rouge">/etc/sudoers</code> para que no pida contraseña a mi usuario <em>pablo</em>:</p>

        <div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="c"># User privilege specification</span>
root    <span class="nv">ALL</span><span class="o">=(</span>ALL:ALL<span class="o">)</span> ALL
pablo   <span class="nv">ALL</span><span class="o">=(</span>ALL<span class="o">)</span> NOPASSWD:ALL
</pre></td></tr></tbody></table></code></div>        </div>

        <ul>
          <li>Un usuario <code class="language-plaintext highlighter-rouge">profesor</code>, que puede utilizar <code class="language-plaintext highlighter-rouge">sudo</code> sin contraseña. Copia de las claves públicas de todos los profesores en los contenedores para que puedan acceder con el usuario <code class="language-plaintext highlighter-rouge">profesor</code>.</li>
        </ul>

        <p>Añadimos el usuario en ambos contenedores:</p>

        <div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>root@nami:~# useradd <span class="nt">-m</span> <span class="nt">-s</span> /bin/bash profesor
</pre></td></tr></tbody></table></code></div>        </div>

        <div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>root@sanji:~# useradd <span class="nt">-m</span> <span class="nt">-s</span> /bin/bash profesor
</pre></td></tr></tbody></table></code></div>        </div>

        <p>Y repetimos el mismo proceso que anteriormente.</p>
      </li>
    </ul>
  </li>
  <li>
    <p>Cambia la contraseña al usuario <code class="language-plaintext highlighter-rouge">root</code>.</p>
  </li>
</ul>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>root@nami:~# passwd root
New password: 
Retype new password: 
passwd: password updated successfully
</pre></td></tr></tbody></table></code></div></div>

<p>Ya está todo configurado, solo nos quedaría crear los accesos por ssh, para ello en el fichero <code class="language-plaintext highlighter-rouge">~/.ssh/config</code> añadimos lo siguiente:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="rouge-code"><pre>pavlo@debian:~<span class="o">()</span><span class="nv">$ </span><span class="nb">cat</span> .ssh/config 
Host luffy
  HostName 172.22.200.100
  User pablo
  ForwardAgent <span class="nb">yes

</span>Host zoro
  HostName 172.16.0.200
  User pablo
  ForwardAgent <span class="nb">yes
  </span>ProxyJump luffy

Host nami
  HostName 192.168.0.2
  User pablo
  ForwardAgent <span class="nb">yes
  </span>ProxyJump luffy

Host sanji
  HostName 192.168.0.3
  User pablo
  ForwardAgent <span class="nb">yes
  </span>ProxyJump luffy
</pre></td></tr></tbody></table></code></div></div>

<p>De esta forma, desde nuestro host principal podemos acceder a todas las máquinas, incluyendo los contenedores:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="rouge-code"><pre>pavlo@debian:~<span class="o">()</span><span class="nv">$ </span>ssh nami
Welcome to Ubuntu 22.04.5 LTS <span class="o">(</span>GNU/Linux 6.1.0-28-amd64 x86_64<span class="o">)</span>

 <span class="k">*</span> Documentation:  https://help.ubuntu.com
 <span class="k">*</span> Management:     https://landscape.canonical.com
 <span class="k">*</span> Support:        https://ubuntu.com/pro
Last login: Mon Dec 16 10:54:43 2024 from 192.168.0.1
pablo@nami:~<span class="nv">$ </span>
<span class="nb">logout
</span>Connection to 192.168.0.2 closed.
pavlo@debian:~<span class="o">()</span><span class="nv">$ </span>ssh sanji
Welcome to Ubuntu 22.04.5 LTS <span class="o">(</span>GNU/Linux 6.1.0-28-amd64 x86_64<span class="o">)</span>

 <span class="k">*</span> Documentation:  https://help.ubuntu.com
 <span class="k">*</span> Management:     https://landscape.canonical.com
 <span class="k">*</span> Support:        https://ubuntu.com/pro
Last login: Mon Dec 16 10:49:30 2024 from 192.168.0.1
pablo@sanji:~<span class="err">$</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Otras comprobaciones que podemos hacer:</p>

<ol>
  <li>La salida del comando <code class="language-plaintext highlighter-rouge">sudo lxc-ls -f</code>.</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>pablo@luffy:~<span class="nv">$ </span><span class="nb">sudo </span>lxc-ls <span class="nt">-f</span>
NAME  STATE   AUTOSTART GROUPS IPV4        IPV6 UNPRIVILEGED 
nami  RUNNING 0         -      192.168.0.2 -    <span class="nb">false        
</span>sanji RUNNING 1         -      192.168.0.3 -    <span class="nb">false</span>
</pre></td></tr></tbody></table></code></div></div>

<ol>
  <li>Prueba de funcionamiento de que los contenedores tienen acceso a internet accediendo a un nombre de dominio, para comprobar que funciona el DNS.</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre>pavlo@debian:~<span class="o">()</span><span class="nv">$ </span>ssh nami
Welcome to Ubuntu 22.04.5 LTS <span class="o">(</span>GNU/Linux 6.1.0-28-amd64 x86_64<span class="o">)</span>

 <span class="k">*</span> Documentation:  https://help.ubuntu.com
 <span class="k">*</span> Management:     https://landscape.canonical.com
 <span class="k">*</span> Support:        https://ubuntu.com/pro
Last login: Mon Dec 16 10:57:54 2024 from 192.168.0.1
pablo@nami:~<span class="nv">$ </span>ping <span class="nt">-c</span> 2 www.google.es
PING www.google.es <span class="o">(</span>142.250.186.163<span class="o">)</span> 56<span class="o">(</span>84<span class="o">)</span> bytes of data.
64 bytes from fra24s08-in-f3.1e100.net <span class="o">(</span>142.250.186.163<span class="o">)</span>: <span class="nv">icmp_seq</span><span class="o">=</span>1 <span class="nv">ttl</span><span class="o">=</span>100 <span class="nb">time</span><span class="o">=</span>51.8 ms
64 bytes from fra24s08-in-f3.1e100.net <span class="o">(</span>142.250.186.163<span class="o">)</span>: <span class="nv">icmp_seq</span><span class="o">=</span>2 <span class="nv">ttl</span><span class="o">=</span>100 <span class="nb">time</span><span class="o">=</span>38.7 ms

<span class="nt">---</span> www.google.es ping statistics <span class="nt">---</span>
2 packets transmitted, 2 received, 0% packet loss, <span class="nb">time </span>1001ms
rtt min/avg/max/mdev <span class="o">=</span> 38.722/45.277/51.832/6.555 ms
</pre></td></tr></tbody></table></code></div></div>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre>pavlo@debian:~<span class="o">()</span><span class="nv">$ </span>ssh sanji
Welcome to Ubuntu 22.04.5 LTS <span class="o">(</span>GNU/Linux 6.1.0-28-amd64 x86_64<span class="o">)</span>

 <span class="k">*</span> Documentation:  https://help.ubuntu.com
 <span class="k">*</span> Management:     https://landscape.canonical.com
 <span class="k">*</span> Support:        https://ubuntu.com/pro
Last login: Mon Dec 16 10:57:59 2024 from 192.168.0.1
pablo@sanji:~<span class="nv">$ </span>ping <span class="nt">-c</span> 2 www.youtube.com
PING youtube-ui.l.google.com <span class="o">(</span>216.58.206.78<span class="o">)</span> 56<span class="o">(</span>84<span class="o">)</span> bytes of data.
64 bytes from lhr35s11-in-f14.1e100.net <span class="o">(</span>216.58.206.78<span class="o">)</span>: <span class="nv">icmp_seq</span><span class="o">=</span>1 <span class="nv">ttl</span><span class="o">=</span>99 <span class="nb">time</span><span class="o">=</span>43.6 ms
64 bytes from tzfraa-aa-in-f14.1e100.net <span class="o">(</span>216.58.206.78<span class="o">)</span>: <span class="nv">icmp_seq</span><span class="o">=</span>2 <span class="nv">ttl</span><span class="o">=</span>99 <span class="nb">time</span><span class="o">=</span>42.9 ms

<span class="nt">---</span> youtube-ui.l.google.com ping statistics <span class="nt">---</span>
2 packets transmitted, 2 received, 0% packet loss, <span class="nb">time </span>1002ms
rtt min/avg/max/mdev <span class="o">=</span> 42.871/43.247/43.624/0.376 ms
</pre></td></tr></tbody></table></code></div></div>

<p>Finalmente comprueba que todo el escenario está funcionando después de reiniciar la <strong>máquina1 (luffy)</strong>.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="rouge-code"><pre>pablo@luffy:~<span class="nv">$ </span><span class="nb">sudo </span>reboot

Broadcast message from root@luffy on pts/1 <span class="o">(</span>Mon 2024-12-16 11:15:21 UTC<span class="o">)</span>:

The system will reboot now!

pablo@luffy:~<span class="nv">$ </span>Connection to 172.22.200.100 closed by remote host.
Connection to 172.22.200.100 closed.
pavlo@debian:~<span class="o">()</span><span class="nv">$ </span>ssh nami
Welcome to Ubuntu 22.04.5 LTS <span class="o">(</span>GNU/Linux 6.1.0-28-amd64 x86_64<span class="o">)</span>

 <span class="k">*</span> Documentation:  https://help.ubuntu.com
 <span class="k">*</span> Management:     https://landscape.canonical.com
 <span class="k">*</span> Support:        https://ubuntu.com/pro
Last login: Mon Dec 16 11:01:53 2024 from 192.168.0.1
pablo@nami:~<span class="nv">$ </span>
<span class="nb">logout
</span>Connection to 192.168.0.2 closed.
pavlo@debian:~<span class="o">()</span><span class="nv">$ </span>ssh sanji
Welcome to Ubuntu 22.04.5 LTS <span class="o">(</span>GNU/Linux 6.1.0-28-amd64 x86_64<span class="o">)</span>

 <span class="k">*</span> Documentation:  https://help.ubuntu.com
 <span class="k">*</span> Management:     https://landscape.canonical.com
 <span class="k">*</span> Support:        https://ubuntu.com/pro
Last login: Mon Dec 16 11:13:31 2024 from 192.168.0.1
pablo@sanji:~<span class="nv">$ </span>
<span class="nb">logout
</span>Connection to 192.168.0.3 closed.
</pre></td></tr></tbody></table></code></div></div>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/servicios/">Servicios</a>,
          <a href="/categories/cloud/">Cloud</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/cloud/"
            class="post-tag no-text-decoration"
          >Cloud</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=Escenario%20en%20OpenStack%20-%20Blog%20personal&url=%2Fposts%2Fopenstack%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=Escenario%20en%20OpenStack%20-%20Blog%20personal&u=%2Fposts%2Fopenstack%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=%2Fposts%2Fopenstack%2F&text=Escenario%20en%20OpenStack%20-%20Blog%20personal" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/certificado/">Práctica: Certificados digitales. HTTPS</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/systemd/">systemd/sshfs</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/integridad/">Integridad, firmas y autenticación</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/openstack/">Escenario en OpenStack</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/gpg-openssl/">Cifrado asimétrico con gpg y openssl</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/criptograf%C3%ADa/">Criptografía</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/automatizaci%C3%B3n/">Automatización</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/aplicaciones/">Aplicaciones</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/cloud/">Cloud</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/compartici%C3%B3n-de-archivos/">Compartición de archivos</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/instalaci%C3%B3n/">Instalación</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/virtualizaci%C3%B3n/">Virtualización</a>
      
    </div>
  </section>


            </div>

            
              
              



  <section id="toc-wrapper" class="d-none ps-0 pe-4">
    <h2 class="panel-heading ps-3 mb-2">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  
    











            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/instalacion-oracle19c/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>Instalación de Oracle 19c en Debian 12</p>
    </a>
  

  
    <a
      href="/posts/gpg-openssl/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>Cifrado asimétrico con gpg y openssl</p>
    </a>
  
</nav>

            
              
              <!-- The comments switcher -->


            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2025</time>

    
      <a href="https://github.com/PabloMartin19">Pablo Martín Hidalgo</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.1.1"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/criptograf%C3%ADa/">Criptografía</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/automatizaci%C3%B3n/">Automatización</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/aplicaciones/">Aplicaciones</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/cloud/">Cloud</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/compartici%C3%B3n-de-archivos/">Compartición de archivos</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/instalaci%C3%B3n/">Instalación</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/virtualizaci%C3%B3n/">Virtualización</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- JavaScripts -->
    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.29.0/dist/tocbot.min.js"></script>







<script src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  







    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
    noResultsText: '<p class="mt-5">Oops! No results found.</p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
</html>


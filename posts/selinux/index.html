<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="es" >
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="Configuración/activación de SELinux" />
<meta name="author" content="Pablo Martín Hidalgo" />
<meta property="og:locale" content="es" />
<meta name="description" content="En un entorno basado en Rocky Linux con SELinux en modo enforcing, garantizar el correcto funcionamiento de servicios como SSHFS, Samba y NFS requiere una configuración precisa y segura de las políticas de SELinux. Además, habilitamos el inicio de sesión remoto como root y cambiamos el puerto SSH a uno no estándar para mejorar la seguridad. Realizamos pruebas exhaustivas para asegurar que los servicios funcionan sin problemas y que el acceso remoto es seguro y eficiente." />
<meta property="og:description" content="En un entorno basado en Rocky Linux con SELinux en modo enforcing, garantizar el correcto funcionamiento de servicios como SSHFS, Samba y NFS requiere una configuración precisa y segura de las políticas de SELinux. Además, habilitamos el inicio de sesión remoto como root y cambiamos el puerto SSH a uno no estándar para mejorar la seguridad. Realizamos pruebas exhaustivas para asegurar que los servicios funcionan sin problemas y que el acceso remoto es seguro y eficiente." />
<link rel="canonical" href="/posts/selinux/" />
<meta property="og:url" content="/posts/selinux/" />
<meta property="og:site_name" content="Blog personal" />
<meta property="og:image" content="/assets/img/SeLinux-Configuracion-MAC.jpeg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-01-29T20:00:00+01:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="/assets/img/SeLinux-Configuracion-MAC.jpeg" />
<meta property="twitter:title" content="Configuración/activación de SELinux" />
<meta name="twitter:site" content="@Tagarnina10" />
<meta name="twitter:creator" content="@Tagarnina10" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Pablo Martín Hidalgo","url":"https://github.com/PabloMartin19/"},"dateModified":"2025-02-08T13:39:06+01:00","datePublished":"2025-01-29T20:00:00+01:00","description":"En un entorno basado en Rocky Linux con SELinux en modo enforcing, garantizar el correcto funcionamiento de servicios como SSHFS, Samba y NFS requiere una configuración precisa y segura de las políticas de SELinux. Además, habilitamos el inicio de sesión remoto como root y cambiamos el puerto SSH a uno no estándar para mejorar la seguridad. Realizamos pruebas exhaustivas para asegurar que los servicios funcionan sin problemas y que el acceso remoto es seguro y eficiente.","headline":"Configuración/activación de SELinux","image":"/assets/img/SeLinux-Configuracion-MAC.jpeg","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/selinux/"},"url":"/posts/selinux/"}</script>
<!-- End Jekyll SEO tag -->


  <title>Configuración/activación de SELinux | Blog personal
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Blog personal">
<meta name="application-name" content="Blog personal">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.6.0/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.29.0/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- JavaScript -->

  
    <!-- Switch the mode between dark and light. -->

<script type="text/javascript">
  class ModeToggle {
    static get MODE_KEY() {
      return 'mode';
    }
    static get MODE_ATTR() {
      return 'data-mode';
    }
    static get DARK_MODE() {
      return 'dark';
    }
    static get LIGHT_MODE() {
      return 'light';
    }
    static get ID() {
      return 'mode-toggle';
    }

    constructor() {
      let self = this;this.sysDarkPrefers.addEventListener('change', () => {
        if (self.hasMode) {
          self.clearMode();
        }
        self.notify();
      });

      if (!this.hasMode) {
        return;
      }

      if (this.isDarkMode) {
        this.setDark();
      } else {
        this.setLight();
      }
    }

    get sysDarkPrefers() {
      return window.matchMedia('(prefers-color-scheme: dark)');
    }

    get isPreferDark() {
      return this.sysDarkPrefers.matches;
    }

    get isDarkMode() {
      return this.mode === ModeToggle.DARK_MODE;
    }

    get hasMode() {
      return this.mode != null;
    }

    get mode() {
      return sessionStorage.getItem(ModeToggle.MODE_KEY);
    }get modeStatus() {
      if (this.hasMode) {
        return this.mode;
      } else {
        return this.isPreferDark ? ModeToggle.DARK_MODE : ModeToggle.LIGHT_MODE;
      }
    }

    setDark() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }

    setLight() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }

    clearMode() {
      document.documentElement.removeAttribute(ModeToggle.MODE_ATTR);
      sessionStorage.removeItem(ModeToggle.MODE_KEY);
    }notify() {
      window.postMessage(
        {
          direction: ModeToggle.ID,
          message: this.modeStatus
        },
        '*'
      );
    }

    flipMode() {
      if (this.hasMode) {
        this.clearMode();
      } else {
        if (this.isPreferDark) {
          this.setLight();
        } else {
          this.setDark();
        }
      }

      this.notify();
    }
  }

  const modeToggle = new ModeToggle();
</script>

  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/avatar.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">Blog personal</a>
    <p class="site-subtitle fst-italic mb-0">Los mejores programas son aquellos que funcionan.</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
      

      
        <a
          href="https://github.com/PabloMartin19"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://twitter.com/Tagarnina10"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fa-brands fa-x-twitter"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['pmartinhidalgo19','gmail.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="https://www.linkedin.com/in/pablo-mart%C3%ADn-hidalgo/"
          aria-label="linkedin"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-linkedin"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>Configuración/activación de SELinux</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  




<!-- return -->




<article class="px-1">
  <header>
    <h1 data-toc-skip>Configuración/activación de SELinux</h1>
    
      <p class="post-desc fw-light mb-4">En un entorno basado en Rocky Linux con SELinux en modo enforcing, garantizar el correcto funcionamiento de servicios como SSHFS, Samba y NFS requiere una configuración precisa y segura de las políticas de SELinux. Además, habilitamos el inicio de sesión remoto como root y cambiamos el puerto SSH a uno no estándar para mejorar la seguridad. Realizamos pruebas exhaustivas para asegurar que los servicios funcionan sin problemas y que el acceso remoto es seguro y eficiente.</p>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1738177200"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Jan 29, 2025
</time>

      </span>

      <!-- lastmod date -->
      
        <span>
          Updated
          <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1739018346"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Feb  8, 2025
</time>

        </span>
      

      
        
        
        

        

        <div class="mt-3 mb-3">
          <a href="/assets/img/SeLinux-Configuracion-MAC.jpeg" class="popup img-link preview-img shimmer"><img src="/assets/img/SeLinux-Configuracion-MAC.jpeg"  alt="Preview Image" width="1200" height="630"  loading="lazy"></a></div>
      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              
                <a href="https://github.com/PabloMartin19/">Pablo Martín Hidalgo</a>
                
              
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="2533 words"
>
  <em>14 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  <div class="content">
    <p>Hoy nos adentramos en la configuración de un servidor basado en Rocky Linux con SELinux activado en modo enforcing. Nuestro objetivo es asegurar que los servicios <strong>SSHFS</strong>, <strong>Samba</strong> y <strong>NFS</strong> funcionen correctamente bajo una configuración estricta y segura de SELinux. Además, habilitaremos el inicio de sesión remoto como root y cambiaremos el puerto de acceso SSH por uno no habitual.</p>

<h2 id="preparación-del-entorno"><span class="me-2">Preparación del entorno</span><a href="#preparación-del-entorno" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Antes de empezar, verificamos el estado de SELinux para asegurarnos de que está activado y en modo <strong>enforcing</strong>:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span>sestatus 
SELinux status:                 enabled
SELinuxfs mount:                /sys/fs/selinux
SELinux root directory:         /etc/selinux
Loaded policy name:             targeted
Current mode:                   enforcing
Mode from config file:          enforcing
Policy MLS status:              enabled
Policy deny_unknown status:     allowed
Memory protection checking:     actual <span class="o">(</span>secure<span class="o">)</span>
Max kernel policy version:      33
</pre></td></tr></tbody></table></code></div></div>

<p>Perfecto, SELinux está activado y en modo <strong>enforcing</strong>. Ahora actualizamos el sistema e instalamos los paquetes necesarios:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo </span>dnf update <span class="nt">-y</span>
<span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo </span>dnf <span class="nb">install </span>samba samba-common samba-client nfs-utils <span class="nt">-y</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Para la instalación de <code class="language-plaintext highlighter-rouge">sshfs</code> debemos disponer del repositorio EPEL, por lo que primero hay que instalarlo:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo </span>dnf <span class="nb">install</span> <span class="nt">-y</span> epel-release
</pre></td></tr></tbody></table></code></div></div>

<p>Una vez habilitado el repositorio, ya podemos instalar <code class="language-plaintext highlighter-rouge">SSHFS</code> con:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo </span>dnf <span class="nb">install</span> <span class="nt">-y</span> fuse fuse-sshfs
</pre></td></tr></tbody></table></code></div></div>

<p>IMPORTANTE: en OpenStack debemos asignar a las máquina un sabor <code class="language-plaintext highlighter-rouge">m1.medium</code> como mínimo, pues de lo contrario la máquina se quedará pillada y tendremos que destruirla.</p>

<h2 id="sshfs"><span class="me-2">SSHFS</span><a href="#sshfs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<h3 id="configuración-del-servidor-ssh"><span class="me-2">Configuración del servidor SSH</span><a href="#configuración-del-servidor-ssh" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Primero, necesitamos asegurarnos de que nuestro servidor SSH esté configurado correctamente para permitir conexiones desde el cliente. En nuestro caso, decidimos cambiar el puerto predeterminado de SSH (22) al puerto 2222 por razones de seguridad. Para ello, editamos el archivo de configuración de SSH en <code class="language-plaintext highlighter-rouge">/etc/ssh/sshd_config</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>Port 2222
PermitRootLogin yes
PubkeyAuthentication yes
</pre></td></tr></tbody></table></code></div></div>

<p>Estas líneas indican que:</p>

<ul>
  <li>
    <p>SSH escuchará en el puerto 2222.</p>
  </li>
  <li>
    <p>Permitiremos el inicio de sesión como root.</p>
  </li>
  <li>
    <p>Habilitaremos la autenticación mediante claves públicas.</p>
  </li>
</ul>

<p>Después de realizar estos cambios, reiniciamos el servicio SSH para que los cambios surtan efecto:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo </span>systemctl restart sshd
<span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo </span>systemctl status sshd
● sshd.service - OpenSSH server daemon
     Loaded: loaded <span class="o">(</span>/usr/lib/systemd/system/sshd.service<span class="p">;</span> enabled<span class="p">;</span> preset: enabled<span class="o">)</span>
     Active: active <span class="o">(</span>running<span class="o">)</span> since Sat 2025-02-08 12:01:35 UTC<span class="p">;</span> 5min ago
       Docs: man:sshd<span class="o">(</span>8<span class="o">)</span>
             man:sshd_config<span class="o">(</span>5<span class="o">)</span>
   Main PID: 14817 <span class="o">(</span>sshd<span class="o">)</span>
      Tasks: 1 <span class="o">(</span>limit: 10890<span class="o">)</span>
     Memory: 3.4M
        CPU: 151ms
     CGroup: /system.slice/sshd.service
             └─14817 <span class="s2">"sshd: /usr/sbin/sshd -D [listener] 0 of 10-100 startups"</span>
</pre></td></tr></tbody></table></code></div></div>

<p>También necesitamos asegurarnos de que el firewall permita conexiones en el puerto 2222:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo </span>firewall-cmd <span class="nt">--permanent</span> <span class="nt">--add-port</span><span class="o">=</span>2222/tcp
success
<span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo </span>firewall-cmd <span class="nt">--reload</span>
success
</pre></td></tr></tbody></table></code></div></div>

<p>Además, utilizamos <code class="language-plaintext highlighter-rouge">semanage</code> para agregar el puerto 2222 al contexto de seguridad de SSH:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo </span>semanage port <span class="nt">-a</span> <span class="nt">-t</span> ssh_port_t <span class="nt">-p</span> tcp 2222
<span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo </span>semanage port <span class="nt">-l</span> | <span class="nb">grep </span>ssh
ssh_port_t                     tcp      2222, 22
</pre></td></tr></tbody></table></code></div></div>

<h3 id="configuración-de-selinux-para-sshfs"><span class="me-2">Configuración de SELinux para SSHFS</span><a href="#configuración-de-selinux-para-sshfs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>En nuestro servidor, SELinux estaba habilitado, por lo que necesitamos ajustar algunas políticas para permitir el uso de SSHFS. Utilizamos los siguientes comandos para habilitar las opciones necesarias:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo </span>setsebool <span class="nt">-P</span> use_fusefs_home_dirs on
<span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo </span>setsebool <span class="nt">-P</span> virt_use_fusefs on
</pre></td></tr></tbody></table></code></div></div>

<p>Para verificar que los cambios se aplicaron correctamente, ejecutamos:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span>getsebool <span class="nt">-a</span> | <span class="nb">grep </span>fuse
ftpd_use_fusefs <span class="nt">--</span><span class="o">&gt;</span> off
glance_use_fusefs <span class="nt">--</span><span class="o">&gt;</span> off
httpd_use_fusefs <span class="nt">--</span><span class="o">&gt;</span> off
logrotate_use_fusefs <span class="nt">--</span><span class="o">&gt;</span> off
mailman_use_fusefs <span class="nt">--</span><span class="o">&gt;</span> off
rpcd_use_fusefs <span class="nt">--</span><span class="o">&gt;</span> off
samba_share_fusefs <span class="nt">--</span><span class="o">&gt;</span> off
sanlock_use_fusefs <span class="nt">--</span><span class="o">&gt;</span> off
use_fusefs_home_dirs <span class="nt">--</span><span class="o">&gt;</span> on
virt_sandbox_use_fusefs <span class="nt">--</span><span class="o">&gt;</span> off
virt_use_fusefs <span class="nt">--</span><span class="o">&gt;</span> on
</pre></td></tr></tbody></table></code></div></div>

<p>Y confirmamos que <code class="language-plaintext highlighter-rouge">use_fusefs_home_dirs</code> y <code class="language-plaintext highlighter-rouge">virt_use_fusefs</code> están habilitados.</p>

<h3 id="configuración-de-claves-ssh"><span class="me-2">Configuración de claves SSH</span><a href="#configuración-de-claves-ssh" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Para facilitar la conexión sin necesidad de introducir contraseñas cada vez, configuramos la autenticación mediante claves SSH. Añadimos la clave pública del cliente al archivo <code class="language-plaintext highlighter-rouge">authorized_keys</code> del usuario root en el servidor:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo cat</span> /root/.ssh/authorized_keys
no-port-forwarding,no-agent-forwarding,no-X11-forwarding,command<span class="o">=</span><span class="s2">"echo 'Please login as the user </span><span class="se">\"</span><span class="s2">rocky</span><span class="se">\"</span><span class="s2"> rather than the user </span><span class="se">\"</span><span class="s2">root</span><span class="se">\"</span><span class="s2">.';echo;sleep 10;exit 142"</span> ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQClFcnIhYd1oaEpvGi/f4psQc4+DaAZvSNIxVRRJHtRoJui8wbJybi3Om8yTOflgEcmBaUrJLkfmzmWqVq1j6MpESq72p7J2hdq2lXnvzdt3huYv5evFwyd0p/r72RfpVZzr3ILi/BS//SJqfVKlDEVbZRaOE5MU2XuElmFFY4EO7NiiZAkbatVqUOT8H/nrfXcad0mjZVxroVqHhsHV+06rxiB0xifG0xZv204Qj4zRura8uqZlEVAAwU+NO/SIGdRwpLY7n7xbQGe1DbjHgPUeVPjJX6HpMK41a43eGj4XYdYtZBLugaU8Mq1y6Kl3tE6cvYkQ9WFTYTLLNy3bvNRZpP2p6qAy5qn03ZLFICiXBNXPmrl5+KVrKaSipNaPHkmInvczbYJjXpfyVBsfEabt+0Y1629M+eEKkkl+iZmVr2ySDSS1gHxMC7zlJRaUhG27o26agpNPYPHH3mVXVjqdGg0ryH0YHZk1V8+Gt1Z9hZ7UYWE1UX8DCgFfecqdX0<span class="o">=</span> pavlo@debian
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCwTo+Y3zoaYeUIZu5qcDG8HPyTWszbRc6Hx25+Zm9r1YhmMA/amVLUjldhC5N48/7vryBDpVqV+NaAKjXrYqUJjym2SJxDJlUU1etrtAJ4f8aLtCOzF2HZihv/szRFl/x72F0sb+NHQJsMISERJJ4uWJlsw10O1vo2E8+6JKYMgKTbzVrgun1MyAgXQTY73+wYkbhhgXtF9s3+L1p8HffsaaSSXOgcJRL2RxoZ/2yciVpk5Jo2fsy+z+aXjKglQqZmOUkbamcQ14Hr6Ol+JfY8H0qQNVMJCG3ZgWuoe2sqDoDd17QMoNg/vklmScgS3k/iTvgRD2zMZbUqNXHFQXbzbRUUP87OUJvuVx2vRzV3XsbSP8ZAP+bM91tIZHnZ0G8p32UM75EnrSbog+ZcYT/2SUoXgNENI4X8YcNNts73OKWEU04sNbxayJIBKcMoqa/NJifn2kSIOKyNFqoaT6wH9Tlyg3tixE/ngRSH5WN7REWw3bF8gVkYxNY3Rus9iDs<span class="o">=</span> rocky@cliente-rocky.novalocal
</pre></td></tr></tbody></table></code></div></div>

<p>Este archivo contiene las claves públicas de los clientes que pueden conectarse al servidor. En nuestro caso, añadimos la clave del usuario <strong><code class="language-plaintext highlighter-rouge">rocky</code></strong> desde el cliente.</p>

<h3 id="creación-del-directorio-compartido"><span class="me-2">Creación del directorio compartido</span><a href="#creación-del-directorio-compartido" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>En el servidor, creamos un directorio que queremos compartir con el cliente:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo mkdir </span>compartir
<span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo chown </span>rocky:rocky compartir/
</pre></td></tr></tbody></table></code></div></div>

<p>Dentro de este directorio, colocamos un archivo de prueba para verificar que todo funciona correctamente:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo cat </span>compartir/kk.txt 
Buenas tardes por la mañana
</pre></td></tr></tbody></table></code></div></div>

<h3 id="montaje-del-directorio-remoto-en-el-cliente"><span class="me-2">Montaje del directorio remoto en el cliente</span><a href="#montaje-del-directorio-remoto-en-el-cliente" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Ahora, desde el cliente, procedemos a montar el directorio remoto utilizando SSHFS. Primero, creamos un directorio donde montaremos el directorio remoto:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@cliente-rocky ~]<span class="nv">$ </span><span class="nb">mkdir </span>montaje
</pre></td></tr></tbody></table></code></div></div>

<p>Luego, utilizamos el comando <code class="language-plaintext highlighter-rouge">sshfs</code> para montar el directorio remoto:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@cliente-rocky ~]<span class="nv">$ </span>sshfs <span class="nt">-p</span> 2222 root@10.0.0.25:/home/rocky/compartir montaje/
</pre></td></tr></tbody></table></code></div></div>

<p>Este comando indica que queremos montar el directorio <code class="language-plaintext highlighter-rouge">/home/rocky/compartir</code> del servidor <code class="language-plaintext highlighter-rouge">10.0.0.25</code> en el directorio <code class="language-plaintext highlighter-rouge">montaje</code> de nuestro cliente, utilizando el puerto 2222.</p>

<p>Para verificar que el montaje se realizó correctamente, ejecutamos:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@cliente-rocky ~]<span class="nv">$ </span><span class="nb">df</span> <span class="nt">-h</span>
Filesystem                            Size  Used Avail Use% Mounted on
devtmpfs                              4.0M     0  4.0M   0% /dev
tmpfs                                 888M     0  888M   0% /dev/shm
tmpfs                                 355M  532K  355M   1% /run
/dev/vda4                              19G  1.2G   18G   7% /
/dev/vda3                             936M  257M  680M  28% /boot
/dev/vda2                             100M  7.0M   93M   8% /boot/efi
tmpfs                                 178M     0  178M   0% /run/user/1000
root@10.0.0.25:/home/rocky/compartir   19G  1.2G   18G   7% /home/rocky/montaje
</pre></td></tr></tbody></table></code></div></div>

<p>Y confirmamos que el sistema de archivos remoto aparece en la lista de sistemas de archivos montados.</p>

<p>Finalmente, accedemos al archivo de prueba que creamos en el servidor:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@cliente-rocky ~]<span class="nv">$ </span><span class="nb">ls
</span>montaje
<span class="o">[</span>rocky@cliente-rocky ~]<span class="nv">$ </span><span class="nb">cat </span>montaje/kk.txt 
Buenas tardes por la mañana
</pre></td></tr></tbody></table></code></div></div>

<h2 id="samba"><span class="me-2">SAMBA</span><a href="#samba" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Samba es un servicio crítico para compartir archivos en redes mixtas (Linux/Windows). Vamos a configurarlo paso a paso.</p>

<p>Antes de realizar cambios, es una buena práctica hacer una copia de seguridad del archivo de configuración original:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo cp</span> /etc/samba/smb.conf /etc/samba/smb.conf.backup
</pre></td></tr></tbody></table></code></div></div>

<p>Vamos a crear un directorio que será compartido a través de Samba. En este ejemplo, usaremos <code class="language-plaintext highlighter-rouge">/mnt/samba/share</code>:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo mkdir</span> <span class="nt">-p</span> /mnt/samba/share
</pre></td></tr></tbody></table></code></div></div>

<p>Aseguramos que los permisos y la propiedad del directorio sean correctos:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo chmod</span> <span class="nt">-R</span> 0755 /mnt/samba/share/
<span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo chown</span> <span class="nt">-R</span> rocky:rocky /mnt/samba/share/
</pre></td></tr></tbody></table></code></div></div>

<p>SELinux utiliza contextos de seguridad para controlar el acceso a los recursos. Para que Samba pueda acceder al directorio compartido, debemos asignar el contexto correcto:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo chcon</span> <span class="nt">-t</span> samba_share_t /mnt/samba/share/
</pre></td></tr></tbody></table></code></div></div>

<p>Aquí, <code class="language-plaintext highlighter-rouge">chcon</code> cambia el contexto de seguridad de SELinux para que el directorio sea accesible por Samba.</p>

<p>Editamos el archivo de configuración de Samba (<code class="language-plaintext highlighter-rouge">/etc/samba/smb.conf</code>) para definir nuestro recurso compartido. Añadimos la siguiente sección al final del archivo:</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>[Anonymous]
path = /mnt/samba/share
browsable = yes
writable = yes
guest ok = yes
read only = no
valid users = rocky
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>
    <p><strong>path</strong>: Especifica la ruta del directorio compartido.</p>
  </li>
  <li>
    <p><strong>browsable</strong>: Permite que el recurso sea visible en la red.</p>
  </li>
  <li>
    <p><strong>writable</strong>: Permite la escritura en el recurso.</p>
  </li>
  <li>
    <p><strong>guest ok</strong>: Permite el acceso a usuarios invitados.</p>
  </li>
  <li>
    <p><strong>read only</strong>: Define si el recurso es de solo lectura.</p>
  </li>
  <li>
    <p><strong>valid users</strong>: Especifica los usuarios permitidos para acceder al recurso.</p>
  </li>
</ul>

<p>Y para realizar la comprobación de que la configuración es correcta ejecutamos el siguiente comando:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span>testparm
Load smb config files from /etc/samba/smb.conf
Loaded services file OK.
Weak crypto is allowed by GnuTLS <span class="o">(</span>e.g. NTLM as a compatibility fallback<span class="o">)</span>

Server role: ROLE_STANDALONE

Press enter to see a dump of your service definitions

<span class="c"># Global parameters</span>
<span class="o">[</span>global]
	printcap name <span class="o">=</span> cups
	security <span class="o">=</span> USER
	workgroup <span class="o">=</span> SAMBA
	idmap config <span class="k">*</span> : backend <span class="o">=</span> tdb
	cups options <span class="o">=</span> raw


<span class="o">[</span>homes]
	browseable <span class="o">=</span> No
	comment <span class="o">=</span> Home Directories
	inherit acls <span class="o">=</span> Yes
	<span class="nb">read </span>only <span class="o">=</span> No
	valid <span class="nb">users</span> <span class="o">=</span> %S %D%w%S


<span class="o">[</span>printers]
	browseable <span class="o">=</span> No
	comment <span class="o">=</span> All Printers
	create mask <span class="o">=</span> 0600
	path <span class="o">=</span> /var/tmp
	printable <span class="o">=</span> Yes


<span class="o">[</span>print<span class="nv">$]</span>
	comment <span class="o">=</span> Printer Drivers
	create mask <span class="o">=</span> 0664
	directory mask <span class="o">=</span> 0775
	force group <span class="o">=</span> @printadmin
	path <span class="o">=</span> /var/lib/samba/drivers
	write list <span class="o">=</span> @printadmin root


<span class="o">[</span>Anonymous]
	guest ok <span class="o">=</span> Yes
	path <span class="o">=</span> /mnt/samba/share
	<span class="nb">read </span>only <span class="o">=</span> No
	valid <span class="nb">users</span> <span class="o">=</span> rocky
</pre></td></tr></tbody></table></code></div></div>

<p>Este comando valida la sintaxis del archivo <code class="language-plaintext highlighter-rouge">smb.conf</code> y muestra un resumen de la configuración.</p>

<p>Permitimos el tráfico de Samba a través del firewall:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo </span>firewall-cmd <span class="nt">--add-service</span><span class="o">=</span>samba <span class="nt">--zone</span><span class="o">=</span>public <span class="nt">--permanent</span>
success
<span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo </span>firewall-cmd <span class="nt">--reload</span>
success
</pre></td></tr></tbody></table></code></div></div>

<p>Iniciamos y habilitamos los servicios de Samba (<strong><code class="language-plaintext highlighter-rouge">smb</code></strong> y <strong><code class="language-plaintext highlighter-rouge">nmb</code></strong>):</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo </span>systemctl start smb
<span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo </span>systemctl <span class="nb">enable </span>smb
Created symlink /etc/systemd/system/multi-user.target.wants/smb.service → /usr/lib/systemd/system/smb.service.
<span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo </span>systemctl start nmb
<span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo </span>systemctl <span class="nb">enable </span>nmb
Created symlink /etc/systemd/system/multi-user.target.wants/nmb.service → /usr/lib/systemd/system/nmb.service.
</pre></td></tr></tbody></table></code></div></div>

<p>Añadimos un usuario de Samba y establecemos una contraseña:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo </span>smbpasswd <span class="nt">-a</span> rocky
New SMB password:
Retype new SMB password:
Added user rocky.
</pre></td></tr></tbody></table></code></div></div>

<p>Este comando añade al usuario rocky a la base de datos de Samba y solicita una contraseña.</p>

<h3 id="prueba-de-funcionamiento-desde-el-cliente"><span class="me-2">Prueba de funcionamiento desde el cliente</span><a href="#prueba-de-funcionamiento-desde-el-cliente" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Para verificar que todo funciona correctamente, realizamos pruebas de acceso desde un cliente.</p>

<p>Primero debemos instalar el paquete <strong>samba-client</strong>:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@cliente-rocky ~]<span class="nv">$ </span><span class="nb">sudo </span>dnf <span class="nb">install </span>samba-client <span class="nt">-y</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Listamos los recursos compartidos en el servidor:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@cliente-rocky ~]<span class="nv">$ </span>smbclient <span class="nt">--user</span><span class="o">=</span>rocky <span class="nt">-L</span> //10.0.0.175
Password <span class="k">for</span> <span class="o">[</span>SAMBA<span class="se">\r</span>ocky]:

	Sharename       Type      Comment
	<span class="nt">---------</span>       <span class="nt">----</span>      <span class="nt">-------</span>
	print<span class="nv">$ </span>         Disk      Printer Drivers
	Anonymous       Disk      
	IPC<span class="nv">$ </span>           IPC       IPC Service <span class="o">(</span>Samba 4.20.2<span class="o">)</span>
	rocky           Disk      Home Directories
SMB1 disabled <span class="nt">--</span> no workgroup available
</pre></td></tr></tbody></table></code></div></div>

<p>Esto mostrará los recursos compartidos disponibles.</p>

<p>Montamos el recurso compartido en el cliente:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@cliente-rocky ~]<span class="nv">$ </span><span class="nb">sudo </span>mount <span class="nt">-t</span> cifs <span class="nt">-o</span> <span class="nv">username</span><span class="o">=</span>rocky,password<span class="o">=</span>messi,rw,vers<span class="o">=</span>2.1,file_mode<span class="o">=</span>0777,dir_mode<span class="o">=</span>0777 //10.0.0.175/Anonymous /home/rocky/montaje/
</pre></td></tr></tbody></table></code></div></div>

<p>Aquí, <strong>username</strong> y <strong>password</strong> son las credenciales del usuario de Samba, y <code class="language-plaintext highlighter-rouge">//10.0.0.175/Anonymous</code> es la ruta del recurso compartido.</p>

<p>Por último, verificamos que el recurso se ha montado correctamente:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>rocky@cliente-rocky ~]<span class="nv">$ </span><span class="nb">df</span> <span class="nt">-h</span>
Filesystem              Size  Used Avail Use% Mounted on
devtmpfs                4.0M     0  4.0M   0% /dev
tmpfs                   385M     0  385M   0% /dev/shm
tmpfs                   154M  532K  154M   1% /run
/dev/vda4               8.9G  1.1G  7.8G  13% /
/dev/vda3               936M  257M  680M  28% /boot
/dev/vda2               100M  7.0M   93M   8% /boot/efi
tmpfs                    77M     0   77M   0% /run/user/1000
//10.0.0.175/Anonymous  8.9G  1.3G  7.7G  14% /home/rocky/montaje
</pre></td></tr></tbody></table></code></div></div>

<p>Y como vemos el recurso compartido está en la lista de sistemas de archivos montados.</p>

<h2 id="nfs"><span class="me-2">NFS</span><a href="#nfs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<h3 id="instalación-y-configuración-del-servidor-nfs"><span class="me-2">Instalación y Configuración del Servidor NFS</span><a href="#instalación-y-configuración-del-servidor-nfs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Lo primero que debemos hacer en el servidor Rocky Linux es asegurarnos de que el servicio NFS está habilitado. Para ello, ejecutamos:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo </span>systemctl start nfs-server.service
<span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo </span>systemctl <span class="nb">enable </span>nfs-server.service
Created symlink /etc/systemd/system/multi-user.target.wants/nfs-server.service → /usr/lib/systemd/system/nfs-server.service.
</pre></td></tr></tbody></table></code></div></div>

<p>Ahora, creamos el directorio que vamos a compartir mediante NFS:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo mkdir</span> <span class="nt">-p</span> /mnt/nfs/kk
</pre></td></tr></tbody></table></code></div></div>

<p>Este será el punto de montaje donde guardaremos los archivos que estarán disponibles para los clientes NFS.</p>

<p>A continuación, debemos definir las reglas de exportación en el archivo <code class="language-plaintext highlighter-rouge">/etc/exports</code>, que indica qué directorios se comparten y con qué permisos. Lo editamos y agregamos la siguiente línea:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo </span>nano /etc/exports
<span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">cat</span> /etc/exports
/mnt/nfs/kk  10.0.0.0/24<span class="o">(</span>rw,sync,no_all_squash,no_root_squash<span class="o">)</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Esto significa que estamos compartiendo el directorio <code class="language-plaintext highlighter-rouge">/mnt/nfs/kk</code> con la red <code class="language-plaintext highlighter-rouge">10.0.0.0/24</code>, permitiendo lectura y escritura (<em>rw</em>), asegurando que las escrituras se realicen de forma sincronizada (<em>sync</em>), y permitiendo que el usuario root del cliente actúe como root en el servidor (<em>no_root_squash</em>).</p>

<p>Aplicamos la configuración ejecutando:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo </span>exportfs <span class="nt">-arv</span>
exporting 10.0.0.0/24:/mnt/nfs/kk
</pre></td></tr></tbody></table></code></div></div>

<p>Y verificamos que el directorio esté efectivamente exportado:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo </span>exportfs <span class="nt">-s</span>
/mnt/nfs/kk  10.0.0.0/24<span class="o">(</span><span class="nb">sync</span>,wdelay,hide,no_subtree_check,sec<span class="o">=</span>sys,rw,secure,no_root_squash,no_all_squash<span class="o">)</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Si todo está correcto, deberíamos ver una salida que confirma que el directorio <code class="language-plaintext highlighter-rouge">/mnt/nfs/kk</code> está compartido con la red <code class="language-plaintext highlighter-rouge">10.0.0.0/24</code>.</p>

<h3 id="configuración-del-firewall"><span class="me-2">Configuración del Firewall</span><a href="#configuración-del-firewall" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Para que el servidor NFS pueda comunicarse con los clientes, necesitamos permitir el tráfico necesario a través del firewall. Instalamos y configuramos firewalld:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo </span>dnf <span class="nb">install </span>firewalld <span class="nt">-y</span>
<span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo </span>systemctl start firewalld
<span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo </span>systemctl <span class="nb">enable </span>firewalld
<span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo </span>systemctl status firewalld
● firewalld.service - firewalld - dynamic firewall daemon
     Loaded: loaded <span class="o">(</span>/usr/lib/systemd/system/firewalld.service<span class="p">;</span> enabled<span class="p">;</span> preset: enabled<span class="o">)</span>
     Active: active <span class="o">(</span>running<span class="o">)</span> since Thu 2025-02-06 19:26:09 UTC<span class="p">;</span> 6s ago
       Docs: man:firewalld<span class="o">(</span>1<span class="o">)</span>
   Main PID: 34890 <span class="o">(</span>firewalld<span class="o">)</span>
      Tasks: 2 <span class="o">(</span>limit: 4450<span class="o">)</span>
     Memory: 26.7M
        CPU: 471ms
     CGroup: /system.slice/firewalld.service
             └─34890 /usr/bin/python3 <span class="nt">-s</span> /usr/sbin/firewalld <span class="nt">--nofork</span> <span class="nt">--nopid</span>

Feb 06 19:26:09 rocky.novalocal systemd[1]: Starting firewalld - dynamic firewall daemon...
Feb 06 19:26:09 rocky.novalocal systemd[1]: Started firewalld - dynamic firewall daemon.
</pre></td></tr></tbody></table></code></div></div>

<p>Habilitamos los servicios requeridos para NFS:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo </span>firewall-cmd <span class="nt">--permanent</span> <span class="nt">--add-service</span><span class="o">=</span>nfs
success
<span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo </span>firewall-cmd <span class="nt">--permanent</span> <span class="nt">--add-service</span><span class="o">=</span>rpc-bind
success
<span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo </span>firewall-cmd <span class="nt">--permanent</span> <span class="nt">--add-service</span><span class="o">=</span>mountd
success
<span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">sudo </span>firewall-cmd <span class="nt">--reload</span>
success
</pre></td></tr></tbody></table></code></div></div>

<p>Con esto, hemos asegurado que el tráfico necesario para NFS pueda pasar sin problemas.</p>

<h3 id="configuración-del-cliente-nfs"><span class="me-2">Configuración del Cliente NFS</span><a href="#configuración-del-cliente-nfs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Ahora pasamos al cliente, que también es una máquina Rocky Linux. En primer lugar, instalamos los paquetes necesarios:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@cliente-rocky ~]<span class="nv">$ </span><span class="nb">sudo </span>dnf <span class="nb">install </span>nfs-utils nfs4-acl-tools
</pre></td></tr></tbody></table></code></div></div>

<p>Verificamos que el servidor está compartiendo correctamente el directorio usando el comando showmount:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@cliente-rocky ~]<span class="nv">$ </span>showmount <span class="nt">-e</span> 10.0.0.175
Export list <span class="k">for </span>10.0.0.175:
/mnt/nfs/kk 10.0.0.0/24
</pre></td></tr></tbody></table></code></div></div>

<p>Si todo está en orden, veremos la exportación del directorio <code class="language-plaintext highlighter-rouge">/mnt/nfs/kk</code> para la red <code class="language-plaintext highlighter-rouge">10.0.0.0/24</code>.</p>

<p>Desde el servidor, creamos un archivo en el directorio compartido y verificamos sus permisos:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">echo</span> <span class="s1">'Hola desde el servidor'</span> | <span class="nb">sudo tee</span> /mnt/nfs/kk/hola.txt
Hola desde el servidor
<span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span> /mnt/nfs/kk/hola.txt 
<span class="nt">-rw-r--r--</span><span class="nb">.</span> 1 root root 22 Feb  6 19:37 /mnt/nfs/kk/hola.txt
</pre></td></tr></tbody></table></code></div></div>

<p>Desde el cliente, comprobamos que el archivo también está disponible en el punto de montaje <code class="language-plaintext highlighter-rouge">/mnt/nfs</code>:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@cliente-rocky ~]<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span> /mnt/nfs/hola.txt 
<span class="nt">-rw-r--r--</span><span class="nb">.</span> 1 root root 22 Feb  6 19:37 /mnt/nfs/hola.txt
</pre></td></tr></tbody></table></code></div></div>

<p>También verificamos el sistema de archivos montado en el cliente, donde observamos que el recurso <code class="language-plaintext highlighter-rouge">10.0.0.175:/mnt/nfs/kk</code> está disponible en <code class="language-plaintext highlighter-rouge">/mnt/nfs</code>:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@cliente-rocky ~]<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span> /mnt/nfs/hola.txt 
<span class="nt">-rw-r--r--</span><span class="nb">.</span> 1 root root 22 Feb  6 19:37 /mnt/nfs/hola.txt
<span class="o">[</span>rocky@cliente-rocky ~]<span class="nv">$ </span><span class="nb">df</span> <span class="nt">-h</span>
Filesystem              Size  Used Avail Use% Mounted on
devtmpfs                4.0M     0  4.0M   0% /dev
tmpfs                   385M     0  385M   0% /dev/shm
tmpfs                   154M  532K  154M   1% /run
/dev/vda4               8.9G  1.1G  7.9G  12% /
/dev/vda3               936M  257M  680M  28% /boot
/dev/vda2               100M  7.0M   93M   8% /boot/efi
tmpfs                    77M     0   77M   0% /run/user/1000
10.0.0.175:/mnt/nfs/kk  8.9G  1.3G  7.7G  14% /mnt/nfs
</pre></td></tr></tbody></table></code></div></div>

<p>Ahora realizamos la misma prueba con Samba. En el servidor, creamos un archivo en el recurso compartido de Samba:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@rocky ~]<span class="nv">$ </span><span class="nb">echo</span> <span class="s1">'Hola desde el servidor'</span> | <span class="nb">sudo tee</span> /mnt/samba/share/hola.txt
Hola desde el servidor
</pre></td></tr></tbody></table></code></div></div>

<p>En el cliente, comprobamos que el archivo está accesible en el punto de montaje de Samba:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@cliente-rocky ~]<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span> montaje/
total 4
<span class="nt">-rwxrwxrwx</span><span class="nb">.</span> 1 root root 23 Feb  6 20:16 hola.txt
</pre></td></tr></tbody></table></code></div></div>

<p>Finalmente, verificamos su contenido:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="o">[</span>rocky@cliente-rocky ~]<span class="nv">$ </span><span class="nb">cat </span>montaje/hola.txt 
Hola desde el servidor
</pre></td></tr></tbody></table></code></div></div>

<p>Con esto, confirmamos que tanto NFS como Samba como SSHFS están configurados correctamente y permiten el acceso a los archivos compartidos entre servidor y cliente.</p>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/sistemas/">Sistemas</a>,
          <a href="/categories/selinux/">SELinux</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/selinux/"
            class="post-tag no-text-decoration"
          >SELinux</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=Configuraci%C3%B3n/activaci%C3%B3n%20de%20SELinux%20-%20Blog%20personal&url=%2Fposts%2Fselinux%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=Configuraci%C3%B3n/activaci%C3%B3n%20de%20SELinux%20-%20Blog%20personal&u=%2Fposts%2Fselinux%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=%2Fposts%2Fselinux%2F&text=Configuraci%C3%B3n/activaci%C3%B3n%20de%20SELinux%20-%20Blog%20personal" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/selinux/">Configuración/activación de SELinux</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/systemd/">systemd/sshfs</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/site_to_site_wireguard/">VPN sitio a sitio con WireGuard</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/site_to_site_openvpn/">VPN sitio a sitio con OpenVPN y certificados x509</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/acceso_remoto_openvpn/">VPN de acceso remoto con OpenVPN y certificados x509</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/vpn/">VPN</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/criptograf%C3%ADa/">Criptografía</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/systemd/">Systemd</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/aplicaciones/">Aplicaciones</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/automatizaci%C3%B3n/">Automatización</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/cloud/">Cloud</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/compartici%C3%B3n-de-archivos/">Compartición de archivos</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/instalaci%C3%B3n/">Instalación</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/monitoreo-y-gesti%C3%B3n-de-logs/">Monitoreo y Gestión de Logs</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/selinux/">SELinux</a>
      
    </div>
  </section>


            </div>

            
              
              



  <section id="toc-wrapper" class="d-none ps-0 pe-4">
    <h2 class="panel-heading ps-3 mb-2">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    










  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/journald/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1737464400"
  data-df="ll"
  
>
  Jan 21, 2025
</time>

              <h4 class="pt-0 my-2">Recolección centralizada de logs de sistema, mediante journald</h4>
              <div class="text-muted">
                <p>En este artículo se presenta cómo implementar un sistema de recolección centralizada de logs en un entorno Openstack utilizando systemd-journal-remote. El objetivo es centralizar los logs de sistem...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/systemd-boot/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1736861400"
  data-df="ll"
  
>
  Jan 14, 2025
</time>

              <h4 class="pt-0 my-2">Systemd-Boot</h4>
              <div class="text-muted">
                <p>En este post aprenderemos a instalar Debian 13 Trixie con systemd-boot en donde nos familiarizaremos con el sistema. Además, haremos un cambio de gestor de arranque iniciando por grub y finalmente ...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/systemd/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1734629400"
  data-df="ll"
  
>
  Dec 19, 2024
</time>

              <h4 class="pt-0 my-2">systemd/sshfs</h4>
              <div class="text-muted">
                <p>Configuramos dos instancias en OpenStack para compartir un sistema de archivos remoto mediante SSHFS. Montamos el sistema manualmente en la máquina cliente y luego automatizamos el proceso usando u...</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/site_to_site_wireguard/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>VPN sitio a sitio con WireGuard</p>
    </a>
  

  
    <div class="btn btn-outline-primary disabled" aria-label="Newer">
      <p>-</p>
    </div>
  
</nav>

            
              
              <!-- The comments switcher -->


            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2025</time>

    
      <a href="https://github.com/PabloMartin19">Pablo Martín Hidalgo</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.1.1"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/vpn/">VPN</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/criptograf%C3%ADa/">Criptografía</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/systemd/">Systemd</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/aplicaciones/">Aplicaciones</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/automatizaci%C3%B3n/">Automatización</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/cloud/">Cloud</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/compartici%C3%B3n-de-archivos/">Compartición de archivos</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/instalaci%C3%B3n/">Instalación</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/monitoreo-y-gesti%C3%B3n-de-logs/">Monitoreo y Gestión de Logs</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/selinux/">SELinux</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- JavaScripts -->
    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.29.0/dist/tocbot.min.js"></script>







<script src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  







    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
    noResultsText: '<p class="mt-5">Oops! No results found.</p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
</html>


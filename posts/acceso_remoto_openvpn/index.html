<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="es" >
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="VPN de acceso remoto con OpenVPN y certificados x509" />
<meta name="author" content="Pablo Martín Hidalgo" />
<meta property="og:locale" content="es" />
<meta name="description" content="En este artículo exploraremos cómo configurar una VPN de acceso remoto utilizando WireGuard, una solución moderna y eficiente. Los clientes que se conectarán a la VPN estarán en sistemas operativos Linux, Android y Windows, permitiendo así el acceso seguro a los recursos internos desde diversas plataformas y ubicaciones." />
<meta property="og:description" content="En este artículo exploraremos cómo configurar una VPN de acceso remoto utilizando WireGuard, una solución moderna y eficiente. Los clientes que se conectarán a la VPN estarán en sistemas operativos Linux, Android y Windows, permitiendo así el acceso seguro a los recursos internos desde diversas plataformas y ubicaciones." />
<link rel="canonical" href="/posts/acceso_remoto_openvpn/" />
<meta property="og:url" content="/posts/acceso_remoto_openvpn/" />
<meta property="og:site_name" content="Blog personal" />
<meta property="og:image" content="/assets/img/posts/vpn/portada1.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-01-23T13:00:00+01:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="/assets/img/posts/vpn/portada1.jpg" />
<meta property="twitter:title" content="VPN de acceso remoto con OpenVPN y certificados x509" />
<meta name="twitter:site" content="@Tagarnina10" />
<meta name="twitter:creator" content="@Tagarnina10" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Pablo Martín Hidalgo","url":"https://github.com/PabloMartin19/"},"dateModified":"2025-01-29T19:00:05+01:00","datePublished":"2025-01-23T13:00:00+01:00","description":"En este artículo exploraremos cómo configurar una VPN de acceso remoto utilizando WireGuard, una solución moderna y eficiente. Los clientes que se conectarán a la VPN estarán en sistemas operativos Linux, Android y Windows, permitiendo así el acceso seguro a los recursos internos desde diversas plataformas y ubicaciones.","headline":"VPN de acceso remoto con OpenVPN y certificados x509","image":"/assets/img/posts/vpn/portada1.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/acceso_remoto_openvpn/"},"url":"/posts/acceso_remoto_openvpn/"}</script>
<!-- End Jekyll SEO tag -->


  <title>VPN de acceso remoto con OpenVPN y certificados x509 | Blog personal
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Blog personal">
<meta name="application-name" content="Blog personal">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.6.0/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.29.0/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- JavaScript -->

  
    <!-- Switch the mode between dark and light. -->

<script type="text/javascript">
  class ModeToggle {
    static get MODE_KEY() {
      return 'mode';
    }
    static get MODE_ATTR() {
      return 'data-mode';
    }
    static get DARK_MODE() {
      return 'dark';
    }
    static get LIGHT_MODE() {
      return 'light';
    }
    static get ID() {
      return 'mode-toggle';
    }

    constructor() {
      let self = this;this.sysDarkPrefers.addEventListener('change', () => {
        if (self.hasMode) {
          self.clearMode();
        }
        self.notify();
      });

      if (!this.hasMode) {
        return;
      }

      if (this.isDarkMode) {
        this.setDark();
      } else {
        this.setLight();
      }
    }

    get sysDarkPrefers() {
      return window.matchMedia('(prefers-color-scheme: dark)');
    }

    get isPreferDark() {
      return this.sysDarkPrefers.matches;
    }

    get isDarkMode() {
      return this.mode === ModeToggle.DARK_MODE;
    }

    get hasMode() {
      return this.mode != null;
    }

    get mode() {
      return sessionStorage.getItem(ModeToggle.MODE_KEY);
    }get modeStatus() {
      if (this.hasMode) {
        return this.mode;
      } else {
        return this.isPreferDark ? ModeToggle.DARK_MODE : ModeToggle.LIGHT_MODE;
      }
    }

    setDark() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }

    setLight() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }

    clearMode() {
      document.documentElement.removeAttribute(ModeToggle.MODE_ATTR);
      sessionStorage.removeItem(ModeToggle.MODE_KEY);
    }notify() {
      window.postMessage(
        {
          direction: ModeToggle.ID,
          message: this.modeStatus
        },
        '*'
      );
    }

    flipMode() {
      if (this.hasMode) {
        this.clearMode();
      } else {
        if (this.isPreferDark) {
          this.setLight();
        } else {
          this.setDark();
        }
      }

      this.notify();
    }
  }

  const modeToggle = new ModeToggle();
</script>

  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/avatar.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">Blog personal</a>
    <p class="site-subtitle fst-italic mb-0">Los mejores programas son aquellos que funcionan.</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
      

      
        <a
          href="https://github.com/PabloMartin19"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://twitter.com/Tagarnina10"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fa-brands fa-x-twitter"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['pmartinhidalgo19','gmail.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="https://www.linkedin.com/in/pablo-mart%C3%ADn-hidalgo/"
          aria-label="linkedin"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-linkedin"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>VPN de acceso remoto con OpenVPN y certificados x509</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  

  
  

  




<!-- return -->




<article class="px-1">
  <header>
    <h1 data-toc-skip>VPN de acceso remoto con OpenVPN y certificados x509</h1>
    
      <p class="post-desc fw-light mb-4">En este artículo exploraremos cómo configurar una VPN de acceso remoto utilizando WireGuard, una solución moderna y eficiente. Los clientes que se conectarán a la VPN estarán en sistemas operativos Linux, Android y Windows, permitiendo así el acceso seguro a los recursos internos desde diversas plataformas y ubicaciones.</p>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1737633600"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Jan 23, 2025
</time>

      </span>

      <!-- lastmod date -->
      
        <span>
          Updated
          <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1738173605"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Jan 29, 2025
</time>

        </span>
      

      
        
        
        

        

        <div class="mt-3 mb-3">
          <a href="/assets/img/posts/vpn/portada1.jpg" class="popup img-link preview-img shimmer"><img src="/assets/img/posts/vpn/portada1.jpg"  alt="Preview Image" width="1200" height="630"  loading="lazy"></a></div>
      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              
                <a href="https://github.com/PabloMartin19/">Pablo Martín Hidalgo</a>
                
              
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="2920 words"
>
  <em>16 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  <div class="content">
    <p>Configura una conexión VPN de acceso remoto entre dos equipos del cloud:</p>

<ul>
  <li>Uno de los dos equipos (el que actuará como servidor) estará conectado a dos redes
    <ul>
      <li>Para la autenticación de los extremos se usarán obligatoriamente certificados digitales, que se generarán utilizando openssl y se almacenarán en el directorio /etc/openvpn, junto con  los parámetros Diffie-Helman y el certificado de la propia Autoridad de Certificación.</li>
      <li>Se utilizarán direcciones de la red 10.99.99.0/24 para las direcciones virtuales de la VPN. La dirección 10.99.99.1 se asignará al servidor VPN.</li>
      <li>Los ficheros de configuración del servidor y del cliente se crearán en el directorio /etc/openvpn de cada máquina, y se llamarán servidor.conf y cliente.conf respectivamente.</li>
      <li>Tras el establecimiento de la VPN, la máquina cliente debe ser capaz de acceder a una máquina que esté en la otra red a la que está conectado el servidor.</li>
    </ul>
  </li>
</ul>

<h2 id="escenario"><span class="me-2">Escenario</span><a href="#escenario" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Montaremos el pequeño escenario en GNS3 con tres máquinas Debian 12 y una nube NAT que nos proporcionará Internet para instalaciones necesarias:</p>

<ul>
  <li>
    <p><strong>Servidor</strong>: contará con tres interfaces, <code class="language-plaintext highlighter-rouge">ens4</code> que conectará con <strong>Cliente1</strong> en la red 192.168.1.0/24, la interfaz <code class="language-plaintext highlighter-rouge">ens5</code> que conectará con <strong>Cliente2</strong> en la red 192.168.2.0/24 y la interfaz <code class="language-plaintext highlighter-rouge">ens6</code> que estará conectada a la nube NAT.</p>
  </li>
  <li>
    <p><strong>Cliente1</strong>: conectado a la red 192.168.1.0/24 a través de la interfaz <code class="language-plaintext highlighter-rouge">ens4</code>.</p>
  </li>
  <li>
    <p><strong>Cliente2</strong>: conectado a la red 192.168.2.0/24 a través de la interfaz <code class="language-plaintext highlighter-rouge">ens4</code>.</p>
  </li>
  <li>
    <p><strong>NAT</strong>: conectada al <strong>Servidor</strong>.</p>
  </li>
</ul>

<p>Quedando de la siguiente forma:</p>

<p><a href="/assets/img/posts/vpn/image1.png" class="popup img-link  shimmer"><img src="/assets/img/posts/vpn/image1.png" alt="image" loading="lazy"></a></p>

<h2 id="configuración-del-servidor"><span class="me-2">Configuración del servidor</span><a href="#configuración-del-servidor" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Para configurar el servidor OpenVPN, lo primero que debemos hacer es asegurarnos de que las interfaces de red están activas para tener conexión a Internet. Esto es fundamental, ya que necesitaremos instalar el paquete <strong>openvpn</strong> en nuestro sistema. Para ello, ejecutamos los siguientes comandos en la terminal:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>debian@servidor:~<span class="nv">$ </span><span class="nb">sudo </span>apt update
debian@servidor:~<span class="nv">$ </span><span class="nb">sudo </span>apt <span class="nb">install </span>openvpn <span class="nt">-y</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Una vez instalado OpenVPN, es necesario habilitar el reenvío de paquetes en el sistema para permitir que el tráfico fluya correctamente a través de la VPN. Esto se hace modificando el archivo de configuración del kernel <code class="language-plaintext highlighter-rouge">/etc/sysctl.conf</code>. Para aplicar el cambio inmediatamente, ejecutamos:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>debian@servidor:~<span class="nv">$ </span><span class="nb">sudo </span>sysctl <span class="nt">-p</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Este comando verificará y aplicará la configuración, asegurando que el tráfico IP pueda ser reenviado entre las interfaces de red. La salida del comando debería incluir la siguiente línea:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>net.ipv4.ip_forward <span class="o">=</span> 1
</pre></td></tr></tbody></table></code></div></div>

<p>Ahora procederemos a copiar los archivos de configuración de easy-rsa desde su ubicación predeterminada en <code class="language-plaintext highlighter-rouge">/usr/share/easy-rsa</code> al directorio de configuración de OpenVPN en <code class="language-plaintext highlighter-rouge">/etc/openvpn</code>. Este paso es importante porque nos aseguramos de que futuras actualizaciones del paquete no sobrescriban nuestros archivos personalizados:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>debian@servidor:~<span class="nv">$ </span><span class="nb">sudo cp</span> <span class="nt">-r</span> /usr/share/easy-rsa /etc/openvpn
</pre></td></tr></tbody></table></code></div></div>

<p>Podemos verificar que la copia se ha realizado correctamente listando el contenido del directorio <code class="language-plaintext highlighter-rouge">/etc/openvpn</code>:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>debian@servidor:~<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span> /etc/openvpn/
</pre></td></tr></tbody></table></code></div></div>

<p>Lo que nos devolverá algo similar a:</p>

<div class="language-yaml highlighter-rouge"><div class="code-header">
        <span data-label-text="YAML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="s">total </span><span class="m">16</span>
<span class="s">drwxr-xr-x 2 root root 4096 Nov 11  2023 client</span>
<span class="s">drwxr-xr-x 3 root root 4096 Jan 23 18:28 easy-rsa</span>
<span class="s">drwxr-xr-x 2 root root 4096 Nov 11  2023 server</span>
<span class="s">-rwxr-xr-x 1 root root 1468 Nov 11  2023 update-resolv-conf</span>
</pre></td></tr></tbody></table></code></div></div>

<p>A partir de este momento, trabajaremos dentro del directorio <code class="language-plaintext highlighter-rouge">/etc/openvpn/easy-rsa</code>, ya que este será el entorno donde generaremos los certificados y claves necesarios para nuestra infraestructura de clave pública (PKI).</p>

<p>EasyRSA es una herramienta de línea de comandos diseñada para simplificar la creación y gestión de una PKI (Infraestructura de Clave Pública) utilizada en OpenVPN. También nos permite generar parámetros de <strong>Diffie-Hellman</strong>, que son esenciales para establecer un canal seguro de comunicación en OpenVPN.</p>

<p>El siguiente paso en la configuración será inicializar la infraestructura PKI dentro del directorio de trabajo. Para ello, ejecutamos:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>debian@servidor:~<span class="nv">$ </span><span class="nb">cd</span> /etc/openvpn/easy-rsa/
debian@servidor:/etc/openvpn/easy-rsa<span class="nv">$ </span><span class="nb">sudo</span> ./easyrsa init-pki
<span class="k">*</span> Notice:

  init-pki <span class="nb">complete</span><span class="p">;</span> you may now create a CA or requests.

  Your newly created PKI <span class="nb">dir </span>is:
  <span class="k">*</span> /etc/openvpn/easy-rsa/pki

<span class="k">*</span> Notice:
  IMPORTANT: Easy-RSA <span class="s1">'vars'</span> file has now been moved to your PKI above.
</pre></td></tr></tbody></table></code></div></div>

<p>Este comando creará la estructura de archivos y directorios necesaria para la gestión de certificados en OpenVPN.</p>

<p>El siguiente paso en la configuración de OpenVPN es la creación de una Autoridad Certificadora (CA, por sus siglas en inglés). La CA es responsable de firmar los certificados de los clientes y del servidor, asegurando la autenticidad de las conexiones dentro de la VPN.</p>

<p>Para iniciar este proceso, ejecutamos el siguiente comando dentro del directorio <code class="language-plaintext highlighter-rouge">/etc/openvpn/easy-rsa</code>:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre></td><td class="rouge-code"><pre>debian@servidor:/etc/openvpn/easy-rsa<span class="nv">$ </span><span class="nb">sudo</span> ./easyrsa build-ca
<span class="k">*</span> Notice:
Using Easy-RSA configuration from: /etc/openvpn/easy-rsa/pki/vars

<span class="k">*</span> Notice:
Using SSL: openssl OpenSSL 3.0.15 3 Sep 2024 <span class="o">(</span>Library: OpenSSL 3.0.15 3 Sep 2024<span class="o">)</span>


Enter New CA Key Passphrase: 
Re-Enter New CA Key Passphrase: 
Using configuration from /etc/openvpn/easy-rsa/pki/563317df/temp.f856c430
...+..+......+.+.........+.....+..........+..+....+...............+..............+......+....+.................+..........+...+.........+...+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++<span class="k">*</span>.....+.............+..+....+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++<span class="k">*</span>....+.....+...+...+....+..................+.....+.......+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
...+.+...+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++<span class="k">*</span>.+.........+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++<span class="k">*</span>...+..........+.....+.+.....+.........+.+.....+.+......+.....+.......+.....+...+..........+..............+....+...........+..........+...+........+...+......+...+......+......+.+...+..+.......+..+.........+...............+......+....+..+....+...+...........+.......+...+..+.........+...+...............+.+..+.........+.+.....+.............+..............+.+......+...+..+....+..+...+.+.....................+.........+.....+.+..+.+.....+.......+..............+......+...+................+.....+......+...+..........+..+.......+...+...+..............+...+...+............+....+...+..+.............+.....+...+..................+............+.......+...........+.......+..+...............+...+....+......+...+..............+.+......+........+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Enter PEM pass phrase:
Verifying - Enter PEM pass phrase:
<span class="nt">-----</span>
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter <span class="s1">'.'</span>, the field will be left blank.
<span class="nt">-----</span>
Common Name <span class="o">(</span>eg: your user, host, or server name<span class="o">)</span> <span class="o">[</span>Easy-RSA CA]:pavlo

<span class="k">*</span> Notice:

CA creation <span class="nb">complete </span>and you may now import and sign cert requests.
Your new CA certificate file <span class="k">for </span>publishing is at:
/etc/openvpn/easy-rsa/pki/ca.crt
</pre></td></tr></tbody></table></code></div></div>

<p>Durante el proceso de generación de la Autoridad Certificadora (CA), se nos pedirá establecer una frase de paso para proteger la clave privada. Esta contraseña será requerida cada vez que firmemos certificados nuevos. Como resultado del comando, se han generado dos archivos importantes:</p>

<ul>
  <li>
    <p><strong>El certificado de la CA</strong>, ubicado en <code class="language-plaintext highlighter-rouge">/etc/openvpn/easy-rsa/pki/ca.crt</code>, el cual será compartido con los clientes y el servidor OpenVPN para validar la autenticidad de los certificados.</p>
  </li>
  <li>
    <p><strong>La clave privada de la CA</strong>, almacenada en <code class="language-plaintext highlighter-rouge">/etc/openvpn/easy-rsa/pki/private/ca.key</code>, que debe mantenerse segura y no compartirse, ya que con ella se firman los certificados dentro de la infraestructura VPN.</p>
  </li>
</ul>

<p>El siguiente paso en la configuración será la generación de los <strong>parámetros Diffie-Hellman (DH)</strong>, que OpenVPN utilizará en el proceso de establecimiento de sesión segura entre los nodos de la VPN.</p>

<p>El intercambio de claves Diffie-Hellman es un protocolo criptográfico que permite a dos partes comunicarse de manera segura sobre un canal no confiable, acordando una clave de cifrado común sin necesidad de enviarla explícitamente. Esto proporciona una capa adicional de seguridad en el cifrado de la conexión VPN.</p>

<p>Para generar el certificado y la clave del servidor OpenVPN, utilizamos el siguiente comando dentro del directorio de trabajo de EasyRSA:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
</pre></td><td class="rouge-code"><pre>debian@servidor:/etc/openvpn/easy-rsa<span class="nv">$ </span><span class="nb">sudo</span> ./easyrsa build-server-full server nopass
<span class="k">*</span> Notice:
Using Easy-RSA configuration from: /etc/openvpn/easy-rsa/pki/vars

<span class="k">*</span> Notice:
Using SSL: openssl OpenSSL 3.0.15 3 Sep 2024 <span class="o">(</span>Library: OpenSSL 3.0.15 3 Sep 2024<span class="o">)</span>

...+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++<span class="k">*</span>..........+.+.....+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++<span class="k">*</span>..+..........+.....+.......+......+..............+......+....+...+...+...........+....+.........+........+...+....+..+......+.........+....+..+....+.....+...+...+....+...+.....+...+...+......+...+.......+.........+.....+.+...+.....+...+.......+...........+............+.............+......+...............+.....+...+.............+..+...+...+.+.....+.+.........+...+.................+....+..+.......+...........+.......+..+.+..+...+....+..................+..+...+....+......+..+..........+......+.....+......+...+.......+...+.....+.+.........+...+..+..........+.................+.+.......................+............+.......+...+...+...........+....+.....+.......+..+............+.........+.+...........+...+....+............+.....+.+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
........+...+.+......+............+.....+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++<span class="k">*</span>.+...+...+.........+....+.....+.+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++<span class="k">*</span>.......+.....+.......+.....+...+.......+........+....+..+...............+..........+...+..+....+......+......+..............+....+.....+.+........+...+....+.....+...+...+...+....+...........................+...+..+...+......+.+...+......+.....+.......+..+...............+.+.....+.+...+..+.+..+...+.............+.................+....+...............+...+.....+.+..+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
<span class="nt">-----</span>
<span class="k">*</span> Notice:

Keypair and certificate request completed. Your files are:
req: /etc/openvpn/easy-rsa/pki/reqs/server.req
key: /etc/openvpn/easy-rsa/pki/private/server.key


You are about to sign the following certificate.
Please check over the details shown below <span class="k">for </span>accuracy. Note that this request
has not been cryptographically verified. Please be sure it came from a trusted
<span class="nb">source </span>or that you have verified the request checksum with the sender.

Request subject, to be signed as a server certificate <span class="k">for </span>825 days:

<span class="nv">subject</span><span class="o">=</span>
    commonName                <span class="o">=</span> server


Type the word <span class="s1">'yes'</span> to <span class="k">continue</span>, or any other input to abort.
  Confirm request details: <span class="nb">yes

</span>Using configuration from /etc/openvpn/easy-rsa/pki/086ccb9e/temp.95232f12
Enter pass phrase <span class="k">for</span> /etc/openvpn/easy-rsa/pki/private/ca.key:
Check that the request matches the signature
Signature ok
The Subject<span class="s1">'s Distinguished Name is as follows
commonName            :ASN.1 12:'</span>server<span class="s1">'
Certificate is to be certified until Apr 28 18:52:24 2027 GMT (825 days)

Write out database with 1 new entries
Database updated

* Notice:
Certificate created at: /etc/openvpn/easy-rsa/pki/issued/server.crt
</span></pre></td></tr></tbody></table></code></div></div>

<p>Este comando realiza dos acciones principales:</p>

<ol>
  <li>
    <p>Genera la clave privada del servidor, que se almacena en:</p>

    <div class="language-shell highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre> /etc/openvpn/easy-rsa/pki/private/server.key
</pre></td></tr></tbody></table></code></div>    </div>

    <p>Esta clave debe mantenerse segura, ya que se utilizará para cifrar las comunicaciones del servidor VPN.</p>
  </li>
  <li>
    <p>Crea y firma el certificado del servidor, que se guarda en:</p>

    <div class="language-shell highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre> /etc/openvpn/easy-rsa/pki/issued/server.crt
</pre></td></tr></tbody></table></code></div>    </div>

    <p>Este certificado será utilizado por el servidor OpenVPN para autenticarse ante los clientes VPN.</p>
  </li>
</ol>

<p>Como hemos ejecutado el comando con la opción nopass, el certificado no requiere una frase de paso para su uso, lo que facilita la automatización del arranque del servidor VPN sin intervención manual.</p>

<p>Una vez generado el certificado del servidor, el siguiente paso es la creación de los parámetros Diffie-Hellman (DH), esenciales para el cifrado seguro durante el proceso de establecimiento de sesión. Esto se hace con el siguiente comando:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre>debian@servidor:/etc/openvpn/easy-rsa<span class="nv">$ </span><span class="nb">sudo</span> ./easyrsa gen-dh
<span class="k">*</span> Notice:
Using Easy-RSA configuration from: /etc/openvpn/easy-rsa/pki/vars

<span class="k">*</span> Notice:
Using SSL: openssl OpenSSL 3.0.15 3 Sep 2024 <span class="o">(</span>Library: OpenSSL 3.0.15 3 Sep 2024<span class="o">)</span>

Generating DH parameters, 2048 bit long safe prime
.......+...................................................................................................................................+.............................................................+...............................................................................................................................................................................................................................................................+.............+...................................+.......................................................+...............................................................................................................................................................................................................................................................................................................................................................................................................................+....................................................................................+.......................................................................................................+..........................................................................................................................................................+.............................................................................+...........................................................+...............................................................................+.............................................................................................................................................................................................................+...................................................................................................................................+...................................................................................+...........................+................................................................................................................+...........................................................................++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>++<span class="k">*</span>

<span class="k">*</span> Notice:

DH parameters of size 2048 created at /etc/openvpn/easy-rsa/pki/dh.pem
</pre></td></tr></tbody></table></code></div></div>

<p>Este proceso puede tardar varios minutos, ya que se generan números primos grandes que serán utilizados en el protocolo de intercambio de claves. Una vez completado, los parámetros DH se guardan en:</p>

<div class="language-shell highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>/etc/openvpn/easy-rsa/pki/dh.pem
</pre></td></tr></tbody></table></code></div></div>

<p>Para que un cliente pueda autenticarse en la VPN, necesita un certificado y una clave privada, que deben ser generados en el 
servidor OpenVPN utilizando Easy-RSA. Esto se realiza con el siguiente comando:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>debian@servidor:/etc/openvpn/easy-rsa<span class="nv">$ </span><span class="nb">sudo</span> ./easyrsa build-client-full cliente1 nopass
</pre></td></tr></tbody></table></code></div></div>

<p>Aquí, <code class="language-plaintext highlighter-rouge">cliente1</code> es el nombre del cliente y la opción <code class="language-plaintext highlighter-rouge">nopass</code> indica que la clave privada del cliente no tendrá contraseña.</p>

<p>Una vez generados, los archivos necesarios para la autenticación del cliente son:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">ca.crt</code>: Certificado de la Autoridad Certificadora (CA), que permite verificar la autenticidad de los certificados emitidos.</li>
  <li><code class="language-plaintext highlighter-rouge">cliente1.crt</code>: Certificado específico del cliente.</li>
  <li><code class="language-plaintext highlighter-rouge">cliente1.key</code>: Clave privada del cliente.</li>
</ul>

<p>Ahora, copiamos los ficheros necesarios a una carpeta temporal que nos servirá para transferir a la máquina <strong>Cliente1</strong>:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>root@servidor:~# <span class="nb">cp</span> /etc/openvpn/easy-rsa/pki/ca.crt /home/debian/cliente1/
root@servidor:~# <span class="nb">cp</span> /etc/openvpn/easy-rsa/pki/issued/cliente1.crt /home/debian/cliente1/
root@servidor:~# <span class="nb">cp</span> /etc/openvpn/easy-rsa/pki/private/cliente1.key /home/debian/cliente1/
</pre></td></tr></tbody></table></code></div></div>

<p>Cambiamos los permisos para que el usuario debian pueda acceder a ellos:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>debian@servidor:~<span class="nv">$ </span><span class="nb">sudo chown</span> <span class="nt">-R</span> debian:debian cliente1/
</pre></td></tr></tbody></table></code></div></div>

<p>Y verificamos que los archivos han sido copiados correctamente:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>debian@servidor:~<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span> cliente1/
total 16
<span class="nt">-rw-------</span> 1 debian debian 1180 Jan 23 19:22 ca.crt
<span class="nt">-rw-------</span> 1 debian debian 4471 Jan 23 19:23 cliente1.crt
<span class="nt">-rw-------</span> 1 debian debian 1704 Jan 23 19:23 cliente1.key
</pre></td></tr></tbody></table></code></div></div>

<p>Para transferir estos archivos al cliente, usaremos scp (Secure Copy Protocol), copiándolos a la IP 192.168.1.2:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>debian@servidor:~<span class="nv">$ </span><span class="nb">cd </span>cliente1/
debian@servidor:~/cliente1<span class="nv">$ </span>scp <span class="k">*</span> debian@192.168.1.2:/home/debian
The authenticity of host <span class="s1">'192.168.1.2 (192.168.1.2)'</span> can<span class="s1">'t be established.
ED25519 key fingerprint is SHA256:Gojcktfl97qAXF9KaBhKTK93gIYeN/574t8Ph9Zl2D0.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '</span>192.168.1.2<span class="s1">' (ED25519) to the list of known hosts.
debian@192.168.1.2'</span>s password: 
ca.crt                                        100% 1180   486.0KB/s   00:00    
cliente1.crt                                  100% 4471     2.7MB/s   00:00    
cliente1.key                                  100% 1704   763.9KB/s   00:00 
</pre></td></tr></tbody></table></code></div></div>

<p>El servidor OpenVPN está configurado en <code class="language-plaintext highlighter-rouge">/etc/openvpn/server/servidor.conf</code> con los siguientes parámetros clave:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre>debian@servidor:~<span class="nv">$ </span><span class="nb">sudo cat</span> /etc/openvpn/server/servidor.conf
port 1194
proto udp
dev tun

ca /etc/openvpn/easy-rsa/pki/ca.crt
cert /etc/openvpn/easy-rsa/pki/issued/server.crt
key /etc/openvpn/easy-rsa/pki/private/server.key
dh /etc/openvpn/easy-rsa/pki/dh.pem

topology subnet


server 10.99.99.0 255.255.255.0
ifconfig-pool-persist /var/log/openvpn/ipp.txt

push <span class="s2">"route 192.168.2.0 255.255.255.0"</span>

keepalive 10 120
cipher AES-256-CBC
persist-key
persist-tun
status /var/log/openvpn/openvpn-status.log
verb 3
explicit-exit-notify 1
</pre></td></tr></tbody></table></code></div></div>

<p>Donde:</p>

<ul>
  <li><strong>Puertos y protocolo</strong>: OpenVPN escucha en el puerto <code class="language-plaintext highlighter-rouge">1194</code> utilizando <code class="language-plaintext highlighter-rouge">UDP</code>.</li>
  <li><strong>Configuración de certificados</strong>: Se especifican el certificado de la CA, el certificado del servidor y su clave privada.</li>
  <li><strong>Topología de red</strong>: Se usa <code class="language-plaintext highlighter-rouge">topology subnet</code>, lo que permite asignar direcciones IP individuales dentro de la subred VPN.</li>
  <li><strong>Direcciones IP de la VPN</strong>: Se define la subred <code class="language-plaintext highlighter-rouge">10.99.99.0/24</code> con <code class="language-plaintext highlighter-rouge">ifconfig-pool-persist</code> para asignar direcciones IP fijas a clientes recurrentes.</li>
  <li><strong>Enrutamiento</strong>: Se usa <code class="language-plaintext highlighter-rouge">push "route 192.168.2.0 255.255.255.0"</code> para permitir a los clientes acceder a la red <code class="language-plaintext highlighter-rouge">192.168.2.0/24</code>.</li>
  <li><strong>Seguridad</strong>: Se especifica el cifrado <code class="language-plaintext highlighter-rouge">AES-256-CBC</code> y parámetros como <code class="language-plaintext highlighter-rouge">persist-key</code> y <code class="language-plaintext highlighter-rouge">persist-tun</code> para mantener la sesión en caso de reinicios.</li>
  <li><strong>Registro y verbosidad</strong>: Se habilita el registro de estado en <code class="language-plaintext highlighter-rouge">/var/log/openvpn/openvpn-status.log</code> y <code class="language-plaintext highlighter-rouge">verb 3</code> para obtener información de depuración.</li>
</ul>

<p>Ahora, habilitamos el servicio OpenVPN para poner en marcha el túnel:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>debian@servidor:~<span class="nv">$ </span><span class="nb">sudo </span>systemctl <span class="nb">enable</span> <span class="nt">--now</span> openvpn-server@servidor
Created symlink /etc/systemd/system/multi-user.target.wants/openvpn-server@servidor.service → /lib/systemd/system/openvpn-server@.service.
debian@servidor:~<span class="nv">$ </span><span class="o">[</span> 8384.381168] tun: Universal TUN/TAP device driver, 1.6
</pre></td></tr></tbody></table></code></div></div>

<p>Verificamos su estado y vemos que está funcionando correctamente:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre>debian@servidor:~<span class="nv">$ </span><span class="nb">sudo </span>systemctl status openvpn-server@servidor
● openvpn-server@servidor.service - OpenVPN service <span class="k">for </span>servidor
     Loaded: loaded <span class="o">(</span>/lib/systemd/system/openvpn-server@.service<span class="p">;</span> enabled<span class="p">;</span> pres&gt;
     Active: active <span class="o">(</span>running<span class="o">)</span> since Thu 2025-01-23 20:44:51 UTC<span class="p">;</span> 1min 53s ago
       Docs: man:openvpn<span class="o">(</span>8<span class="o">)</span>
             https://community.openvpn.net/openvpn/wiki/Openvpn24ManPage
             https://community.openvpn.net/openvpn/wiki/HOWTO
   Main PID: 1024 <span class="o">(</span>openvpn<span class="o">)</span>
     Status: <span class="s2">"Initialization Sequence Completed"</span>
      Tasks: 1 <span class="o">(</span>limit: 2348<span class="o">)</span>
     Memory: 1.7M
        CPU: 35ms
     CGroup: /system.slice/system-openvpn<span class="se">\x</span>2dserver.slice/openvpn-server@servid&gt;
             └─1024 /usr/sbin/openvpn <span class="nt">--status</span> /run/openvpn-server/status-servi&gt;
</pre></td></tr></tbody></table></code></div></div>

<p>Si mostramos las interfaces con sus respectivos direccionamientos nos damos cuenta que la interfaz de túnel <code class="language-plaintext highlighter-rouge">tun0</code> se crea correctamente con la dirección 10.99.99.1, confirmando que OpenVPN está activo.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre></td><td class="rouge-code"><pre>debian@servidor:~<span class="nv">$ </span>ip a
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    <span class="nb">link</span>/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host noprefixroute 
       valid_lft forever preferred_lft forever
2: ens4: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000
    <span class="nb">link</span>/ether 0c:fe:ae:66:00:00 brd ff:ff:ff:ff:ff:ff
    altname enp0s4
    inet 192.168.1.1/24 brd 192.168.1.255 scope global ens4
       valid_lft forever preferred_lft forever
    inet6 fe80::efe:aeff:fe66:0/64 scope <span class="nb">link 
       </span>valid_lft forever preferred_lft forever
3: ens5: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000
    <span class="nb">link</span>/ether 0c:fe:ae:66:00:01 brd ff:ff:ff:ff:ff:ff
    altname enp0s5
    inet 192.168.2.1/24 brd 192.168.2.255 scope global ens5
       valid_lft forever preferred_lft forever
    inet6 fe80::efe:aeff:fe66:1/64 scope <span class="nb">link 
       </span>valid_lft forever preferred_lft forever
4: ens6: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000
    <span class="nb">link</span>/ether 0c:fe:ae:66:00:02 brd ff:ff:ff:ff:ff:ff
    altname enp0s6
    inet 192.168.122.222/24 brd 192.168.122.255 scope global dynamic ens6
       valid_lft 2320sec preferred_lft 2320sec
    inet6 fe80::efe:aeff:fe66:2/64 scope <span class="nb">link 
       </span>valid_lft forever preferred_lft forever
5: tun0: &lt;POINTOPOINT,MULTICAST,NOARP,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UNKNOWN group default qlen 500
    <span class="nb">link</span>/none 
    inet 10.99.99.1/24 scope global tun0
       valid_lft forever preferred_lft forever
    inet6 fe80::774f:979b:9e65:1c85/64 scope <span class="nb">link </span>stable-privacy 
       valid_lft forever preferred_lft forever
</pre></td></tr></tbody></table></code></div></div>

<h2 id="configuración-del-cliente1"><span class="me-2">Configuración del Cliente1</span><a href="#configuración-del-cliente1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>En la máquina cliente Cliente1, instalamos OpenVPN:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>apt update
<span class="nb">sudo </span>apt <span class="nb">install </span>openvpn <span class="nt">-y</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Los archivos de certificado y clave los movemos a <code class="language-plaintext highlighter-rouge">/etc/openvpn/client/</code> y le cambiamos los permisos a root:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>debian@cliente1:~<span class="nv">$ </span><span class="nb">sudo mv </span>cliente/<span class="k">*</span> /etc/openvpn/client/
debian@cliente1:~<span class="nv">$ </span><span class="nb">sudo chown</span> <span class="nt">-R</span> root:root /etc/openvpn/client/
</pre></td></tr></tbody></table></code></div></div>

<p>Verificamos que tengan los permisos correctos:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>debian@cliente1:~<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-l</span> /etc/openvpn/client/
total 16
<span class="nt">-rw-------</span> 1 root root 1180 Jan 23 20:37 ca.crt
<span class="nt">-rw-------</span> 1 root root 4471 Jan 23 20:37 cliente1.crt
<span class="nt">-rw-------</span> 1 root root 1704 Jan 23 20:37 cliente1.key
</pre></td></tr></tbody></table></code></div></div>

<p>Y pasamos a la configuración del cliente, el cual se encuentra en <code class="language-plaintext highlighter-rouge">/etc/openvpn/client/client.conf</code>:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre>debian@cliente1:~<span class="nv">$ </span><span class="nb">sudo cat</span> /etc/openvpn/client/client.conf
client
dev tun
proto udp

remote 192.168.1.1 1194
resolv-retry infinite
nobind

persist-key
persist-tun

ca /etc/openvpn/client/ca.crt
cert /etc/openvpn/client/cliente1.crt
key /etc/openvpn/client/cliente1.key

remote-cert-tls server
cipher AES-256-CBC
verb 3
</pre></td></tr></tbody></table></code></div></div>

<p>Donde:</p>

<ul>
  <li><strong>Modo cliente</strong>: client</li>
  <li><strong>Interfaz virtual</strong>: dev tun</li>
  <li><strong>Protocolo y puerto</strong>: proto udp en el puerto 1194</li>
  <li><strong>Dirección del servidor</strong>: remote 192.168.1.1 1194</li>
  <li><strong>Persistencia</strong>: persist-key y persist-tun para mantener la sesión</li>
  <li><strong>Seguridad</strong>: Se especifican los archivos ca.crt, cliente1.crt y cliente1.key, además del cifrado AES-256-CBC.</li>
  <li><strong>Verbosidad</strong>: verb 3 para registros detallados.</li>
</ul>

<p>Conectamos el cliente a la VPN y verificamos su estado:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre>debian@cliente1:~<span class="nv">$ </span><span class="nb">sudo </span>systemctl <span class="nb">enable</span> <span class="nt">--now</span> openvpn-client@client
debian@cliente1:~<span class="nv">$ </span><span class="nb">sudo </span>systemctl status openvpn-client@client
● openvpn-client@client.service - OpenVPN tunnel <span class="k">for </span>client
     Loaded: loaded <span class="o">(</span>/lib/systemd/system/openvpn-client@.service<span class="p">;</span> enabled<span class="p">;</span> pres
     Active: active <span class="o">(</span>running<span class="o">)</span> since Thu 2025-01-23 21:41:41 UTC<span class="p">;</span> 1min 25s ago
       Docs: man:openvpn<span class="o">(</span>8<span class="o">)</span>
             https://community.openvpn.net/openvpn/wiki/Openvpn24ManPage
             https://community.openvpn.net/openvpn/wiki/HOWTO
   Main PID: 713 <span class="o">(</span>openvpn<span class="o">)</span>
     Status: <span class="s2">"Initialization Sequence Completed"</span>
      Tasks: 1 <span class="o">(</span>limit: 2349<span class="o">)</span>
     Memory: 1.9M
        CPU: 39ms
     CGroup: /system.slice/system-openvpn<span class="se">\x</span>2dclient.slice/openvpn-client@client
             └─713 /usr/sbin/openvpn <span class="nt">--suppress-timestamps</span> <span class="nt">--nobind</span> <span class="nt">--config</span> cl
</pre></td></tr></tbody></table></code></div></div>

<p>Y si la conexión es exitosa, la interfaz <code class="language-plaintext highlighter-rouge">tun0</code> aparecerá con la IP 10.99.99.2, lo que indica que el cliente está dentro de la red VPN:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="rouge-code"><pre>debian@cliente1:~<span class="nv">$ </span>ip a
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    <span class="nb">link</span>/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host noprefixroute 
       valid_lft forever preferred_lft forever
2: ens4: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000
    <span class="nb">link</span>/ether 0c:3a:24:e0:00:00 brd ff:ff:ff:ff:ff:ff
    altname enp0s4
    inet 192.168.1.2/24 brd 192.168.1.255 scope global ens4
       valid_lft forever preferred_lft forever
    inet6 fe80::e3a:24ff:fee0:0/64 scope <span class="nb">link 
       </span>valid_lft forever preferred_lft forever
3: tun0: &lt;POINTOPOINT,MULTICAST,NOARP,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UNKNOWN group default qlen 500
    <span class="nb">link</span>/none 
    inet 10.99.99.2/24 scope global tun0
       valid_lft forever preferred_lft forever
    inet6 fe80::d9f3:6eaa:7b14:2952/64 scope <span class="nb">link </span>stable-privacy 
       valid_lft forever preferred_lft forever
</pre></td></tr></tbody></table></code></div></div>

<h2 id="comprobación"><span class="me-2">Comprobación</span><a href="#comprobación" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Para comprobar que el cliente puede alcanzar la red remota 192.168.2.0/24 a través del servidor VPN, se usa traceroute:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>debian@cliente1:~<span class="nv">$ </span>traceroute 192.168.2.2
traceroute to 192.168.2.2 <span class="o">(</span>192.168.2.2<span class="o">)</span>, 30 hops max, 60 byte packets
 1  10.99.99.1 <span class="o">(</span>10.99.99.1<span class="o">)</span>  1.910 ms  1.824 ms  1.814 ms
 2  192.168.2.2 <span class="o">(</span>192.168.2.2<span class="o">)</span>  2.734 ms  2.755 ms  2.755 ms
</pre></td></tr></tbody></table></code></div></div>

<p>Si el tráfico sigue el camino esperado a través de la VPN, significa que la configuración ha sido exitosa.</p>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/seguridad/">Seguridad</a>,
          <a href="/categories/vpn/">VPN</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/vpn/"
            class="post-tag no-text-decoration"
          >VPN</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=VPN%20de%20acceso%20remoto%20con%20OpenVPN%20y%20certificados%20x509%20-%20Blog%20personal&url=%2Fposts%2Facceso_remoto_openvpn%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=VPN%20de%20acceso%20remoto%20con%20OpenVPN%20y%20certificados%20x509%20-%20Blog%20personal&u=%2Fposts%2Facceso_remoto_openvpn%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=%2Fposts%2Facceso_remoto_openvpn%2F&text=VPN%20de%20acceso%20remoto%20con%20OpenVPN%20y%20certificados%20x509%20-%20Blog%20personal" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/acceso_remoto_openvpn/">VPN de acceso remoto con OpenVPN y certificados x509</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/acceso_remoto_wireguard/">VPN de acceso remoto con WireGuard</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/site_to_site_openvpn/">VPN sitio a sitio con OpenVPN y certificados x509</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/journald/">Recolección centralizada de logs de sistema, mediante journald</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/certificado/">Certificados digitales. HTTPS</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/criptograf%C3%ADa/">Criptografía</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/vpn/">VPN</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/systemd/">Systemd</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/aplicaciones/">Aplicaciones</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/automatizaci%C3%B3n/">Automatización</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/cloud/">Cloud</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/compartici%C3%B3n-de-archivos/">Compartición de archivos</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/instalaci%C3%B3n/">Instalación</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/monitoreo-y-gesti%C3%B3n-de-logs/">Monitoreo y Gestión de Logs</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/virtualizaci%C3%B3n/">Virtualización</a>
      
    </div>
  </section>


            </div>

            
              
              



  <section id="toc-wrapper" class="d-none ps-0 pe-4">
    <h2 class="panel-heading ps-3 mb-2">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  

  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/acceso_remoto_wireguard/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1738008000"
  data-df="ll"
  
>
  Jan 27, 2025
</time>

              <h4 class="pt-0 my-2">VPN de acceso remoto con WireGuard</h4>
              <div class="text-muted">
                <p>...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/site_to_site_openvpn/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1737910800"
  data-df="ll"
  
>
  Jan 26, 2025
</time>

              <h4 class="pt-0 my-2">VPN sitio a sitio con OpenVPN y certificados x509</h4>
              <div class="text-muted">
                <p>En esta práctica configuraremos una VPN con OpenVPN en GNS3, implementando tanto una VPN de acceso remoto como una VPN sitio a sitio. Usaremos autenticación con certificados x509 generados con Open...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/certificado/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1734629400"
  data-df="ll"
  
>
  Dec 19, 2024
</time>

              <h4 class="pt-0 my-2">Certificados digitales. HTTPS</h4>
              <div class="text-muted">
                <p>En esta práctica vamos a trabajar con certificados digitales para autenticarnos, firmar documentos y securizar una página web con HTTPS. Primero, instalaremos un certificado digital de persona físi...</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/journald/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>Recolección centralizada de logs de sistema, mediante journald</p>
    </a>
  

  
    <a
      href="/posts/site_to_site_openvpn/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>VPN sitio a sitio con OpenVPN y certificados x509</p>
    </a>
  
</nav>

            
              
              <!-- The comments switcher -->


            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2025</time>

    
      <a href="https://github.com/PabloMartin19">Pablo Martín Hidalgo</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.1.1"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/criptograf%C3%ADa/">Criptografía</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/vpn/">VPN</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/systemd/">Systemd</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/aplicaciones/">Aplicaciones</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/automatizaci%C3%B3n/">Automatización</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/cloud/">Cloud</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/compartici%C3%B3n-de-archivos/">Compartición de archivos</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/instalaci%C3%B3n/">Instalación</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/monitoreo-y-gesti%C3%B3n-de-logs/">Monitoreo y Gestión de Logs</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/virtualizaci%C3%B3n/">Virtualización</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- JavaScripts -->
    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.29.0/dist/tocbot.min.js"></script>







<script src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  







    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
    noResultsText: '<p class="mt-5">Oops! No results found.</p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
</html>

